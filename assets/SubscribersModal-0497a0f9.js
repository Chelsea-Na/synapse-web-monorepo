import{a as S,j as u}from"./jsx-runtime-095bf462.js";import{u as o,az as b,cL as I,aF as m,cM as T,cN as f,cO as D}from"./EntityTypeUtils-1e303662.js";import{u as _}from"./useMutation-478d0e49.js";import{D as E}from"./EntityChildren-7cd71d6e.js";import{r as g}from"./index-8db94870.js";import"./getEndpoint-ac94413e.js";import{U as M}from"./UserCard-fff343bf.js";import{S as U}from"./SynapseConstants-667d004c.js";import{M as c}from"./Modal-40ef87e0.js";import{B}from"./Button-891a522f.js";var O=(e=>(e.FORUM="FORUM",e.THREAD="THREAD",e.DATA_ACCESS_SUBMISSION="DATA_ACCESS_SUBMISSION",e.DATA_ACCESS_SUBMISSION_STATUS="DATA_ACCESS_SUBMISSION_STATUS",e))(O||{}),C=(e=>(e.SUBSCRIPTION_ID="SUBSCRIPTION_ID",e.SUBSCRIBER_ID="SUBSCRIBER_ID",e.OBJECT_ID="OBJECT_ID",e.OBJECT_TYPE="OBJECT_TYPE",e.CREATED_ON="CREATED_ON",e))(C||{});function R(e,s){const{accessToken:a,keyFactory:t}=o();return b(t.getSubscribersQueryKey(e.objectId,e.objectType),()=>I(a,e),s)}function h(e,s,a){const{accessToken:t,keyFactory:r}=o(),i=async()=>{const n={objectType:s,idList:[e],sortByType:C.OBJECT_ID,sortDirection:E.ASC};return(await D(t,n)).results[0]};return b(r.getSubscriptionQueryKey(e,s),i,a)}function N(e){const s=m(),{accessToken:a,keyFactory:t}=o();return _(r=>T(a,r),{...e,onSuccess:async(r,i,n)=>{await s.invalidateQueries(t.getAllSubscriptionsQueryKey()),await s.invalidateQueries(t.getSubscribersQueryKey(i.objectId,i.objectType)),e!=null&&e.onSuccess&&await e.onSuccess(r,i,n)}})}function w(e){const s=m(),{accessToken:a,keyFactory:t}=o();return _(r=>f(a,r),{...e,onSuccess:async(r,i,n)=>{await s.invalidateQueries(t.getAllSubscriptionsQueryKey()),await s.invalidateQueries(t.getAllSubscribersQueryKey()),e!=null&&e.onSuccess&&await e.onSuccess(r,i,n)}})}const L=(e,s)=>{const{data:a,isLoading:t}=h(e,s),{data:r}=R({objectId:e,objectType:s}),{mutate:i,isLoading:n}=N(),{mutate:l,isLoading:A}=w(),y=t||n||A,p=g.useCallback(()=>{a?l(a.subscriptionId):i({objectId:e,objectType:s})},[l,e,s,i,a]);return{isLoading:y,subscription:a,toggleSubscribed:p,subscribers:r}},d=({id:e,objectType:s,showModal:a,handleModal:t})=>{const{subscribers:r}=L(e,s);return S("div",{className:"SubscribersModal",children:[r&&r.subscribers.length>0&&u("a",{onClick:()=>t(!0),children:`Followers (${r.subscribers.length})`}),S(c,{className:"bootstrap-4-backport",show:a,onHide:()=>t(!1),animation:!1,children:[u(c.Header,{closeButton:!0,children:u(c.Title,{children:"Followers"})}),u(c.Body,{children:r&&r.subscribers.map(i=>u(M,{ownerId:i,size:U,showCardOnHover:!0},i))}),u(c.Footer,{children:u(B,{variant:"contained",onClick:()=>t(!1),children:"Ok"})})]})]})};try{d.displayName="SubscribersModal",d.__docgenInfo={description:"",displayName:"SubscribersModal",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},objectType:{defaultValue:null,description:"",name:"objectType",required:!0,type:{name:"enum",value:[{value:'"FORUM"'},{value:'"THREAD"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'}]}},showModal:{defaultValue:null,description:"",name:"showModal",required:!0,type:{name:"boolean"}},handleModal:{defaultValue:null,description:"",name:"handleModal",required:!0,type:{name:"(a: boolean) => void"}}}}}catch{}export{O as S,d as a,L as u};
//# sourceMappingURL=SubscribersModal-0497a0f9.js.map
