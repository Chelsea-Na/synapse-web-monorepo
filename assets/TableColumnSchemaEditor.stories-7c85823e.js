import{j as a,a as I,F as v}from"./jsx-runtime-095bf462.js";import{r as T,R as Ie}from"./index-8db94870.js";import{C as t,I as xe,t as V,K as te,bf as Ae,by as Re,c5 as Ve,c6 as Oe,c7 as Se,c8 as ye,bl as we,aK as je,u as $,z as Ce,n as Q,c9 as Fe,i as ke,T as Pe,bE as Ge}from"./SynapseClient-7c41af39.js";import{M as P}from"./getEndpoint-ac94413e.js";import"./OrientationBanner-9afa28c1.js";import{l as Be}from"./useEntity-cd9fee44.js";import{al as w,am as x,a0 as j,an as Ue,u as ze}from"./SynapseTableCell-fdd59e1b.js";import"./SkeletonButton-0864bc76.js";import{S as He}from"./SkeletonTable-c29b0ab8.js";import{c as le}from"./cloneDeep-105239c7.js";import{C as Je}from"./EnumFacetFilterUI-b6b30bbe.js";import{F as U}from"./InputLabel-f64f330c.js";import{S as z}from"./Select-7208043f.js";import{M as _}from"./MenuItem-a6b59fca.js";import{T as M}from"./TextField-b415d66b.js";import{J as qe}from"./JSONArrayEditorModal-6e036262.js";import{i as be}from"./isEqual-8bc63716.js";import{B as p}from"./Box-f664662a.js";import{T as Ye}from"./Tooltip-fa7621de.js";import{L as We}from"./Link-bf67348e.js";import{A as Ke}from"./SchemaDrivenAnnotationEditor-3bcabd3e.js";import{A as G,I as Xe}from"./IconSvg-963ccb8f.js";import{S as ae}from"./LoadingScreen-cb516f2c.js";import{d as H}from"./ToastMessage-bca643b9.js";import{E as $e}from"./EntityFinderModal-326dbdef.js";import{F as re,V as Qe}from"./useEntitySelection-d300f082.js";import{B as h}from"./Button-f56bbd3a.js";import{c as Z}from"./createSvgIcon-efa5fd2e.js";import{t as Ze}from"./times-9fe7fdfe.js";import{M as en}from"./FormControlLabel-1fdac745.js";import{T as nn}from"./Typography-214fd772.js";import{B as on}from"./ButtonGroup-c153371c.js";import{n as tn}from"./uniq-bf9c0936.js";import{s as ln}from"./styled-81e3612a.js";import{D as an}from"./Divider-75ccc940.js";import{A as rn}from"./AlertTitle-ce329963.js";import{a as sn,b as un}from"./tableQueryHandlers-6c144f4c.js";import{m as mn}from"./mockFileViewQuery-de836850.js";import{l as cn}from"./index-3f0e9bc4.js";import{a as ie}from"./mockTableEntity-600d0466.js";import"./_commonjsHelpers-042e6b4d.js";import"./SynapseConstants-060a0bdd.js";import"./inheritsLoose-c82a83d4.js";import"./index-8ce4a492.js";import"./emotion-use-insertion-effect-with-fallbacks.browser.esm-4abd396b.js";import"./FullWidthAlert-b0620f84.js";import"./Stack-db426a61.js";import"./extendSxProp-3a6755c2.js";import"./useTheme-533dafd0.js";import"./Grow-2f05371c.js";import"./isHostComponent-fa76b8d9.js";import"./useForkRef-f2aa3d66.js";import"./utils-b7dab64f.js";import"./TransitionGroupContext-aa95d3cf.js";import"./Paper-057dfac2.js";import"./ClickAwayListener-e5c35437.js";import"./_getTag-ed9314eb.js";import"./isArray-5e3f9107.js";import"./StringUtils-2ea3ab4d.js";import"./dayjs.min-59ef0ea6.js";import"./index-58d3fd43.js";import"./tiny-invariant-dd7d57d2.js";import"./emotion-react.browser.esm-f993d2c2.js";import"./CheckCircleTwoTone-b7fa358f.js";import"./inputBaseClasses-a1108cc7.js";import"./Fade-275e12f9.js";import"./useMutation-12d29c00.js";import"./useInfiniteQuery-362b9fe8.js";import"./pick-39707cbf.js";import"./toString-cc90cb98.js";import"./isSymbol-7c514724.js";import"./_baseClone-085aef97.js";import"./_Uint8Array-e7bacca1.js";import"./_baseTimes-8715be3e.js";import"./hasIn-41dc455b.js";import"./_baseSlice-cf92e063.js";import"./isPlainObject-d90d8e80.js";import"./_overRest-b2592a9d.js";import"./identity-46f208ab.js";import"./DateFormatter-83f9b363.js";import"./timezone-fd382bd1.js";import"./SynapseTableConstants-5f56c39f.js";import"./UserBadge-2e96e402.js";import"./Popover-45673dc8.js";import"./Modal-a89bdee6.js";import"./Backdrop-da57ccbb.js";import"./getScrollbarSize-ac846fe6.js";import"./ownerWindow-2c76219e.js";import"./createChainedFunction-0bab83cf.js";import"./Skeleton-fabf6a47.js";import"./Avatar-58bc65b9.js";import"./EntityLink-c9ef9ecd.js";import"./useGetEntityHeaders-db56e339.js";import"./EntityIcon-4bd188a0.js";import"./ErrorChip-befe3c73.js";import"./Chip-55e35231.js";import"./ButtonBase-84be17da.js";import"./assertThisInitialized-081f9914.js";import"./useIsFocusVisible-bbf13f29.js";import"./ErrorOutlined-3a36acde.js";import"./index-95cfb7c2.js";import"./RegularExpressions-bc0adf55.js";import"./SqlFunctions-e07db213.js";import"./UserSearchBoxV2-efb83dea.js";import"./Select-ce3716e1.esm-e13eeb0e.js";import"./isNativeReflectConstruct-e378569d.js";import"./use-deep-compare-effect.esm-7a830988.js";import"./without-e3e43d4b.js";import"./_cacheHas-5e0daad4.js";import"./_baseRest-de9add13.js";import"./isArrayLikeObject-0ce381ff.js";import"./UserOrTeamBadge-d2fc355e.js";import"./index-df142789.js";import"./Icon-7e14f941.js";import"./ShowMore-7427d245.js";import"./WideButton-f5ff1032.js";import"./useTeamMembers-4222bd9c.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./index.modern-bdabb7b6.js";import"./mapValues-12c386f6.js";import"./isPlainObject-a5fcaf03.js";import"./now-f5aa7fbf.js";import"./ObservationCard-ac4933b1.js";import"./ThemesPlot-80def940.js";import"./ElementWithTooltip-5a0b8ae4.js";import"./Dropdown-d38c09b6.js";import"./ThemeProvider-c7f6a893.js";import"./hasClass-ec9efd32.js";import"./createWithBsPrefix-2f20c945.js";import"./factory-275e83af.js";import"./sortBy-85b5591b.js";import"./_getMatchData-a65e887f.js";import"./_baseIsEqual-e9b27ebd.js";import"./_setToArray-3d6ec6fd.js";import"./_baseFor-d254fa1e.js";import"./_isIterateeCall-b1fb139d.js";import"./merge-d08ebbe6.js";import"./uniqueId-4d05949d.js";import"./isNil-8cd2dcce.js";import"./useGetQueryResultBundle-fdfa9b2b.js";import"./NoSearchResults-460db635.js";import"./NoData-59ea70fa.js";import"./queryUtils-35b5a137.js";import"./LastLoginInfo-870a1edd.js";import"./jsx-runtime_commonjs-proxy-35b96257.js";import"./isMuiElement-3ce2dffc.js";import"./Dialog-6838395e.js";import"./DialogTitle-4b023610.js";import"./DialogContent-bffd2073.js";import"./IconButton-2a435ef1.js";import"./tslib.es6-9c2726d7.js";import"./lodash-e374147d.js";import"./index-953d39fd.js";import"./useAccessRequirements-fe51e93b.js";import"./useMediaQuery-5b0b7435.js";import"./StandaloneLoginForm-5790ef5b.js";import"./LoginFlowBackButton-3298bd87.js";import"./TextField-880ee14c.js";import"./StyledFormControl-89b5d526.js";import"./LoginMethodButton-5bf3049c.js";import"./Grid-c165ab61.js";import"./useDataAccessSubmission-30ce884a.js";import"./RadioGroup-b7f85712.js";import"./Form-326662a3.js";import"./Col-4cd1c8e1.js";import"./FileUpload-177f9753.js";import"./AuthenticatedRequirement-6e28855a.js";import"./RequirementItem-d2920b75.js";import"./ConditionalWrapper-51b8d1ed.js";import"./CheckTwoTone-e386d66f.js";import"./CertificationRequirement-94c33e76.js";import"./ValidationRequirement-c75bea7c.js";import"./TwoFactorAuthEnabledRequirement-108bdab8.js";import"./TwoFactorEnrollmentForm-05ad3e2c.js";import"./LeftRightPanel-cdd78a09.js";import"./ActionRequiredCard-eda3ea63.js";import"./RequestDownloadCard-fe487b63.js";import"./CSSTransition-df176ab9.js";import"./Tabs-6ea62e46.js";import"./QueryCount-14f2edd8.js";import"./GetAppTwoTone-dc274b61.js";import"./RangeSlider-62731fb5.js";import"./react-sizeme-5bfc490a.js";import"./ColorGradient-3d3e1969.js";import"./colorPalette-c43701fe.js";import"./InfoOutlined-f00f0485.js";import"./SelectionCriteriaPill-c70ac8de.js";import"./useDownloadList-99b658e4.js";import"./LinearProgress-1c20d32b.js";import"./UpsetPlot-bf45f8db.js";import"./LargeButton-c0625306.js";import"./SynapseVideo-4588c6d7.js";import"./IconList-4148cef6.js";import"./UserCardList-07d9b1eb.js";import"./Box-c578a046.js";import"./MenuList-19fca92f.js";import"./dividerClasses-c5a0e547.js";import"./ErrorListTemplate-5f315b63.js";import"./DateTimePicker-05e1622b.js";import"./InputAdornment-5b492668.js";import"./listItemButtonClasses-d94f4ee9.js";import"./ListItemText-22c70c16.js";import"./ContentCopy-c8941367.js";import"./WarningDialog-4634f999.js";import"./immutable.es-400ccb6d.js";import"./Search-79800c0e.js";import"./Sort-7295b89b.js";import"./EntityModal-c42882cd.js";import"./FileHandleUtils-14d1685d.js";import"./useFavorites-4528d34a.js";import"./util-e166d72a.js";import"./mock_user_profile-dbfc9e85.js";import"./mockProject-20c9c397.js";const dn=Z([a("path",{d:"M13 9V5h-2v6H9.83L12 13.17 14.17 11H13z",opacity:".3"},"0"),a("path",{d:"M15 9V3H9v6H5l7 7 7-7h-4zm-3 4.17L9.83 11H11V5h2v6h1.17L12 13.17zM5 18h14v2H5z"},"1")],"DownloadTwoTone"),pn=Z(a("path",{d:"m5 9 1.41 1.41L11 5.83V22h2V5.83l4.59 4.59L19 9l-7-7-7 7z"}),"North"),Tn=Z(a("path",{d:"m19 15-1.41-1.41L13 18.17V2h-2v16.17l-4.59-4.59L5 15l7 7 7-7z"}),"South");function fn(o,n){const e=w(o,(l,i,r)=>i(e,n(l(e),r)));return e}const B=(o,n,e)=>(n.has(e)?n:n.set(e,o())).get(e),In=new WeakMap,Sn=(o,n,e,l)=>{const i=B(()=>new WeakMap,In,n),r=B(()=>new WeakMap,i,e);return B(o,r,l)};function he(o,n,e=Object.is){return Sn(()=>{const l=Symbol(),i=([u,m])=>{if(m===l)return n(u);const c=n(u,m);return e(m,c)?m:c},r=w(u=>{const m=u(r),c=u(o);return c instanceof Promise||m instanceof Promise?Promise.all([c,m]).then(i):i([c,m])});return r.init=l,r},o,n,e)}function yn(o,n){const e=T.useMemo(()=>w(null,(l,i,...r)=>o(l,i,...r)),[o]);return x(e,n)}const Cn=[t.LARGETEXT,t.MEDIUMTEXT,t.JSON];function Ee(o,n){return Object.values(t).filter(e=>o?!Cn.includes(e):!0).filter(e=>{if(n)switch(e){case t.JSON:case t.STRING_LIST:case t.INTEGER_LIST:case t.BOOLEAN_LIST:case t.DATE_LIST:case t.USERID_LIST:case t.ENTITYID_LIST:return!1;default:return!0}return!0})}function bn(o){switch(o){case"enumeration":return"Values";case"range":return"Range";default:return o}}function se(o){switch(o){case t.STRING:return"String";case t.DOUBLE:return"Double";case t.BOOLEAN:return"Boolean";case t.INTEGER:return"Integer";case t.DATE:return"Date";case t.FILEHANDLEID:return"File";case t.ENTITYID:return"Entity";case t.LINK:return"Link";case t.MEDIUMTEXT:return"MediumText";case t.LARGETEXT:return"LargeText";case t.USERID:return"User";case t.STRING_LIST:return"String List";case t.INTEGER_LIST:return"Integer List";case t.BOOLEAN_LIST:return"Boolean List";case t.DATE_LIST:return"Date List";case t.USERID_LIST:return"User ID List";case t.ENTITYID_LIST:return"Entity ID List";case t.EVALUATIONID:return"Evaluation";case t.SUBMISSIONID:return"Submission";case t.JSON:return"JSON";default:return o}}function J(o){switch(o){case t.STRING:case t.STRING_LIST:case t.LINK:return!0;default:return!1}}function ge(o){switch(o){case t.STRING_LIST:case t.BOOLEAN_LIST:case t.DATE_LIST:case t.INTEGER_LIST:return!0;default:return!1}}function ve(o,n){let e;switch(o){case t.INTEGER:case t.INTEGER_LIST:e=["enumeration","range"];break;case t.STRING:case t.BOOLEAN:case t.USERID:case t.ENTITYID:case t.STRING_LIST:case t.BOOLEAN_LIST:case t.ENTITYID_LIST:case t.USERID_LIST:case t.EVALUATIONID:e=["enumeration"];break;case t.DOUBLE:case t.DATE:case t.DATE_LIST:e=["range"];break;default:e=null}return e&&!n&&(e=[void 0,...e]),e}function hn(o,n,e){if(n)return!1;if(e)return!1;if(o.endsWith("_LIST"))return!1;switch(o){case t.ENTITYID:case t.FILEHANDLEID:case t.USERID:case t.MEDIUMTEXT:case t.LARGETEXT:case t.JSON:case t.SUBMISSIONID:case t.EVALUATIONID:return!1;default:return!0}}const En=50,gn=1e3;function vn(o){switch(o){case t.STRING:case t.STRING_LIST:case t.LINK:return gn;default:throw new Error(`Type is not known to have a max size: ${o}`)}}function Ln(o,n){if(n)return!1;switch(o){case t.STRING:case t.INTEGER:case t.ENTITYID:return!0;default:return!1}}function Le(o){return o.map(n=>{const{isSelected:e,isOriginallyDefaultColumn:l,...i}=n,r=i;return r.jsonSubColumns&&(r.jsonSubColumns=r.jsonSubColumns.map(u=>{const{isSelected:m,...c}=u;return{...c}})),r})}function ue(o,n=[]){return o.map(e=>({...e,isSelected:!1,isOriginallyDefaultColumn:n.some(l=>l.name===e.name),jsonSubColumns:e.jsonSubColumns?e.jsonSubColumns.map(l=>({...l,isSelected:!1})):void 0}))}function Mn(o){if(xe(o))return{scope:o.scopeIds,viewTypeMask:o.viewTypeMask,viewEntityType:V(o.concreteType)};if(te(o)||Ae(o)){const n=te(o)?Re:Ve;return{scope:(o.items??[]).map(e=>`${e.entityId}.${e.versionNumber}`),viewTypeMask:n,viewEntityType:V(o.concreteType)}}else if(Oe(o))return{scope:o.scopeIds,viewTypeMask:void 0,viewEntityType:V(o.concreteType)}}function Nn(o){switch(o){case t.STRING:case t.STRING_LIST:return{type:"string",minLength:1};case t.DOUBLE:return{type:"number"};case t.BOOLEAN:case t.BOOLEAN_LIST:return{type:"boolean"};case t.INTEGER:case t.INTEGER_LIST:return{type:"integer"};case t.DATE:case t.DATE_LIST:return{type:"string",format:"datetime"};case t.FILEHANDLEID:case t.ENTITYID:case t.ENTITYID_LIST:case t.LINK:case t.MEDIUMTEXT:case t.LARGETEXT:case t.USERID:case t.USERID_LIST:case t.SUBMISSIONID:case t.JSON:case t.EVALUATIONID:default:return{type:"string",minLength:1}}}function Dn(o){switch(o){case t.DOUBLE:case t.INTEGER:return"number";case t.DATE:return"date";default:return"text"}}function Me(o){return o.length>0&&o.every(n=>n.isSelected&&(n.jsonSubColumns??[]).every(e=>e.isSelected))}function _n(o){return o.reduce((n,e)=>(e.isSelected&&(n+=1),e.jsonSubColumns&&e.jsonSubColumns.forEach(l=>{l.isSelected&&(n+=1)}),n),0)}function xn(){return{name:"",columnType:t.STRING,maximumSize:En,isOriginallyDefaultColumn:!1,isSelected:!1}}function An(){return{name:"",jsonPath:"",columnType:t.STRING,facetType:"enumeration",isSelected:!1}}function me(o,n){const e=[...o];return e.forEach((l,i)=>{if(i>0&&n(l)&&!n(e[i-1])){const r=e[i-1];e[i-1]=e[i],e[i]=r}}),e}function ce(o,n){const e=[...o];for(let l=e.length-1;l>=0;l--){const i=e[l];if(l<e.length-1&&n(i)&&!n(e[l+1])){const r=e[l];e[l]=e[l+1],e[l+1]=r}}return e}function Rn(o,n){const{columnModelIndex:e,jsonSubColumnModelIndex:l,newColumnType:i}=o;let r;if(n&&n[e])n[e].jsonSubColumns&&l!==void 0?r=le(n[e].jsonSubColumns[l]):r=le(n[e]);else throw new Error("Cannot change column model type for a column that does not exist");r.columnType=i,!J(i)&&"maximumSize"in r&&delete r.maximumSize,!ge(i)&&"maximumListLength"in r&&delete r.maximumListLength,"enumValues"in r&&delete r.enumValues,"defaultValue"in r&&delete r.defaultValue;const u=ve(i,!!l);"facetType"in r&&(u===null||!u.includes(r.facetType))&&delete r.facetType,"jsonSubColumns"in r&&i!==t.JSON&&delete r.jsonSubColumns,n&&n[e]&&(n[e].jsonSubColumns&&l!==void 0?n[e].jsonSubColumns[l]=r:n[e]=r)}function Vn(o){return Me(o)?o.map(e=>{var l;return{...e,jsonSubColumns:(l=e.jsonSubColumns)==null?void 0:l.map(i=>({...i,isSelected:!1})),isSelected:!1}}):o.map(e=>{var l;return{...e,jsonSubColumns:(l=e.jsonSubColumns)==null?void 0:l.map(i=>({...i,isSelected:!0})),isSelected:!0}})}function On(o,n){const{columnModelIndex:e,jsonSubColumnModelIndex:l,value:i}=o;n&&n[e]&&(n[e].jsonSubColumns&&l!==void 0?n[e].jsonSubColumns[l]=i:n[e]=i)}function wn(o,n){const{columnModelIndex:e,jsonSubColumnModelIndex:l}=o;if(n&&n[e])if(n[e].jsonSubColumns&&l!==void 0){const i=n[e].jsonSubColumns[l];n[e].jsonSubColumns[l]={...i,isSelected:!i.isSelected}}else{const i=n[e];n[e]={...i,isSelected:!i.isSelected}}}function jn(o){return o.filter(n=>!n.isSelected).map(n=>(n.jsonSubColumns&&(n={...n,jsonSubColumns:n.jsonSubColumns.filter(e=>!e.isSelected)}),n))}function Fn(o,n,e){if(n==e)return o;const l=[...o],i=l[n];return l.splice(n,1),l.splice(e,0,i),l}function kn(o,n){const{from:e,to:l}=o,i=e.jsonSubColumnModelIndex!==void 0?n[e.columnModelIndex].jsonSubColumns:n,r=e.jsonSubColumnModelIndex!==void 0?e.jsonSubColumnModelIndex:e.columnModelIndex,u=l.jsonSubColumnModelIndex!==void 0?l.jsonSubColumnModelIndex:l.columnModelIndex,m=Fn(i,r,u);return e.jsonSubColumnModelIndex!==void 0?(n[e.columnModelIndex].jsonSubColumns=m,n):m}function Pn(o,n){switch(n.type){case"setValue":o=n.value;break;case"toggleSelectAll":{o=Vn(o);break}case"setColumnModelValue":{On(n,o);break}case"changeColumnModelType":{Rn(n,o);break}case"appendColumn":o.push(xn());break;case"appendJsonSubColumn":{const{columnModelIndex:e}=n;o[e]={...o[e],jsonSubColumns:[...o[e].jsonSubColumns??[],An()]};break}case"toggleSelect":{wn(n,o);break}case"delete":o=jn(o);break;case"move":{o=kn(n,o);break}case"moveUp":o=me(o,e=>e.isSelected),o.forEach(e=>{e.jsonSubColumns&&(e.jsonSubColumns=me(e.jsonSubColumns,l=>l.isSelected))});break;case"moveDown":o=ce(o,e=>e.isSelected),o.forEach(e=>{e.jsonSubColumns&&(e.jsonSubColumns=ce(e.jsonSubColumns,l=>l.isSelected))});break;default:throw new Error("Unexpected action",n)}return[...o]}const E=fn([],Pn);function q(o){const{columnType:n,onChange:e,value:l,disabled:i,TextFieldProps:r,SelectProps:u}=o,m=T.useMemo(()=>Dn(n),[n]);return n===t.BOOLEAN?a(U,{fullWidth:!0,children:I(z,{...u,disabled:i,value:l,onChange:c=>{c.target.value==null?e(void 0):e(c.target.value==="true")},children:[a(_,{value:void 0,children:""}),a(_,{value:"true",children:"true"}),a(_,{value:"false",children:"false"})]})}):a(M,{...r,type:m,value:l,onChange:c=>e(c.target.value),disabled:i})}try{q.displayName="DefaultValueField",q.__docgenInfo={description:"",displayName:"DefaultValueField",props:{columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'}]}},value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"T"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: T) => void"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},TextFieldProps:{defaultValue:null,description:"",name:"TextFieldProps",required:!1,type:{name:'Omit<TextFieldProps, "onChange" | "disabled" | "value">'}},SelectProps:{defaultValue:null,description:"",name:"SelectProps",required:!1,type:{name:'Omit<SelectProps<unknown>, "onChange" | "disabled" | "value">'}}}}}catch{}function Y(o){const{columnType:n,onChange:e,value:l=[],TextFieldProps:i}=o,[r,u]=T.useState(!1),m=T.useMemo(()=>Nn(n),[n]);return I(v,{children:[a(qe,{arrayItemDefinition:m,value:l,isShowingModal:r,onConfirm:c=>{e(c),u(!1)},onCancel:()=>u(!1)}),a(M,{...i,value:l.join(", "),onClick:()=>{u(!0)}})]})}try{Y.displayName="RestrictedValuesField",Y.__docgenInfo={description:"",displayName:"RestrictedValuesField",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"string[]"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(newValue: string[]) => void"}},columnType:{defaultValue:null,description:"",name:"columnType",required:!0,type:{name:"enum",value:[{value:'"STRING"'},{value:'"DOUBLE"'},{value:'"BOOLEAN"'},{value:'"INTEGER"'},{value:'"DATE"'},{value:'"FILEHANDLEID"'},{value:'"ENTITYID"'},{value:'"LINK"'},{value:'"MEDIUMTEXT"'},{value:'"LARGETEXT"'},{value:'"USERID"'},{value:'"STRING_LIST"'},{value:'"INTEGER_LIST"'},{value:'"BOOLEAN_LIST"'},{value:'"DATE_LIST"'},{value:'"USERID_LIST"'},{value:'"ENTITYID_LIST"'},{value:'"EVALUATIONID"'},{value:'"SUBMISSIONID"'},{value:'"JSON"'}]}},TextFieldProps:{defaultValue:null,description:"",name:"TextFieldProps",required:!1,type:{name:'Omit<TextFieldProps, "onChange" | "value">'}}}}}catch{}const Gn={height:"28px",fontSize:"12px"},Bn={height:"38px",fontSize:"14px"},L=!0;function O(o){const{columnModelIndex:n,jsonSubColumnIndex:e,entityType:l,isDefaultColumn:i,disabled:r=!1}=o,u=e!=null,m=x(E),c=Se.includes(ye(l)),f=T.useMemo(()=>he(E,d=>u?d[n].jsonSubColumns[e]:d[n],be),[n,u,e]),s=j(f),N=T.useMemo(()=>Ee(c,u),[c,u]),C=T.useMemo(()=>ve(s.columnType,u),[s.columnType,u]),S=T.useMemo(()=>u?Gn:Bn,[u]);return I(v,{children:[u&&a(p,{sx:{gridColumn:"1 / span 1"},children:de}),a(p,{"data-testid":"ColumnModelForm",display:"flex",alignItems:"center",sx:{gridColumn:u?"2 / span 1":" 1 / span 1",mb:"-5px"},children:a(Je,{label:"Select",hideLabel:!0,checked:s.isSelected,disabled:r,onChange:()=>{m({type:"toggleSelect",columnModelIndex:n,jsonSubColumnModelIndex:e})}})}),a(p,{my:i?"auto":void 0,sx:{gridColumn:u?"3 / span 1":"2 / span 2"},children:i?s.name:a(M,{value:s.name,placeholder:u?"Facet name":"Column name",onChange:d=>{m({type:"setColumnModelValue",columnModelIndex:n,jsonSubColumnModelIndex:e,value:{...s,name:d.target.value}})},InputProps:{disableInjectingGlobalStyles:L,sx:S,inputProps:{"aria-label":"Name"}},disabled:r,fullWidth:!0})}),a(p,{my:i?"auto":void 0,children:i?se(s.columnType):a(U,{fullWidth:!0,children:a(z,{label:"Column Type",value:s.columnType,onChange:d=>{m({type:"changeColumnModelType",columnModelIndex:n,jsonSubColumnModelIndex:e,newColumnType:d.target.value})},inputProps:{"aria-label":"Column Type"},sx:S,disabled:r,children:N.map(d=>a(_,{value:d,children:se(d)},d))})})}),a(p,{my:i?"auto":void 0,children:i?s.maximumSize??"":a(M,{type:"number",value:s.maximumSize??"",disabled:r||!J(s.columnType),InputProps:{disableInjectingGlobalStyles:L,inputProps:{"aria-label":"Maximum Size",min:1,max:J(s.columnType)?vn(s.columnType):void 0},sx:S},onChange:d=>{m({type:"setColumnModelValue",columnModelIndex:n,jsonSubColumnModelIndex:e,value:{...s,maximumSize:parseInt(d.target.value)}})},fullWidth:!0})}),a(p,{my:i?"auto":void 0,children:i?s.maximumListLength??"":a(M,{type:"number",value:s.maximumListLength??"",disabled:r||!ge(s.columnType),onChange:d=>{m({type:"setColumnModelValue",columnModelIndex:n,jsonSubColumnModelIndex:e,value:{...s,maximumListLength:parseInt(d.target.value)}})},InputProps:{disableInjectingGlobalStyles:L,inputProps:{"aria-label":"Maximum List Length"},sx:S},fullWidth:!0})}),a(p,{my:i?"auto":void 0,children:i?(s==null?void 0:s.defaultValue)??"":a(q,{TextFieldProps:{InputProps:{disableInjectingGlobalStyles:L,inputProps:{"aria-label":"Default Value"},sx:S},fullWidth:!0},SelectProps:{label:"Default Value",sx:S,inputProps:{"aria-label":"Default Value"}},columnType:s.columnType,value:(s==null?void 0:s.defaultValue)??"",onChange:d=>{m({type:"setColumnModelValue",columnModelIndex:n,jsonSubColumnModelIndex:e,value:{...s,defaultValue:d}})},disabled:r||!hn(s.columnType,c,u)})}),a(p,{children:a(Y,{value:s==null?void 0:s.enumValues,onChange:d=>{m({type:"setColumnModelValue",columnModelIndex:n,jsonSubColumnModelIndex:e,value:{...s,enumValues:we(d)?void 0:d}})},columnType:s.columnType,TextFieldProps:{fullWidth:!0,disabled:r||!Ln(s.columnType,u),InputProps:{disableInjectingGlobalStyles:L,readOnly:!0,sx:S,inputProps:{"aria-label":"Restrict Values"}}}})}),a(p,{children:a(U,{fullWidth:!0,children:a(z,{label:"Facet Type",value:s.facetType,disabled:r||C===null,onChange:d=>{m({type:"setColumnModelValue",columnModelIndex:n,jsonSubColumnModelIndex:e,value:{...s,facetType:d.target.value}})},sx:S,inputProps:{"aria-label":"Facet Type"},children:(C??[]).map((d,b)=>a(_,{value:d,children:d===void 0?"":bn(d)},b))})})}),u&&I(v,{children:[a(p,{sx:{gridColumn:"1 / span 1"},children:de}),a(p,{}),a(p,{sx:{gridColumn:"3 / span 7"},children:a(M,{placeholder:"JSON Path",value:s.jsonPath,onChange:d=>{m({type:"setColumnModelValue",columnModelIndex:n,jsonSubColumnModelIndex:e,value:{...s,jsonPath:d.target.value}})},disabled:r,fullWidth:!0,InputProps:{disableInjectingGlobalStyles:L,sx:S,endAdornment:a(Ye,{title:I(Ie.Fragment,{children:[a("p",{children:a(We,{href:"https://dev.mysql.com/doc/refman/8.0/en/json.html#json-path-syntax",children:"Please use a valid JSON Path selector, following this format."})}),a("p",{children:"This field is for linking the sub-column facet to the corresponding location in the JSON data, so that it can be used as facet filter. The correct selector will point to the key referenced in the sub-column JSON Path."})]}),children:a(je,{sx:{color:"grey.700"}})}),inputProps:{"aria-label":"JSON Path"}}})})]})]})}try{O.displayName="ColumnModelForm",O.__docgenInfo={description:"",displayName:"ColumnModelForm",props:{entityType:{defaultValue:null,description:"",name:"entityType",required:!0,type:{name:"enum",value:[{value:'"project"'},{value:'"folder"'},{value:'"file"'},{value:'"table"'},{value:'"link"'},{value:'"entityview"'},{value:'"dockerrepo"'},{value:'"submissionview"'},{value:'"dataset"'},{value:'"datasetcollection"'},{value:'"materializedview"'},{value:'"virtualtable"'}]}},columnModelIndex:{defaultValue:null,description:"",name:"columnModelIndex",required:!0,type:{name:"number"}},jsonSubColumnIndex:{defaultValue:null,description:"",name:"jsonSubColumnIndex",required:!1,type:{name:"number"}},isDefaultColumn:{defaultValue:null,description:"",name:"isDefaultColumn",required:!0,type:{name:"boolean"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}}}}}catch{}function Un(o,n,e){const{keyFactory:l}=$();return Ce(l.getDefaultColumnModelsQueryKey(o,n),async()=>(await Q.getDefaultColumnModels(o,n)).list,e)}function zn(o,n){const{keyFactory:e}=$();return Ce(e.getAnnotationColumnModelsQueryKey(o),()=>Q.getAnnotationColumnModels(o),n)}function W(o){const{initialFinderProjectId:n,onAddColumns:e}=o,[l,i]=T.useState(!1),{accessToken:r}=$(),u=T.useCallback(async c=>{const{tableBundle:f}=await Q.getEntityBundleV2(c.targetId,{includeTableBundle:!0},c.targetVersionNumber,r);return f.columnModels.map(s=>({...s,id:void 0}))},[r]),m=T.useCallback(async c=>{try{const f=c[0];if(f){const s=await u(f);e(s)}}catch(f){console.error(f),H(f.message,"danger")}finally{i(!1)}},[u,e]);return I(v,{children:[a($e,{configuration:{initialScope:n?re.CURRENT_PROJECT:re.ALL_PROJECTS,initialContainer:n??"root",selectMultiple:!1,selectableTypes:Fe.ALL_TABLES,visibleTypesInTree:[ke.PROJECT],versionSelection:Qe.UNTRACKED},show:l,title:"Import Columns from Table",promptCopy:"Find Tables to import columns",titleHelpPopoverProps:{markdownText:"Search or Browse Synapse to find an existing Table in order to import columns into this Table"},onConfirm:c=>{m(c)},confirmButtonCopy:"Import Columns",onCancel:()=>{i(!1)}}),a(h,{variant:"outlined",onClick:()=>{i(!0)},startIcon:a(dn,{}),children:"Import Columns"})]})}try{W.displayName="ImportTableColumnsButton",W.__docgenInfo={description:"",displayName:"ImportTableColumnsButton",props:{initialFinderProjectId:{defaultValue:null,description:"",name:"initialFinderProjectId",required:!1,type:{name:"string"}},onAddColumns:{defaultValue:null,description:"",name:"onAddColumns",required:!0,type:{name:"(columnModels: { name: string; defaultValue?: string | undefined; columnType: ColumnType; maximumSize?: number | undefined; maximumListLength?: number | undefined; enumValues?: string[] | undefined; facetType?: FacetType | undefined; jsonSubColumns?: JsonSubColumnModel[] | undefined; id?: string | undefined; }[]) =>..."}}}}}catch{}const Hn="18px 18px 1.75fr 1.75fr 0.75fr 1fr 1.25fr 1.25fr 1fr",Jn=6,de=a(p,{sx:{width:"1px",height:`calc(100% + 2 * ${Jn}px)`,backgroundColor:"grey.400",marginLeft:"8px"}}),qn=a(p,{sx:o=>({width:"50%",height:"60%",borderLeft:`1px solid ${o.palette.grey[400]}`,borderBottom:`1px solid ${o.palette.grey[400]}`,marginLeft:"8px",marginBottom:"auto",marginRight:"0",borderBottomLeftRadius:"5px"})}),g=ln(p,{label:"ColumnHeader"})({fontWeight:700}),K=Ie.forwardRef(function(n,e){const{initialData:l,entityType:i,viewScope:r,onSubmit:u=tn,isSubmitting:m=!1}=n,c=j(T.useMemo(()=>w(y=>y(E).length),[])),f=x(E),s=yn(T.useCallback(y=>y(E),[])),N=ye(i),C=Se.includes(N),S=C,d=C,{data:b,isLoading:A}=Un(r==null?void 0:r.viewEntityType,r==null?void 0:r.viewTypeMask,{enabled:d,staleTime:1/0}),{data:F,isLoading:ee}=zn({viewScope:r,includeDerivedAnnotations:!0,concreteType:"org.sagebionetworks.repo.model.table.ViewColumnModelRequest"},{enabled:S});T.useEffect(()=>{l&&!A&&f({type:"setValue",value:ue(l,b??[])})},[A]),T.useImperativeHandle(e,()=>({submit(){u(s())},getEditedColumnModels(){return Le(s())},validate(){return!0}}),[u,s]);const D=T.useCallback(y=>{const ne=s(),k=y.filter(oe=>Ee(C,!1).includes(oe.columnType)?!ne.find(_e=>_e.name===oe.name):!1);k.length>0?(f({type:"setValue",value:[...ne,...ue(k,b)]}),H(`${k.length} columns added to schema.`,"success")):H("No columns added. All columns to add are present in the column schema.","info")},[b,f,C,s]),Ne=T.useCallback(()=>{b&&D(b.map(y=>({...y,id:void 0})))},[b,D]),De=T.useCallback(()=>{F&&D(F)},[F,D]);return I(p,{component:"form",sx:{py:2.5},children:[a(Yn,{disabled:m}),I(p,{display:"grid",sx:{gridTemplateColumns:Hn,py:2.5},gap:"8px",children:[a(g,{}),a(g,{sx:{gridColumn:"2 / span 2"},children:"Column Name"}),a(g,{children:"Column Type"}),a(g,{children:"Size"}),a(g,{children:"Max List Length"}),a(g,{children:"Default Value"}),a(g,{children:"Restrict Values"}),a(g,{children:"Facet"}),a(p,{sx:{gridColumn:"1 / span 10",backgroundColor:"grey.300",height:"2px"}}),Ze(c,y=>a(Wn,{entityType:i,columnModelIndex:y,disabled:m},y))]}),I(p,{display:"flex",gap:1,children:[a(h,{variant:"outlined",onClick:()=>{f({type:"appendColumn"})},startIcon:a(G,{}),disabled:m,children:"Add Column"}),d&&I(h,{variant:"outlined",startIcon:A?a(ae,{}):a(G,{}),onClick:()=>{Ne()},disabled:A||m,children:["Add Default ",Pe(i)," Columns"]}),S&&a(h,{variant:"outlined",startIcon:ee?a(ae,{}):a(G,{}),disabled:ee||m,onClick:()=>{De()},children:"Add All Annotations"}),a(W,{onAddColumns:y=>{D(y)}})]})]})});function Yn(o){const{disabled:n=!1}=o,e=x(E),l=j(E),i=Me(l),r=_n(l);return I(p,{display:"flex",gap:1,children:[I(h,{"aria-label":"Select All",variant:"outlined",color:"neutral",onClick:()=>{e({type:"toggleSelectAll"})},disabled:n||l.length==0,children:[a(en,{size:"small",checked:i,indeterminate:r>0&&!i,disabled:n||l.length==0}),I(nn,{variant:"smallText1",color:"text.secondary",children:[r," selected"]})]}),I(on,{children:[a(h,{"aria-label":"Move Down",variant:"outlined",color:"neutral",onClick:()=>{e({type:"moveDown"})},disabled:n||r==0,children:a(Tn,{fontSize:"small"})}),a(h,{"aria-label":"Move Up",variant:"outlined",color:"neutral",onClick:()=>{e({type:"moveUp"})},disabled:n||r==0,children:a(pn,{fontSize:"small"})})]}),a(h,{"aria-label":"Delete",variant:"outlined",color:"neutral",onClick:()=>{e({type:"delete"})},disabled:n||r==0,children:a(Xe,{fontSize:"small",icon:"delete",wrap:!1})})]})}function Wn(o){const{columnModelIndex:n,entityType:e,disabled:l}=o,i=x(E),r=j(T.useMemo(()=>he(E,m=>m[n],be),[n]));if(!r)return a(v,{});const u=r.isOriginallyDefaultColumn;return I(v,{children:[a(O,{entityType:e,columnModelIndex:n,isDefaultColumn:u,disabled:l}),r.columnType===t.JSON&&r.jsonSubColumns&&r.jsonSubColumns.map((m,c)=>a(O,{entityType:e,columnModelIndex:n,jsonSubColumnIndex:c,isDefaultColumn:u,disabled:l},c)),r.columnType===t.JSON&&I(v,{children:[a(p,{sx:{gridColumn:"1 / span 2"},children:qn}),a(p,{sx:{gridColumn:"3 / span 5"},children:a(h,{startIcon:a(Ke,{}),variant:"text",disabled:l,onClick:()=>i({type:"appendJsonSubColumn",columnModelIndex:n}),children:"Add sub-column"})})]})]})}try{K.displayName="TableColumnSchemaForm",K.__docgenInfo={description:"",displayName:"TableColumnSchemaForm",props:{entityType:{defaultValue:null,description:"",name:"entityType",required:!0,type:{name:"enum",value:[{value:'"project"'},{value:'"folder"'},{value:'"file"'},{value:'"table"'},{value:'"link"'},{value:'"entityview"'},{value:'"dockerrepo"'},{value:'"submissionview"'},{value:'"dataset"'},{value:'"datasetcollection"'},{value:'"materializedview"'},{value:'"virtualtable"'}]}},viewScope:{defaultValue:null,description:"",name:"viewScope",required:!1,type:{name:"ViewScope"}},initialData:{defaultValue:null,description:"",name:"initialData",required:!1,type:{name:"ColumnModel[]"}},onSubmit:{defaultValue:null,description:"",name:"onSubmit",required:!1,type:{name:"((formData: ColumnModelFormData[]) => void)"}},isSubmitting:{defaultValue:null,description:"",name:"isSubmitting",required:!1,type:{name:"boolean"}}}}}catch{}function Kn(o){var C,S;const{entityId:n}=o,e=T.useRef(null),{data:l,isLoading:i}=ze(n,void 0,{includeEntity:!0,includeTableBundle:!0},{staleTime:1/0,useErrorBoundary:!0}),r=l==null?void 0:l.entity,u=(C=l==null?void 0:l.tableBundle)==null?void 0:C.columnModels,{mutate:m,isLoading:c,error:f}=Be(),s=T.useCallback(d=>{const b=Le(d);m({entityId:n,originalColumnModels:u,newColumnModels:b})},[n,m,u]),N=T.useMemo(()=>{if(r)return Mn(r)},[r]);return i||!l||!r?a(He,{numRows:8,numCols:7,rowHeight:"50px",fullWidthCells:!0}):I(v,{children:[a(K,{ref:e,entityType:V(r.concreteType),viewScope:N,initialData:(S=l==null?void 0:l.tableBundle)==null?void 0:S.columnModels,isSubmitting:c,onSubmit:d=>{s(d)}}),a(an,{}),f&&a(rn,{severity:"error",sx:{my:2},children:f==null?void 0:f.message}),a(h,{variant:"contained",color:"primary",onClick:()=>{e.current&&e.current.submit()},disabled:c,sx:{my:2},children:c?"Saving...":"Save"})]})}function X(o){return a(Ue,{children:a(Kn,{...o})})}try{X.displayName="TableColumnSchemaEditor",X.__docgenInfo={description:"",displayName:"TableColumnSchemaEditor",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}}}}}catch{}const Ka={title:"Synapse/Table Column Schema Editor",component:X,parameters:{stack:"mock"}},Xn={columnModels:mn.columnModels,maxRowsPerPage:25},R={name:"Table Column Schema Editor",parameters:{msw:{handlers:[...sn(P),...un({concreteType:"org.sagebionetworks.repo.model.table.ViewColumnModelResponse",results:[{id:"1235325",columnType:t.STRING,name:"columnFromAnnotations",maximumSize:10}]},P),cn.rest.post(`${P}${Ge(":entityId")}`,async(o,n,e)=>n(e.status(200),e.json({entity:ie.entity,tableBundle:Xn})))]}},args:{entityId:ie.id}};var pe,Te,fe;R.parameters={...R.parameters,docs:{...(pe=R.parameters)==null?void 0:pe.docs,source:{originalSource:`{
  name: 'Table Column Schema Editor',
  parameters: {
    msw: {
      handlers: [...getDefaultColumnHandlers(MOCK_REPO_ORIGIN), ...getAnnotationColumnHandlers({
        concreteType: 'org.sagebionetworks.repo.model.table.ViewColumnModelResponse',
        results: [{
          id: '1235325',
          columnType: ColumnTypeEnum.STRING,
          name: 'columnFromAnnotations',
          maximumSize: 10
        }]
      }, MOCK_REPO_ORIGIN), rest.post(\`\${MOCK_REPO_ORIGIN}\${ENTITY_BUNDLE_V2(':entityId')}\`, async (req, res, ctx) => {
        return res(ctx.status(200), ctx.json({
          entity: mockTableEntityData.entity,
          tableBundle: mockTableBundle
        }));
      })]
    }
  },
  args: {
    entityId: mockTableEntityData.id
  }
}`,...(fe=(Te=R.parameters)==null?void 0:Te.docs)==null?void 0:fe.source}}};const Xa=["Demo"];export{R as Demo,Xa as __namedExportsOrder,Ka as default};
//# sourceMappingURL=TableColumnSchemaEditor.stories-7c85823e.js.map
