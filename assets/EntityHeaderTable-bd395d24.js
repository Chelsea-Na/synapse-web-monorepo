import{j as e,a as l,F as q}from"./jsx-runtime-095bf462.js";import{r as o,R as pe}from"./index-8db94870.js";import{V as ue,L as me,W as ye,X as Q,Y as ge,Z as fe,_ as he,$ as Ce,a0 as _e,a1 as Ie}from"./SynapseTableCell-3364131e.js";import{I as Se}from"./SynapseClient-ce5780df.js";import{P as we}from"./getEndpoint-ac94413e.js";import"./OrientationBanner-caa14b37.js";import{S as ee}from"./RegularExpressions-bc0adf55.js";import{a as xe}from"./useGetEntityHeaders-3cd9e0d7.js";import{I as te,A as Ee}from"./IconSvg-3ab5d71e.js";import"./SkeletonButton-0864bc76.js";import{S as be}from"./SkeletonTable-c29b0ab8.js";import{p as Re}from"./papaparse.min-84949987.js";import{u as Ve}from"./UserSearchBoxV2-1019bb2e.js";import{T as ae}from"./TextField-f454b447.js";import{E as Fe}from"./EntityLink-7fad6cb6.js";import{L as Te}from"./Link-342b97d1.js";import{T as k}from"./Typography-214fd772.js";import{M as oe}from"./FormControlLabel-f9f0f4b1.js";import{E as De}from"./EntityFinderModal-08ab30d8.js";import{V as ke,F as ve}from"./useEntitySelection-6fa8d7d3.js";import{c as Ne}from"./cloneDeep-105239c7.js";import{u as He}from"./ThemesPlot-7e18b235.js";import{B as R}from"./Box-f664662a.js";import{B as U}from"./Button-f56bbd3a.js";import{I as Ae}from"./InputLabel-f64f330c.js";import{T as Me}from"./Tooltip-f72372f7.js";import{I as Be}from"./IconButton-2a435ef1.js";import{A as Pe,a as qe}from"./AlertTitle-ce329963.js";import{n as Ue}from"./uniq-bf9c0936.js";function L({initialValue:n,onChange:a,options:i,delay:p=250,...u}){const[d,h]=o.useState(n);return Ve(()=>{a(d)},[d],p),e(ue,{disablePortal:!0,isOptionEqualToValue:(m,y)=>y.length==0||m===y,options:i,value:d,onChange:(m,y)=>{h(y??"")},sx:{marginRight:"10px"},renderInput:m=>e(ae,{...m,...u,value:d,onChange:y=>h(y.target.value)})})}try{L.displayName="DebouncedInput",L.__docgenInfo={description:"",displayName:"DebouncedInput",props:{initialValue:{defaultValue:null,description:"",name:"initialValue",required:!0,type:{name:"string"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: string) => void"}},options:{defaultValue:null,description:"",name:"options",required:!0,type:{name:"string[]"}},delay:{defaultValue:{value:"250"},description:"",name:"delay",required:!1,type:{name:"number"}}}}}catch{}function O({column:n,table:a}){var d;const i=(d=a.getPreFilteredRowModel().flatRows[0])==null?void 0:d.getValue(n.id),p=n.getFilterValue()??"",u=pe.useMemo(()=>typeof i=="number"?[]:Array.from(n.getFacetedUniqueValues().keys()).sort(),[n.getFacetedUniqueValues()]);return e(L,{type:"text",options:u,initialValue:p,onChange:h=>n.setFilterValue(h),placeholder:`Filter by ${n.id}... (${n.getFacetedUniqueValues().size})`,list:n.id+"list"})}try{O.displayName="Filter",O.__docgenInfo={description:"",displayName:"Filter",props:{column:{defaultValue:null,description:"",name:"column",required:!0,type:{name:"Column<any, unknown>"}},table:{defaultValue:null,description:"",name:"table",required:!0,type:{name:"Table<any>"}}}}}catch{}function z(n){const{cell:a}=n,{row:i}=a,{original:p}=i,{id:u,isDummy:d}=p;return d?e(Te,{href:`${we.PORTAL}#!Synapse:${u}`,children:u}):e(Fe,{entity:p})}function j(n){const{cell:a}=n;return e(k,{variant:"body1",children:a.getContext().getValue()})}function $(n){const{cell:a}=n;return e(k,{variant:"body1",sx:{textTransform:"capitalize"},children:a.getContext().getValue()})}function G(n){const{table:a}=n;return e(oe,{checked:a.getIsAllRowsSelected(),indeterminate:a.getIsSomeRowsSelected(),onClick:a.getToggleAllRowsSelectedHandler()})}function Z(n){const{row:a}=n;return e(oe,{checked:a.getIsSelected(),disabled:!a.getCanSelect(),indeterminate:a.getIsSomeSelected(),onClick:a.getToggleSelectedHandler()})}try{z.displayName="EntityHeaderNameCell",z.__docgenInfo={description:"",displayName:"EntityHeaderNameCell",props:{}}}catch{}try{j.displayName="EntityHeaderIDCell",j.__docgenInfo={description:"",displayName:"EntityHeaderIDCell",props:{}}}catch{}try{$.displayName="EntityHeaderTypeCell",$.__docgenInfo={description:"",displayName:"EntityHeaderTypeCell",props:{}}}catch{}try{G.displayName="CheckBoxHeader",G.__docgenInfo={description:"",displayName:"CheckBoxHeader",props:{}}}catch{}try{Z.displayName="CheckBoxCell",Z.__docgenInfo={description:"",displayName:"CheckBoxCell",props:{}}}catch{}const v=n=>l("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e("mask",{id:"mask0_6722_37828",style:{maskType:"alpha"},maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"24",height:"24",children:e("rect",{width:"24",height:"24",fill:"#D9D9D9"})}),e("g",{mask:"url(#mask0_6722_37828)",children:e("path",{d:"M18 20V17H15V15H18V12H20V15H23V17H20V20H18ZM3 21C2.45 21 1.97917 20.8042 1.5875 20.4125C1.19583 20.0208 1 19.55 1 19V5C1 4.45 1.19583 3.97917 1.5875 3.5875C1.97917 3.19583 2.45 3 3 3H17C17.55 3 18.0208 3.19583 18.4125 3.5875C18.8042 3.97917 19 4.45 19 5V10H17V8H3V19H16V21H3ZM3 6H17V5H3V6Z",fill:"#395979"})})]});try{v.displayName="AddAd",v.__docgenInfo={description:"",displayName:"AddAd",props:{}}}catch{}function Le(n,a,i){const[p,u]=o.useState({}),[d,h]=o.useState(Ne(n)),[m,y]=o.useState(""),[N,V]=o.useState([]),w=o.useCallback(f=>{y(f),a&&a(f)},[a]),_=o.useCallback(f=>{u({}),h(f),i&&i(f),V([]),w("")},[i,w]);return{rowSelection:p,setRowSelection:u,refsInState:d,setRefsInState:_,newEntityIDs:m,setNewEntityIDs:w,parseErrors:N,setParseErrors:V}}const Oe={selectMultiple:!0,versionSelection:ke.DISALLOWED,initialScope:ve.ALL_PROJECTS,initialContainer:"root"},ne=10,re=n=>{const{references:a,isEditable:i,onUpdate:p=Ue,removeSelectedRowsButtonText:u="Remove Selected Rows",onUpdateEntityIDsTextbox:d,objectNameCopy:h="entity",hideTextFieldToPasteValue:m=!1,entityFinderConfiguration:y=Oe}=n,[N,V]=o.useState([]),[w,_]=o.useState(!1),{rowSelection:f,setRowSelection:ie,refsInState:I,setRefsInState:H,newEntityIDs:c,setNewEntityIDs:F,parseErrors:T,setParseErrors:x}=Le(a,d,p),A=o.useCallback(r=>{x([`Invalid Synapse ID(s): ${r.join(",")}`])},[x]),M=o.useCallback(r=>{const t=r.map(s=>({targetId:s.trim()}));H([...I,...t])},[I,H]),se=o.useCallback(()=>{c?c.includes(",")?Re.parse(c,{complete:r=>{if(r.errors.length>0){const t=r.errors.map(s=>s.message);x(t)}else{const t=r.data[0],s=t.filter(C=>!C.trim().match(ee));s.length>0?A(s):M(t)}}}):c.trim().match(ee)?M([c]):A([c]):(x([]),F(""))},[M,c,A,F,x]),S=He(me(h)),W=o.useMemo(()=>[{id:"select",header:G,cell:Z}],[]),B=o.useMemo(()=>[{accessorFn:r=>r.name,id:"name",cell:z,header:"Name"},{accessorFn:r=>r.id,id:"id",cell:j,header:"SynID"},{accessorFn:r=>r.isDummy?"-":Se(r),id:"type",header:"Type",cell:$,filterFn:"includesString"}],[]),le=o.useMemo(()=>i?W.concat(B):B,[B,i,W]),Y=Object.keys(f).length,{data:E,isSuccess:de,isLoading:J}=xe(I,{useErrorBoundary:!0}),P=o.useMemo(()=>{const r=E?E==null?void 0:E.results:[],t=new Set;r.map(g=>t.add(g.id));const C=I.filter(g=>!t.has(g.targetId)).map(g=>({id:g.targetId,name:g.targetId,benefactorId:-1,type:"org.sagebionetworks.repo.model.Project",createdOn:"",modifiedOn:"",createdBy:"",modifiedBy:"",isLatestVersion:!0,isDummy:!0}));return r.concat(C)},[E]),D=ye({data:P,columns:le,state:{rowSelection:f,columnFilters:N},enableRowSelection:i,onRowSelectionChange:ie,onColumnFiltersChange:V,getCoreRowModel:ge(),getFilteredRowModel:fe(),getSortedRowModel:he(),getFacetedRowModel:Ce(),getFacetedUniqueValues:_e(),getFacetedMinMaxValues:Ie(),columnResizeMode:"onChange"});if(J)return e(be,{numCols:3,numRows:10});if(!de)return e(q,{});const ce=r=>{const s=P.filter((C,g)=>f[g]!==!0).map(C=>({targetId:C.id}));H(s)},X=Y>0,b=P.length,K=D.getPrePaginationRowModel().rows.length;return l("div",{children:[l(R,{sx:{display:"flex",justifyContent:"space-between",padding:"12px 10px 10px 5px"},children:[e("div",{children:b>ne&&l(k,{variant:"body1",sx:{marginBottom:"10px"},children:[b," ",S," ",K<b?`(${K} visible)`:"",X&&e("span",{children:` (${Y} selected)`})]})}),e("div",{children:i&&I.length>0&&e(U,{variant:"contained",disabled:!X,onClick:ce,children:u})})]}),b>0&&e(R,{sx:{overflow:"auto",maxHeight:"250px",paddingLeft:"2px",th:{backgroundColor:"#eee",zIndex:100}},children:l("table",{style:{borderCollapse:"collapse",width:"100%"},children:[e("thead",{children:D.getHeaderGroups().map(r=>e("tr",{children:r.headers.map(t=>{let s="5%";switch(t.id){case"name":s="50%";break;case"id":s="22%";break;case"type":s="22%";break}return l("th",{colSpan:t.colSpan,style:{width:s,position:"sticky",top:"0px",background:"#fff"},children:[t.isPlaceholder?null:l(q,{children:[l("div",{className:t.column.getCanSort()?"SRC-hand-cursor":"",onClick:t.column.getToggleSortingHandler(),children:[Q(t.column.columnDef.header,t.getContext()),{asc:e(te,{icon:"sortUp",wrap:!1,sx:{color:"primary.main",backgroundColor:"none",float:"right",marginRight:"5px"}}),desc:e(te,{icon:"sortDown",wrap:!1,sx:{color:"primary.main",backgroundColor:"none",float:"right",marginRight:"5px"}})}[t.column.getIsSorted()]??null]}),t.column.getCanFilter()&&b>ne?e("div",{children:e(O,{column:t.column,table:D})}):null]}),t.column.getCanResize()&&e("div",{className:`resizer ${t.column.getIsResizing()?"isResizing":""}`,onMouseDown:t.getResizeHandler(),onTouchStart:t.getResizeHandler()})]},t.id)})},r.id))}),e("tbody",{children:D.getRowModel().rows.map(r=>e("tr",{style:{height:"30px"},children:r.getVisibleCells().map(t=>e("td",{style:{width:t.column.getSize()},children:Q(t.column.columnDef.cell,t.getContext())},t.id))},r.id))})]})}),e(De,{configuration:y,promptCopy:`Select ${S} to add to the Synapse ID list`,show:w,title:`Select ${S}`,confirmButtonCopy:`Add ${S}`,onConfirm:r=>{if(m)p([...I,...r]);else{const t=r.map(g=>g.targetId),C=(c.trim().length>0?c.concat(","):c).concat(t.join(","));F(C)}_(!1)},onCancel:()=>_(!1)}),i&&l(R,{sx:{marginTop:"10px"},children:[m&&l(U,{variant:"outlined",onClick:()=>{_(!0)},startIcon:e(v,{}),children:["Add ",S]}),!m&&l(q,{children:[e(Ae,{htmlFor:"synIDs",children:"Add Synapse IDs"}),l(R,{sx:{display:"grid",gridTemplateColumns:"auto 50px 150px"},children:[e(ae,{id:"synIDs",name:"synIDs",fullWidth:!0,onChange:r=>{F(r.target.value)},value:c,placeholder:"Enter a list of Synapse IDs (i.e. 'syn123, syn456')"}),e(R,{sx:{padding:"5px 0px 0px 5px"},children:e(Me,{title:"Add a Synapse ID to the list via the Entity Finder",children:e(Be,{onClick:()=>{_(!0)},children:e(v,{})})})}),l(U,{variant:"outlined",onClick:se,disabled:J||c.trim().length==0,startIcon:e(Ee,{}),children:["Add ",S]})]})]}),T&&T.length>0&&l(Pe,{severity:"error",sx:{my:2},children:[e(qe,{children:"Parsing errors encountered:"}),e("ul",{children:T.map((r,t)=>e(k,{component:T.length>1?"li":"span",lineHeight:1.5,variant:"smallText1",children:r},t))})]})]})]})};try{re.displayName="EntityHeaderTable",re.__docgenInfo={description:`Renders a sortable/filterable table for a set of entity references.  If editable, onUpdate will be called back
on any entity added/removed.`,displayName:"EntityHeaderTable",props:{references:{defaultValue:null,description:"",name:"references",required:!0,type:{name:"ReferenceList"}},isEditable:{defaultValue:null,description:"",name:"isEditable",required:!0,type:{name:"boolean"}},onUpdate:{defaultValue:null,description:"",name:"onUpdate",required:!1,type:{name:"((updatedRefs: ReferenceList) => void)"}},removeSelectedRowsButtonText:{defaultValue:null,description:"",name:"removeSelectedRowsButtonText",required:!1,type:{name:"string"}},onUpdateEntityIDsTextbox:{defaultValue:null,description:"",name:"onUpdateEntityIDsTextbox",required:!1,type:{name:"((value: string) => void)"}},objectNameCopy:{defaultValue:null,description:"",name:"objectNameCopy",required:!1,type:{name:"string"}},hideTextFieldToPasteValue:{defaultValue:null,description:"",name:"hideTextFieldToPasteValue",required:!1,type:{name:"boolean"}},entityFinderConfiguration:{defaultValue:null,description:"",name:"entityFinderConfiguration",required:!1,type:{name:'Omit<EntityFinderProps, "onSelectedChange">'}}}}}catch{}export{re as E};
//# sourceMappingURL=EntityHeaderTable-bd395d24.js.map
