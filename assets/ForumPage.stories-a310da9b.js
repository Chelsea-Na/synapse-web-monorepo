import{a as o,j as r,F as k}from"./jsx-runtime-670450c2.js";import{r as u}from"./index-f1f749bf.js";import{d2 as p,a$ as V,d3 as F}from"./index-861a53dd.js";import{h as H,C as x,S as q}from"./SynapseConstants-f1d07af3.js";import{c as Y,u as O,a as j,S as v,b as G}from"./SubscribersModal-db202751.js";import{d as z}from"./ToastMessage-8fc96da8.js";import{d as W}from"./dayjs.min-c95aebbe.js";import{S as C}from"./Sort-9fe1b4ba.js";import"./getEndpoint-5374ab4d.js";import{D as a}from"./EntityChildren-7cd71d6e.js";import{I as X}from"./IconSvg-27bfb1b7.js";import{U as w}from"./UserCard-88cc851d.js";import{T as $}from"./Table-6b0350f2.js";import{B as _}from"./Button-7d415009.js";import{F as J}from"./ForumThreadEditor-8ce486eb.js";import{T as K}from"./Typography-70326f55.js";import{M as n}from"./Modal-346748ce.js";import"./_commonjsHelpers-042e6b4d.js";import"./index-96c5f47c.js";import"./extends-98964cd2.js";import"./inheritsLoose-d541526f.js";import"./setPrototypeOf-0bb37fbe.js";import"./objectWithoutPropertiesLoose-4f48578a.js";import"./styled-9ea72d20.js";import"./emotion-use-insertion-effect-with-fallbacks.browser.esm-eaaa54fe.js";import"./Tooltip-e2a21fb8.js";import"./SvgIcon-d8836e03.js";import"./useTheme-a927bea5.js";import"./TransitionGroupContext-ab7f4b4e.js";import"./useIsFocusVisible-c754a498.js";import"./FullWidthAlert-10bb9b65.js";import"./hook-c05d8d9f.js";import"./createWithBsPrefix-e09f51dd.js";import"./divWithClassName-ace3d0f1.js";import"./index-4d501b15.js";import"./Fade-2c9937b4.js";import"./isArray-a82322d9.js";import"./IconButton-7162f347.js";import"./ButtonBase-99361597.js";import"./emotion-react.browser.esm-c209b88a.js";import"./assertThisInitialized-081f9914.js";import"./Link-ce18840d.js";import"./Button-445c67f6.js";import"./useInfiniteQuery-a2eb5133.js";import"./useMutation-7eda838d.js";import"./removeClass-164fd327.js";import"./hasClass-ec9efd32.js";import"./uniqueId-9feaf103.js";import"./toString-3056297c.js";import"./isSymbol-b6149709.js";import"./IconCopy-9a72c17a.js";import"./SkeletonTable-7ca271c7.js";import"./times-b02bce3e.js";import"./toInteger-a12a55f1.js";import"./Skeleton-4064b2ac.js";import"./Overlay-529574f8.js";import"./contains-60f9209b.js";import"./usePopperMarginModifiers-363ddb1c.js";import"./useWaitForDOMRef-54076dc2.js";import"./AccessRequirementList-9c683ba7.js";import"./useGetInfoFromIds-60a408d5.js";import"./use-deep-compare-effect.esm-2b920fea.js";import"./index-5d0cf067.js";import"./uniq-184246de.js";import"./_baseSlice-cf92e063.js";import"./_cacheHas-e9fab226.js";import"./without-bf183029.js";import"./_Set-2442d88e.js";import"./_setToArray-3d6ec6fd.js";import"./queryKeys-dd803d9a.js";import"./LoadingScreen-df094095.js";import"./RegularExpressions-efc8426f.js";import"./react-intersection-observer.esm-8bf16175.js";import"./DateFormatter-c55db457.js";import"./utc-8a3e1a17.js";import"./EntityIcon-f5093a27.js";import"./_commonjs-dynamic-modules-302442b1.js";import"./uniq-04f137ae.js";import"./_equalByTag-b9a89bb4.js";import"./_baseToString-34430836.js";import"./_baseUniq-4dd7dacf.js";import"./hasIn-78e1b520.js";import"./_baseIteratee-3a86f617.js";import"./index.browser-57d5884d.js";import"./core.esm-019208ef.js";import"./pick-c5e055fc.js";import"./_baseClone-2dafdd07.js";import"./isEmpty-ac69b4ac.js";import"./isEqual-7707b945.js";import"./isPlainObject-6c541f89.js";import"./union-130fc0e9.js";import"./CustomSelectWidget-9b977eff.js";import"./_basePickBy-d5b95ae3.js";import"./Select-40119e12.esm-76c72f02.js";import"./toConsumableArray-85fcc1b5.js";import"./getPrototypeOf-e4242ba0.js";import"./isNativeReflectConstruct-ff095bc2.js";import"./isString-ef2c1639.js";import"./now-c6b4f1a9.js";import"./mapValues-79b7ee06.js";import"./factory-76e91d33.js";import"./sqlFunctions-7d3d5868.js";import"./QueryFilter-8367fe15.js";import"./useEntity-cc8fd68a.js";import"./SynapseTableConstants-942d2b0b.js";import"./FacetNav-56739953.js";import"./queryUtils-f43957e7.js";import"./cloneDeep-efed0fec.js";import"./NoSearchResults-597d4337.js";import"./NoData-0f1b3dd6.js";import"./unCamelCase-ec1c2b3d.js";import"./ColumnType-3c5058f3.js";import"./useGetQueryResultBundle-05b740cd.js";import"./ElementWithTooltip-8dce28f7.js";import"./Dropdown-83007dcc.js";import"./usePrevious-9f30f8c7.js";import"./isRequiredForA11y-0a29da5f.js";import"./Checkbox-44f336ac.js";import"./RadioGroup-21807f37.js";import"./RangeSlider-48927c23.js";import"./react-sizeme-2217af01.js";import"./ColorGradient-fc5a110b.js";import"./colorPalette-43310703.js";import"./SelectionCriteriaPill-bb605601.js";import"./Close-58560370.js";import"./relativeTime-93b00284.js";import"./useDownloadList-6e24752f.js";import"./QueryCount-317884bf.js";import"./react-select.esm-fb33f5c9.js";import"./IconList-d607a423.js";import"./UserCardList-a021ae9a.js";import"./useAccessRequirements-490910b8.js";import"./RestrictionInformation-4ed2591e.js";import"./ManagedACTAccessRequirementStatus-9671fe8d.js";import"./FileUpload-aacd4bce.js";import"./UserSearchBox-cb153f0e.js";import"./UserOrTeamBadge-e31a6488.js";import"./EntityLink-c7ed8518.js";import"./ErrorChip-eb431605.js";import"./SynapseVideo-6aa34053.js";import"./UserSearchBoxV2-dd857a68.js";import"./startCase-6fa446f1.js";import"./upperFirst-6d18bcef.js";import"./useWillUnmount-7fb15b8a.js";const N=({forumId:i,limit:E,filter:f,onClickLink:D})=>{const[e,b]=u.useState(p.PINNED_AND_LAST_ACTIVITY),[s,l]=u.useState(!1),{data:h,hasNextPage:I,fetchNextPage:g}=Y(i,E,e,s,f),{data:d}=O(i),{data:S}=V(),A=(h==null?void 0:h.pages.flatMap(t=>t.results))??[],c=t=>{e==t?(b(t),l(!s)):(b(t),l(!1))};return d==null||d.results.includes((S==null?void 0:S.ownerId)??""),o("div",{className:"ForumTable bootstrap-4-backport",children:[o($,{children:[r("thead",{children:o("tr",{children:[r("th",{children:o("span",{className:"SRC-split",children:[r("span",{children:"Topic"}),r(C,{role:"button","aria-label":"Sort by Topic",active:e===p.THREAD_TITLE,direction:e==="THREAD_TITLE"?s===!1?a.DESC:a.ASC:a.DESC,onClick:()=>c(p.THREAD_TITLE)})]})}),r("th",{children:"Author"}),r("th",{children:"Active Users"}),r("th",{children:o("span",{className:"SRC-split",children:[r("span",{children:"Replies"}),r(C,{role:"button","aria-label":"Sort by Replies",active:e===p.NUMBER_OF_REPLIES,direction:e==="NUMBER_OF_REPLIES"?s===!1?a.DESC:a.ASC:a.DESC,onClick:()=>c(p.NUMBER_OF_REPLIES)})]})}),r("th",{children:o("span",{className:"SRC-split",children:[r("span",{children:"Views"}),r(C,{role:"button","aria-label":"Sort by Views",active:e===p.NUMBER_OF_VIEWS,direction:e==="NUMBER_OF_VIEWS"?s===!1?a.DESC:a.ASC:a.DESC,onClick:()=>c(p.NUMBER_OF_VIEWS)})]})}),r("th",{children:o("span",{className:"SRC-split",children:[r("span",{children:"Activity"}),r(C,{role:"button","aria-label":"Sort by Last Activity",active:e===p.PINNED_AND_LAST_ACTIVITY,direction:e==="PINNED_AND_LAST_ACTIVITY"?s===!1?a.DESC:a.ASC:a.DESC,onClick:()=>c(p.PINNED_AND_LAST_ACTIVITY)})]})})]})}),r("tbody",{children:A.map(t=>o("tr",{children:[r("td",{children:o("a",{onClick:()=>D(),children:[t.isPinned?r(X,{icon:"pushpin"}):r(k,{}),t.title]})}),r("td",{children:r(w,{size:H,ownerId:t.createdBy})}),r("td",{children:t.activeAuthors.map(m=>r("div",{className:"avatarContainer",children:r(w,{showCardOnHover:!0,className:"ActiveUsers",size:x,avatarSize:"MEDIUM",ownerId:m})},m))}),r("td",{children:t.numberOfReplies}),r("td",{children:t.numberOfViews}),r("td",{children:W(t.lastActivity).format("L")})]},t.id))})]}),I&&r(_,{variant:"outline-primary",onClick:()=>{g()},children:"Show more results"})]})};try{N.displayName="ForumTable",N.__docgenInfo={description:"",displayName:"ForumTable",props:{forumId:{defaultValue:null,description:"",name:"forumId",required:!0,type:{name:"string"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},onClickLink:{defaultValue:null,description:"",name:"onClickLink",required:!0,type:{name:"() => void"}},filter:{defaultValue:null,description:"",name:"filter",required:!0,type:{name:"enum",value:[{value:'"NO_FILTER"'},{value:'"DELETED_ONLY"'},{value:'"EXCLUDE_DELETED"'}]}}}}}catch{}const Q="You will need to sign in for access to that resource",y=({forumId:i,limit:E,onClickLink:f})=>{const[D,e]=u.useState(!1),[b,s]=u.useState(!1),[l,h]=u.useState(!1),[I,g]=u.useState(!1),{subscription:d,isLoading:S,toggleSubscribed:A}=j(i,v.FORUM);function c(){try{A()}catch(B){z(B.reason,"danger")}}const{data:t}=O(i),{data:m}=V(),P=t==null?void 0:t.results.includes((m==null?void 0:m.ownerId)??""),U=()=>{(m==null?void 0:m.userName)=="anonymous"?s(!0):e(!0)};return o("div",{className:"ForumTable bootstrap-4-backport",children:[o("div",{className:"ForumTable__top-level-control",children:[r(G,{id:i,objectType:v.FORUM,showModal:I,handleModal:g}),r(_,{variant:d?"outline-primary":"primary",onClick:()=>c(),disabled:S,children:d?"Unfollow":"Follow"}),r(_,{variant:"primary",onClick:()=>U(),children:"New Thread"}),P&&r(_,{onClick:()=>h(!l),children:l?"Hide Deleted Threads":"Show Deleted Threads"})]}),l&&o(k,{children:[r(K,{variant:"h4",children:"Deleted Threads"}),r(N,{onClickLink:f,forumId:i,limit:E,filter:F.DELETED_ONLY})]}),r(N,{onClickLink:f,forumId:i,limit:E,filter:F.EXCLUDE_DELETED}),o(n,{size:"lg",show:D,onHide:()=>e(!1),animation:!1,children:[r(n.Header,{children:r(n.Title,{children:"New Thread"})}),r(n.Body,{children:r(J,{isReply:!1,id:i,onClose:()=>e(!1)})})]}),o(n,{className:"bootstrap-4-backport",show:b,onHide:()=>s(!1),animation:!1,children:[r(n.Header,{closeButton:!0}),r(n.Body,{children:Q}),r(n.Footer,{children:r(_,{onClick:()=>s(!1),className:q,children:"Sign In"})})]})]})};try{y.displayName="ForumPage",y.__docgenInfo={description:"",displayName:"ForumPage",props:{forumId:{defaultValue:null,description:"",name:"forumId",required:!0,type:{name:"string"}},limit:{defaultValue:null,description:"",name:"limit",required:!0,type:{name:"number"}},onClickLink:{defaultValue:null,description:"",name:"onClickLink",required:!0,type:{name:"() => void"}}}}}catch{}const Oe={title:"Synapse/ForumPage",component:y,argTypes:{}},Z=i=>r(y,{...i}),T=Z.bind({});T.args={forumId:"381943",limit:20,onClickLink:()=>alert("This functionality has not been implemented yet")};var L,R,M;T.parameters={...T.parameters,docs:{...(L=T.parameters)==null?void 0:L.docs,source:{originalSource:"args => <ForumPage {...args} />",...(M=(R=T.parameters)==null?void 0:R.docs)==null?void 0:M.source}}};const Pe=["ForumPageDemo"];export{T as ForumPageDemo,Pe as __namedExportsOrder,Oe as default};
//# sourceMappingURL=ForumPage.stories-a310da9b.js.map
