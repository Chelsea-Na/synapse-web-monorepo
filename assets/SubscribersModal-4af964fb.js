import{a4 as o,a6 as m,cK as T,cL as I,cM as D,bJ as f,cN as E,cO as M,cP as g}from"./index-5643b5a3.js";import{u as h}from"./useInfiniteQuery-2d662a61.js";import{a as _,j as i}from"./jsx-runtime-670450c2.js";import{u as p}from"./useMutation-40c5a537.js";import{D as O}from"./EntityChildren-7cd71d6e.js";import{r as R}from"./index-f1f749bf.js";import{U}from"./UserCard-abb8fee0.js";import{h as B}from"./SynapseConstants-f1d07af3.js";import{M as c}from"./Modal-03fc1f7b.js";import{B as N}from"./Button-2476b393.js";function K(e,s){const{accessToken:r}=o();return m(["moderators",e],()=>T(r,e),s)}function $(e,s,r,t,a,n){const{accessToken:l}=o();return h(["forumthread",e,"infinite",s,a,r,t],async u=>I(l,e,u.pageParam,s,r,t,a),{...n,getNextPageParam:(u,S)=>{const d=S.flatMap(b=>b.results).length;if(u.totalNumberOfResults>d)return d}})}var v=(e=>(e.FORUM="FORUM",e.THREAD="THREAD",e.DATA_ACCESS_SUBMISSION="DATA_ACCESS_SUBMISSION",e.DATA_ACCESS_SUBMISSION_STATUS="DATA_ACCESS_SUBMISSION_STATUS",e))(v||{}),A=(e=>(e.SUBSCRIPTION_ID="SUBSCRIPTION_ID",e.SUBSCRIBER_ID="SUBSCRIBER_ID",e.OBJECT_ID="OBJECT_ID",e.OBJECT_TYPE="OBJECT_TYPE",e.CREATED_ON="CREATED_ON",e))(A||{});function w(e,s){const{accessToken:r}=o();return m(["subscriber",e.objectId,e.objectType],()=>D(r,e),s)}function L(e,s,r){const{accessToken:t}=o();return m([t,"subscription",e,s],async()=>{const n={objectType:s,idList:[e],sortByType:A.OBJECT_ID,sortDirection:O.ASC};return(await g(t,n)).results[0]},r)}function y(e){const s=f(),{accessToken:r}=o();return p(t=>E(r,t),{...e,onSuccess:async(t,a,n)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber",a.objectId,a.objectType]),e!=null&&e.onSuccess&&await e.onSuccess(t,a,n)}})}function k(e){const s=f(),{accessToken:r}=o();return p(t=>M(r,t),{...e,onSuccess:async(t,a,n)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber"]),e!=null&&e.onSuccess&&await e.onSuccess(t,a,n)}})}const F=(e,s)=>{const{data:r,isLoading:t}=L(e,s),{data:a}=w({objectId:e,objectType:s}),{mutate:n,isLoading:l}=y(),{mutate:u,isLoading:S}=k(),d=t||l||S,b=R.useCallback(()=>{r?u(r.subscriptionId):n({objectId:e,objectType:s})},[u,e,s,n,r]);return{isLoading:d,subscription:r,toggleSubscribed:b,subscribers:a}},C=({id:e,objectType:s,showModal:r,handleModal:t})=>{const{subscribers:a}=F(e,s);return _("div",{className:"SubscribersModal",children:[a&&a.subscribers.length>0&&i("a",{onClick:()=>t(!0),children:`Followers (${a.subscribers.length})`}),_(c,{className:"bootstrap-4-backport",show:r,onHide:()=>t(!1),animation:!1,children:[i(c.Header,{closeButton:!0,children:i(c.Title,{children:"Followers"})}),i(c.Body,{children:a&&a.subscribers.map(n=>i(U,{ownerId:n,size:B,showCardOnHover:!0},n))}),i(c.Footer,{children:i(N,{variant:"contained",onClick:()=>t(!1),children:"Ok"})})]})]})};try{C.displayName="SubscribersModal",C.__docgenInfo={description:"",displayName:"SubscribersModal",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},objectType:{defaultValue:null,description:"",name:"objectType",required:!0,type:{name:"enum",value:[{value:'"FORUM"'},{value:'"THREAD"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'}]}},showModal:{defaultValue:null,description:"",name:"showModal",required:!0,type:{name:"boolean"}},handleModal:{defaultValue:null,description:"",name:"handleModal",required:!0,type:{name:"(a: boolean) => void"}}}}}catch{}export{v as S,F as a,C as b,$ as c,K as u};
//# sourceMappingURL=SubscribersModal-4af964fb.js.map
