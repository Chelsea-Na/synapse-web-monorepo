import{a as t,j as e,F as c}from"./jsx-runtime-095bf462.js";import{d as h}from"./dayjs.min-59ef0ea6.js";import{r as S,R as y}from"./index-8db94870.js";import{m as C,ac as F,a1 as j,f as B}from"./SynapseClient-dc58dd78.js";import{f as b}from"./DateFormatter-02d8c0d6.js";import{u as U,a as N}from"./useDataAccessSubmission-7d5fc94f.js";import{u as P,a as O,b as E}from"./useAccessRequirements-d7daf186.js";import{A as H}from"./SynapseConstants-c9342f94.js";import{d as K,F as _,a as k}from"./SynapseTableCell-5abfdf9f.js";import{W as M}from"./WarningDialog-effc0397.js";import{U as A}from"./UserOrTeamBadge-d6172446.js";import{R as L}from"./RejectDataAccessRequestModal-c4346961.js";import{a as v}from"./UserBadge-927d587b.js";import{T as i}from"./Typography-d16533eb.js";import{S as d}from"./Skeleton-2bd04c38.js";import{B as R}from"./Button-c45f00b4.js";import{u as V,t as W}from"./ThemesPlot-000cb61c.js";h.extend(K);function f(l){const{submissionId:r,fileHandleId:o}=l,m=y.useMemo(()=>({fileHandleId:o,associateObjectId:r,associateObjectType:j.DataAccessSubmissionAttachment}),[o,r]);return e(_,{showDownloadIcon:!0,fileHandleAssociation:m},o)}function G(l){return e(M,{open:l.open,title:"Approve Request?",content:t(c,{children:[e(i,{variant:"body1",sx:{marginBottom:"10px"},children:"Approving the request will grant access to controlled data."}),e(i,{variant:"body1",children:"In addition, the user will receive an email notification alerting them that the request has been granted."})]}),onConfirm:l.onConfirm,onConfirmCallbackArgs:[],onCancel:l.onCancel,confirmButtonText:"Approve"})}function $(l){const{data:r}=E(l.accessRequirementId,{useErrorBoundary:!0});return r?e("div",{className:"AccessRequirementWikiContainer",children:t("div",{className:"AccessRequirementWikiContent",children:[e(i,{variant:"headline1",children:"Access Requirement"}),e("hr",{}),e(k,{wikiId:r==null?void 0:r.wikiPageId,ownerId:r==null?void 0:r.ownerObjectId,objectType:r==null?void 0:r.ownerObjectType})]})}):e(d,{width:"100%",height:"600px"})}function w(l){var I;const{submissionId:r}=l,[o,m]=S.useState(!1),D=C(),{data:a,refetch:q}=U(r,{useErrorBoundary:!0}),{mutateAsync:x}=N(),{data:n}=P(parseInt(a==null?void 0:a.accessRequirementId),{enabled:!!a}),{data:u}=O(a==null?void 0:a.accessRequirementId,{enabled:!!a,useErrorBoundary:!0}),[T,p]=S.useState(!1);function g(){return x({submissionId:(a==null?void 0:a.id)??"",newState:B.APPROVED})}return t("div",{className:"SubmissionPage",children:[e(G,{open:T,onCancel:()=>{p(!1)},onConfirm:async()=>{try{await g()}catch(s){D(s)}p(!1),q()}}),e(L,{submissionId:r,open:o,onClose:()=>m(!1)},r),t("div",{className:"SubmissionSummary",children:[e(i,{variant:"dataFieldKey",children:"Status"}),e(i,{variant:"headline3",children:a?a.state:e(d,{width:100})}),e("br",{}),a?a.state==="SUBMITTED"&&t("div",{className:"ButtonContainer",children:[e(R,{onClick:()=>{p(!0)},color:"success",variant:"contained",children:"Approve"}),e(R,{onClick:()=>{m(!0)},color:"error",variant:"contained",children:"Reject"})]}):e(d,{width:200}),e(i,{variant:"dataFieldKey",children:"Access Requirement Name"}),e(i,{variant:"smallText1",children:(n==null?void 0:n.name)??e(d,{width:100})}),e("br",{}),e(i,{variant:"dataFieldKey",children:"Assigned Reviewer"}),e(i,{variant:"smallText1",children:u!==void 0?u!==null?u.resourceAccess.map(s=>e(A,{principalId:s.principalId},s.principalId)):e(A,{principalId:H}):e(d,{width:100})}),e("br",{}),e(i,{variant:"dataFieldKey",children:"Conditions"}),n?e(i,{variant:"smallText1",component:"div",children:t("ul",{children:[t("li",{children:["Expiration period:"," ",h.duration({milliseconds:n.expirationPeriod}).asDays()," ","day(s)",n.expirationPeriod===0&&" (no expiration)"]}),n.isCertifiedUserRequired&&e("li",{children:"User must be Certified"}),n.isValidatedProfileRequired&&e("li",{children:"User Profile must be Validated"}),n.isDUCRequired&&e("li",{children:"DUC is required"}),n.isIDURequired&&e("li",{children:"IDU is required"}),n.isIDUPublic&&e("li",{children:"IDU will be made public"}),n.isIRBApprovalRequired&&e("li",{children:"IRB Approval is required"}),n.areOtherAttachmentsRequired&&e("li",{children:"Other attachments are required"})]})}):e(d,{width:100}),e("br",{}),t("div",{className:"SubmissionSummaryGrid",children:[e(i,{variant:"dataFieldKey",children:"Submitted By"}),e(i,{variant:"smallText1",children:a?e(v,{userId:a.submittedBy}):e(d,{width:100})}),e(i,{variant:"dataFieldKey",children:"Submitted On"}),e(i,{variant:"smallText1",children:a?b(h(a.submittedOn)):e(d,{width:100})}),e(i,{variant:"dataFieldKey",children:"Modified By"}),e(i,{variant:"smallText1",children:a?e(v,{userId:a.modifiedBy}):e(d,{width:100})}),e(i,{variant:"dataFieldKey",children:"Modified On"}),e(i,{variant:"smallText1",children:a?b(h(a.modifiedOn)):e(d,{width:100})}),t(i,{className:"Key",variant:"dataFieldKey",children:["Data Requesters",`${a?` (${a.accessorChanges.length})`:""}`]}),a?a.accessorChanges.map(s=>t(y.Fragment,{children:[e(i,{className:"Key DataAccessor",variant:"smallText1",children:e("span",{style:{whiteSpace:"nowrap"},children:e(v,{userId:s.userId},s.userId)})}),e(i,{className:"Value DataAccessor",variant:"smallText1",children:V(W(s.type.substring(0,s.type.indexOf("_"))))})]},s.userId)):e(d,{width:100}),e(i,{className:"Key",variant:"dataFieldKey",children:"Institution"}),e(i,{className:"Value",variant:"smallText1",children:a?a.researchProjectSnapshot.institution:e(d,{width:100})}),e(i,{className:"Key",variant:"dataFieldKey",children:"Project Lead"}),e(i,{className:"Value",variant:"smallText1",children:a?a.researchProjectSnapshot.projectLead:e(d,{width:100})})]})]}),t("div",{className:"SubmissionRightPane",children:[e(F,{children:a?e($,{accessRequirementId:a.accessRequirementId}):e(c,{})}),t("div",{children:[(a==null?void 0:a.rejectedReason)&&t(c,{children:[e(i,{variant:"headline1",children:"Reason for rejection given by reviewer"}),e("hr",{}),e(i,{variant:"body1",style:{whiteSpace:"pre-line"},children:a.rejectedReason})]}),e(i,{variant:"headline1",children:"Contents of the Access Request"}),e("hr",{}),((I=a==null?void 0:a.researchProjectSnapshot)==null?void 0:I.intendedDataUseStatement)&&t(c,{children:[e(i,{variant:"headline2",children:"Intended Data Use Statement"}),e(i,{variant:"body1",style:{whiteSpace:"pre-line"},children:a.researchProjectSnapshot.intendedDataUseStatement})]}),e(i,{variant:"headline2",children:"Documents"}),(a==null?void 0:a.ducFileHandleId)&&t(c,{children:[e(i,{variant:"smallText2",children:"Data Use Certificate (DUC)"}),e(f,{submissionId:a.id,fileHandleId:a.ducFileHandleId})]}),(a==null?void 0:a.irbFileHandleId)&&t(c,{children:[e(i,{variant:"smallText2",children:"IRB Approval Letter"}),e(f,{submissionId:a.id,fileHandleId:a.irbFileHandleId})]}),(a==null?void 0:a.attachments)&&t(c,{children:[e(i,{variant:"smallText2",children:"Other Attachments"}),a.attachments.map(s=>t(y.Fragment,{children:[e(f,{submissionId:a.id,fileHandleId:s}),e("br",{})]},s))]})]})]})]})}try{w.displayName="SubmissionPage",w.__docgenInfo={description:"Page for a Data Access Submission that a designated reviewer can view, and choose to approve or reject.",displayName:"SubmissionPage",props:{submissionId:{defaultValue:null,description:"The ID of the submission to view",name:"submissionId",required:!0,type:{name:"string | number"}}}}}catch{}export{w as S};
//# sourceMappingURL=SubmissionPage-5d886592.js.map
