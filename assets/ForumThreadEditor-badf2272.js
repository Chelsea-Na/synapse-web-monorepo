import{j as c,F as k,a as F}from"./jsx-runtime-095bf462.js";import{r as q}from"./index-8db94870.js";import{c as N,d as U,e as A}from"./useThread-69527ecd.js";import{u as d,w as m,x as P,y as f}from"./SynapseClient-0de7e8d0.js";import{u as h}from"./useMutation-eb55a024.js";import{u as j}from"./useInfiniteQuery-dab380e5.js";import{M as B}from"./MarkdownEditor-e629d10c.js";import{a as G,r as O}from"./ConfirmationDialog-fb2440c3.js";import{B as z}from"./Box-891dc3c7.js";import{F as H}from"./Form-18a51c1e.js";function oe(e,n,r,a,t,s){const{accessToken:i,keyFactory:y}=d();return j(y.getRepliesQueryKey(e,n,r,a,t),async o=>m.getReplies(i,e,r,o.pageParam,a,n,t),{...s,getNextPageParam:(o,p)=>{const l=p.flatMap(g=>g.results).length;if(o.totalNumberOfResults>l)return l}})}function le(e,n){const{accessToken:r,keyFactory:a}=d(),t=async()=>{const s=await m.getReplyMessageUrl(e.messageKey,r);return(await fetch(s.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return P(a.getReplyQueryKey(e.threadId,e.id,e.messageKey),t,n)}function W(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.postReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function J(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.putReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function ue(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.deleteReply(r,t.replyId),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(s.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}const w=e=>{const{initialText:n,initialTitle:r,id:a,onClose:t,isReply:s,isDialog:i,openDialog:y}=e,[o,p]=q.useState(r??""),[l,g]=q.useState(n??""),{mutate:I,isLoading:M}=N({onSuccess:()=>t()}),{mutate:L,isLoading:Q}=U({onSuccess:()=>t()}),{mutate:v,isLoading:E}=A({onSuccess:()=>t()}),{mutate:D,isLoading:_}=W({onSuccess:()=>t()}),{mutate:b,isLoading:K}=J({onSuccess:()=>t()}),V=Q||_||E||M||K,T=!s&&r,R=(u,x)=>{s?n?b({replyId:a,messageMarkdown:u}):D({threadId:a,messageMarkdown:u}):T?(I({title:x,threadId:a}),L({messageMarkdown:u,threadId:a})):v({forumId:a,title:x,messageMarkdown:u})},C=F("div",{className:"bootstrap-4-backport",children:[!s&&c(H,{type:"text",placeholder:"Title",value:o,onChange:u=>p(u.target.value)}),c(B,{text:l,setText:g})]}),S=V?"Saving":"Save";return c(k,{children:i?c(G,{maxWidth:"md",open:y,onCancel:t,title:s?"Edit Reply":T?"Edit Thread":"New Thread",content:C,onConfirm:()=>R(l,o),confirmButtonText:S}):F(k,{children:[C,c(z,{display:"flex",justifyContent:"flex-end",children:c(O,{onCancel:t,onConfirm:()=>R(l,o),confirmButtonText:S})})]})})};try{w.displayName="ForumThreadEditor",w.__docgenInfo={description:"",displayName:"ForumThreadEditor",props:{initialTitle:{defaultValue:null,description:"",name:"initialTitle",required:!1,type:{name:"string"}},initialText:{defaultValue:null,description:"",name:"initialText",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}},isDialog:{defaultValue:null,description:"",name:"isDialog",required:!0,type:{name:"boolean"}},openDialog:{defaultValue:null,description:"",name:"openDialog",required:!1,type:{name:"boolean"}}}}}catch{}export{w as F,ue as a,oe as b,le as u};
//# sourceMappingURL=ForumThreadEditor-badf2272.js.map
