import{j as m,a as k}from"./jsx-runtime-ad672792.js";import{r as i,R as w}from"./index-f1f749bf.js";import{P as C,o as O,a as T,b as S,s as b,g as v,i as x,c as A,d as D,e as _,S as I,f as N,h as Q}from"./SynapseContext-3e3caab0.js";import{S as U}from"./ToastMessage-4759781b.js";import{d as F}from"./dayjs.min-e0adaab4.js";import{P as M,B as h,S as L}from"./getEndpoint-5374ab4d.js";import{d as j,F as q,a as B,p as G,s as W,m as H,b as K,c as V,n as $,e as z,f as J,g as X,h as Y,i as Z,j as ee}from"./FullContextProvider-3c637ca7.js";import{M as te}from"./react-router-2ef9c84a.js";import{Q as oe}from"./queryClient-c21a3f8e.js";function ae(e={}){const{onSignInComplete:o,registerAccountUrl:a=`${M.PORTAL}#!RegisterAccount:0`,onError:t,onTwoFactorAuthRequired:u}=e;i.useEffect(()=>{const n=v(),R=new URL(window.location.href),{searchParams:d}=R;if(!d)return;const p=d.get("code"),r=d.get("provider"),y=d.get("state");if(p&&r){const P=`${n}?provider=${r}`;if(C.GOOGLE==r){const f=s=>{"accessToken"in s?b(s.accessToken).then(o):u&&u(s)},c=s=>{s.status===404&&window.location.replace(a),console.error("Error with Google account association: ",s),t&&t(s.reason)};y?O(y,r,p,P,h.REPO_ENDPOINT).then(f).catch(c):T(r,p,P,h.REPO_ENDPOINT).then(f).catch(c)}else if(C.ORCID==r){const f=c=>{console.error("Error binding ORCiD to account: ",c),t&&t(c.reason)};S(r,p,P,h.REPO_ENDPOINT).then(o).catch(f)}}},[])}var g={},re={get exports(){return g},set exports(e){g=e}};re.exports={ReactQueryDevtools:function(){return null},ReactQueryDevtoolsPanel:function(){return null}};async function se(){let e=await D(),o;try{o=await _(e)}catch(t){throw t instanceof I&&t.status===401&&(console.error("Encountered error fetching profile: ",t,"Signing out..."),await N(),e=void 0),t}let a;return e&&Q(e).then(t=>{a=F(t.authenticatedOn).format("L LT")}),{accessToken:e,profile:o,authenticatedOn:a}}const l=new oe(j);function ne(e){const o=L[e];window.SRC={OVERRIDE_ENDPOINT_CONFIG:o},l.resetQueries()}const ce={default:G,sageBionetworks:W,mtb:H,arkPortal:K,adKnowledgePortal:V,nfPortal:$,bsmnPortal:z,psychEncodePortal:J,stopAdPortal:X,digitalHealthPortal:Y,crcResearcherPortal:Z,cancerComplexityPortal:ee};function E(e){const{storybookContext:o}=e;i.useEffect(()=>{ne(o.globals.stack)},[o.globals.stack]);const[a,t]=w.useState(void 0);ae(),i.useEffect(()=>{se().then(n=>{t(n.accessToken)})}),i.useEffect(()=>{async function n(){await l.cancelQueries(),l.removeQueries(),await l.invalidateQueries()}n()},[a]);const u=i.useMemo(()=>({accessToken:a,isInExperimentalMode:x(),utcTime:A(),withErrorBoundary:!0,downloadCartPageUrl:"/?path=/story/download-downloadcartpage--demo"}),[a]);return m(q,{queryClient:l,synapseContext:u,theme:{...B,palette:ce[o.globals.palette]},children:k(te,{children:[o.globals.showReactQueryDevtools&&m(g.ReactQueryDevtools,{}),m(U,{}),m("main",{children:e.children})]})},a)}try{E.displayName="StorybookComponentWrapper",E.__docgenInfo={description:"Wraps storybook story components to ensure that all components receive required context.",displayName:"StorybookComponentWrapper",props:{storybookContext:{defaultValue:null,description:"",name:"storybookContext",required:!0,type:{name:"any"}}}}}catch{}export{E as S,se as s};
//# sourceMappingURL=StorybookComponentWrapper-306ba095.js.map
