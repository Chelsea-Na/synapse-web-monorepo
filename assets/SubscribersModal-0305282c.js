import{a as S,j as n}from"./jsx-runtime-670450c2.js";import{a4 as c,a6 as b,cS as T,bJ as _,cT as f,cU as D,cV as E}from"./SynapseContext-3aa05249.js";import{u as m}from"./useMutation-ab762554.js";import{D as U}from"./EntityChildren-7cd71d6e.js";import{r as M}from"./index-f1f749bf.js";import{U as B}from"./UserCard-de675005.js";import{h as O}from"./SynapseConstants-6db32387.js";import{M as u}from"./Modal-29f84dca.js";import{B as R}from"./Button-475c86c5.js";var h=(e=>(e.FORUM="FORUM",e.THREAD="THREAD",e.DATA_ACCESS_SUBMISSION="DATA_ACCESS_SUBMISSION",e.DATA_ACCESS_SUBMISSION_STATUS="DATA_ACCESS_SUBMISSION_STATUS",e))(h||{}),C=(e=>(e.SUBSCRIPTION_ID="SUBSCRIPTION_ID",e.SUBSCRIBER_ID="SUBSCRIBER_ID",e.OBJECT_ID="OBJECT_ID",e.OBJECT_TYPE="OBJECT_TYPE",e.CREATED_ON="CREATED_ON",e))(C||{});function g(e,s){const{accessToken:r}=c();return b(["subscriber",e.objectId,e.objectType],()=>T(r,e),s)}function w(e,s,r){const{accessToken:i}=c();return b([i,"subscription",e,s],async()=>{const t={objectType:s,idList:[e],sortByType:C.OBJECT_ID,sortDirection:U.ASC};return(await E(i,t)).results[0]},r)}function N(e){const s=_(),{accessToken:r}=c();return m(i=>f(r,i),{...e,onSuccess:async(i,a,t)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber",a.objectId,a.objectType]),e!=null&&e.onSuccess&&await e.onSuccess(i,a,t)}})}function v(e){const s=_(),{accessToken:r}=c();return m(i=>D(r,i),{...e,onSuccess:async(i,a,t)=>{await s.invalidateQueries([r,"subscription"]),await s.invalidateQueries(["subscriber"]),e!=null&&e.onSuccess&&await e.onSuccess(i,a,t)}})}const L=(e,s)=>{const{data:r,isLoading:i}=w(e,s),{data:a}=g({objectId:e,objectType:s}),{mutate:t,isLoading:o}=N(),{mutate:l,isLoading:A}=v(),p=i||o||A,I=M.useCallback(()=>{r?l(r.subscriptionId):t({objectId:e,objectType:s})},[l,e,s,t,r]);return{isLoading:p,subscription:r,toggleSubscribed:I,subscribers:a}},d=({id:e,objectType:s,showModal:r,handleModal:i})=>{const{subscribers:a}=L(e,s);return S("div",{className:"SubscribersModal",children:[a&&a.subscribers.length>0&&n("a",{onClick:()=>i(!0),children:`Followers (${a.subscribers.length})`}),S(u,{className:"bootstrap-4-backport",show:r,onHide:()=>i(!1),animation:!1,children:[n(u.Header,{closeButton:!0,children:n(u.Title,{children:"Followers"})}),n(u.Body,{children:a&&a.subscribers.map(t=>n(B,{ownerId:t,size:O,showCardOnHover:!0},t))}),n(u.Footer,{children:n(R,{variant:"contained",onClick:()=>i(!1),children:"Ok"})})]})]})};try{d.displayName="SubscribersModal",d.__docgenInfo={description:"",displayName:"SubscribersModal",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},objectType:{defaultValue:null,description:"",name:"objectType",required:!0,type:{name:"enum",value:[{value:'"FORUM"'},{value:'"THREAD"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'}]}},showModal:{defaultValue:null,description:"",name:"showModal",required:!0,type:{name:"boolean"}},handleModal:{defaultValue:null,description:"",name:"handleModal",required:!0,type:{name:"(a: boolean) => void"}}}}}catch{}export{h as S,d as a,L as u};
//# sourceMappingURL=SubscribersModal-0305282c.js.map
