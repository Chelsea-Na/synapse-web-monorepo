{"version":3,"file":"UserSearchBoxV2-ba5e4b78.js","sources":["../../../../node_modules/.pnpm/react-select@5.7.2_@types+react@18.0.27_react-dom@18.2.0_react@18.2.0/node_modules/react-select/dist/react-select.esm.js","../../src/lib/utils/hooks/useDebouncedEffect.ts","../../src/lib/containers/UserSearchBoxV2.tsx"],"sourcesContent":["import { u as useStateManager } from './useStateManager-7e1e8489.esm.js';\nexport { u as useStateManager } from './useStateManager-7e1e8489.esm.js';\nimport _extends from '@babel/runtime/helpers/esm/extends';\nimport * as React from 'react';\nimport { forwardRef, useMemo } from 'react';\nimport { S as Select } from './Select-457c486b.esm.js';\nexport { c as createFilter, d as defaultTheme, m as mergeStyles } from './Select-457c486b.esm.js';\nimport { CacheProvider } from '@emotion/react';\nimport createCache from '@emotion/cache';\nexport { c as components } from './index-a86253bb.esm.js';\nimport '@babel/runtime/helpers/objectSpread2';\nimport '@babel/runtime/helpers/slicedToArray';\nimport '@babel/runtime/helpers/objectWithoutProperties';\nimport '@babel/runtime/helpers/classCallCheck';\nimport '@babel/runtime/helpers/createClass';\nimport '@babel/runtime/helpers/inherits';\nimport '@babel/runtime/helpers/createSuper';\nimport '@babel/runtime/helpers/toConsumableArray';\nimport 'memoize-one';\nimport '@babel/runtime/helpers/typeof';\nimport '@babel/runtime/helpers/taggedTemplateLiteral';\nimport '@babel/runtime/helpers/defineProperty';\nimport 'react-dom';\nimport '@floating-ui/dom';\nimport 'use-isomorphic-layout-effect';\n\nvar StateManagedSelect = /*#__PURE__*/forwardRef(function (props, ref) {\n  var baseSelectProps = useStateManager(props);\n  return /*#__PURE__*/React.createElement(Select, _extends({\n    ref: ref\n  }, baseSelectProps));\n});\n\nvar NonceProvider = (function (_ref) {\n  var nonce = _ref.nonce,\n    children = _ref.children,\n    cacheKey = _ref.cacheKey;\n  var emotionCache = useMemo(function () {\n    return createCache({\n      key: cacheKey,\n      nonce: nonce\n    });\n  }, [cacheKey, nonce]);\n  return /*#__PURE__*/React.createElement(CacheProvider, {\n    value: emotionCache\n  }, children);\n});\n\nexport default StateManagedSelect;\nexport { NonceProvider };\n","import { useEffect } from 'react'\n\n/**\n * Debounces execution of an effect based on a specified delay.\n * See https://stackoverflow.com/a/61127960\n * @param effect\n * @param deps\n * @param delay\n */\nexport const useDebouncedEffect = (\n  effect: React.EffectCallback,\n  deps: React.DependencyList,\n  delay: number,\n) => {\n  useEffect(() => {\n    const handler = setTimeout(() => effect(), delay)\n\n    return () => clearTimeout(handler)\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, react-hooks/exhaustive-deps\n  }, [...(deps || []), delay])\n}\n","import { Skeleton } from '@mui/material'\nimport React, { useMemo, useState } from 'react'\nimport Select, {\n  components,\n  GroupBase,\n  PropsValue,\n  SelectComponentsConfig,\n} from 'react-select'\nimport { useSearchUserGroupHeaders } from '../utils/hooks/SynapseAPI'\nimport { useDebouncedEffect } from '../utils/hooks/useDebouncedEffect'\nimport useGetInfoFromIds from '../utils/hooks/useGetInfoFromIds'\nimport { UserGroupHeader } from '../utils/synapseTypes'\nimport { TYPE_FILTER } from '../utils/synapseTypes/UserGroupHeader'\nimport UserOrTeamBadge from './UserOrTeamBadge'\n\ntype UserSearchBoxValueType = {\n  id: string\n  value: string\n  label: string\n  header: UserGroupHeader\n} | null\n\nexport type UserSearchBoxProps = {\n  /* id for the input tag */\n  inputId?: string\n  /* The initial principal ID */\n  defaultValue?: string\n  onChange?: (\n    principalId: string | null,\n    header: UserGroupHeader | null,\n  ) => void\n  typeFilter?: TYPE_FILTER\n  filterPredicate?: (item: UserGroupHeader) => boolean\n  placeholder?: string\n  focusOnSelect?: boolean\n  /* The principal ID of the current selected user or team. If null, no selection is made. If undefined, state will be handled internally */\n  value?: PropsValue<UserSearchBoxValueType> | undefined\n}\n\nconst customSelectComponents: Partial<\n  SelectComponentsConfig<\n    UserSearchBoxValueType,\n    false,\n    GroupBase<UserSearchBoxValueType>\n  >\n> = {\n  Control: props => {\n    return (\n      <components.Control\n        {...props}\n        className={`form-control ${props.className ?? ''}`}\n      />\n    )\n  },\n  SingleValue: props => {\n    const { data } = props\n    return (\n      <components.SingleValue {...props} key={data?.id}>\n        <UserOrTeamBadge\n          key={data?.header.ownerId}\n          userGroupHeader={data?.header}\n          disableHref\n          showFullName\n        />\n      </components.SingleValue>\n    )\n  },\n  Option: props => {\n    const { data } = props\n    return (\n      <components.Option {...props} key={data?.id}>\n        <UserOrTeamBadge\n          userGroupHeader={data?.header}\n          disableHref={true}\n          showFullName={true}\n          showCardOnHover={false}\n        />\n      </components.Option>\n    )\n  },\n}\n\nconst UserSearchBoxV2: React.FC<UserSearchBoxProps> = props => {\n  const {\n    inputId,\n    defaultValue = null,\n    onChange,\n    filterPredicate,\n    typeFilter,\n    placeholder,\n    focusOnSelect = false,\n    value,\n  } = props\n  const [inputValue, setInputValue] = useState('')\n  const [debouncedInput, setDebouncedInput] = useState('')\n  useDebouncedEffect(\n    () => {\n      setDebouncedInput(inputValue)\n    },\n    [inputValue],\n    500,\n  )\n\n  const [defaultUserGroupHeader = undefined] =\n    useGetInfoFromIds<UserGroupHeader>({\n      ids: defaultValue ? [defaultValue] : [],\n      type: 'USER_PROFILE',\n    })\n\n  const { data, isLoading } = useSearchUserGroupHeaders(\n    debouncedInput,\n    typeFilter,\n  )\n\n  const selectRef = React.useRef<any>(null)\n  React.useEffect(() => {\n    if (focusOnSelect) {\n      selectRef.current && selectRef.current.focus()\n    }\n  })\n\n  const noOptionsMessage = useMemo(\n    () =>\n      isLoading || inputValue !== debouncedInput ? () => 'Loadingâ€¦' : undefined,\n    [isLoading, debouncedInput, inputValue],\n  )\n\n  const options = (data ?? [])\n    .filter(filterPredicate ?? (() => true))\n    // Map each user to an options object for the select input component\n    .map(item => ({\n      id: item.ownerId.toString(),\n      value: item.ownerId.toString(),\n      label: item.userName,\n      header: item,\n    }))\n\n  if (defaultValue && defaultUserGroupHeader == null) {\n    return <Skeleton width=\"100%\" />\n  }\n\n  return (\n    <Select\n      className=\"bootstrap-4-backport UserSearchBoxV2\"\n      ref={selectRef}\n      inputValue={inputValue}\n      onInputChange={setInputValue}\n      filterOption={() => true}\n      isLoading={isLoading}\n      options={(!isLoading && options) || []}\n      noOptionsMessage={noOptionsMessage}\n      defaultValue={\n        defaultValue\n          ? {\n              id: defaultValue,\n              value: defaultValue,\n              label: defaultUserGroupHeader!.userName,\n              header: defaultUserGroupHeader!,\n            }\n          : undefined\n      }\n      inputId={inputId}\n      isClearable\n      value={value}\n      styles={{\n        // Bootstrap's form-control class overrides the display value, manually set to flex (the default without Bootstrap)\n        control: styles => ({ ...styles, display: 'flex !important' }),\n        input: provided => ({\n          ...provided,\n          // SWC-6327 - Adjust the input style so a right-click focuses on the input field\n          input: {\n            gridArea: '1 / 2 / 4 / 4 !important',\n          },\n        }),\n      }}\n      components={customSelectComponents}\n      onChange={option => {\n        if (onChange) {\n          onChange(option?.id ?? null, option?.header ?? null)\n        }\n      }}\n      placeholder={placeholder}\n    />\n  )\n}\n\nexport default UserSearchBoxV2\n"],"names":["StateManagedSelect","forwardRef","props","ref","baseSelectProps","useStateManager","React.createElement","Select","_extends","useDebouncedEffect","effect","deps","delay","useEffect","handler","customSelectComponents","jsx","components","data","createElement","UserOrTeamBadge","UserSearchBoxV2","inputId","defaultValue","onChange","filterPredicate","typeFilter","placeholder","focusOnSelect","value","inputValue","setInputValue","useState","debouncedInput","setDebouncedInput","defaultUserGroupHeader","useGetInfoFromIds","isLoading","useSearchUserGroupHeaders","selectRef","React","noOptionsMessage","useMemo","options","item","Skeleton","styles","provided","option"],"mappings":"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","x_google_ignoreList":[0]}