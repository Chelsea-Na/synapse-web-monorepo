import{j as c,F as k,a as q}from"./jsx-runtime-095bf462.js";import{r as F}from"./index-8db94870.js";import{c as N,d as U,e as A}from"./useThread-35f7cc2e.js";import{u as d,n as m,z as P,G as f}from"./SynapseClient-3edb66de.js";import{u as h}from"./useMutation-b7361741.js";import{u as j}from"./useInfiniteQuery-714d9bf5.js";import"./getEndpoint-ac94413e.js";import"./OrientationBanner-9d515953.js";import{C as B,t as G,v as z}from"./SynapseTableCell-83d914b9.js";import{B as O}from"./Box-49321e59.js";import{a as H}from"./Form-93e8509c.js";function le(e,n,r,a,t,s){const{accessToken:i,keyFactory:y}=d();return j(y.getRepliesQueryKey(e,n,r,a,t),async o=>m.getReplies(i,e,r,o.pageParam,a,n,t),{...s,getNextPageParam:(o,p)=>{const l=p.flatMap(g=>g.results).length;if(o.totalNumberOfResults>l)return l}})}function ue(e,n){const{accessToken:r,keyFactory:a}=d(),t=async()=>{const s=await m.getReplyMessageUrl(e.messageKey,r);return(await fetch(s.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return P(a.getReplyQueryKey(e.threadId,e.id,e.messageKey),t,n)}function W(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.postReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function J(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.putReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function ce(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.deleteReply(r,t.replyId),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(s.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}const w=e=>{const{initialText:n,initialTitle:r,id:a,onClose:t,isReply:s,isDialog:i,openDialog:y}=e,[o,p]=F.useState(r??""),[l,g]=F.useState(n??""),{mutate:I,isLoading:v}=N({onSuccess:()=>t()}),{mutate:L,isLoading:M}=U({onSuccess:()=>t()}),{mutate:Q,isLoading:E}=A({onSuccess:()=>t()}),{mutate:D,isLoading:_}=W({onSuccess:()=>t()}),{mutate:b,isLoading:K}=J({onSuccess:()=>t()}),V=M||_||E||v||K,T=!s&&r,R=(u,x)=>{s?n?b({replyId:a,messageMarkdown:u}):D({threadId:a,messageMarkdown:u}):T?(I({title:x,threadId:a}),L({messageMarkdown:u,threadId:a})):Q({forumId:a,title:x,messageMarkdown:u})},C=q("div",{className:"bootstrap-4-backport",children:[!s&&c(H,{type:"text",placeholder:"Title",value:o,onChange:u=>p(u.target.value)}),c(z,{text:l,setText:g})]}),S=V?"Saving":"Save";return c(k,{children:i?c(B,{maxWidth:"md",open:y,onCancel:t,title:s?"Edit Reply":T?"Edit Thread":"New Thread",content:C,onConfirm:()=>R(l,o),confirmButtonText:S}):q(k,{children:[C,c(O,{display:"flex",justifyContent:"flex-end",children:c(G,{onCancel:t,onConfirm:()=>R(l,o),confirmButtonText:S})})]})})};try{w.displayName="ForumThreadEditor",w.__docgenInfo={description:"",displayName:"ForumThreadEditor",props:{initialTitle:{defaultValue:null,description:"",name:"initialTitle",required:!1,type:{name:"string"}},initialText:{defaultValue:null,description:"",name:"initialText",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}},isDialog:{defaultValue:null,description:"",name:"isDialog",required:!0,type:{name:"boolean"}},openDialog:{defaultValue:null,description:"",name:"openDialog",required:!1,type:{name:"boolean"}}}}}catch{}export{w as F,ce as a,le as b,ue as u};
//# sourceMappingURL=ForumThreadEditor-2aae0818.js.map
