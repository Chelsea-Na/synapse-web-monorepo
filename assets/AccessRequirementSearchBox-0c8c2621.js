import{j as P}from"./jsx-runtime-095bf462.js";import{_ as le}from"./extends-98964cd2.js";import{r as a}from"./index-8db94870.js";import{_ as ce,h as fe,a as I,u as Se,S as me,c as ve}from"./Select-457c486b.esm-387af9bf.js";import{_ as p,a as ge}from"./toConsumableArray-124bb3ab.js";import"./index-8ce4a492.js";import{u as he,aw as Oe,ax as _e}from"./EntityTypeUtils-1230d941.js";import"./getEndpoint-ac94413e.js";import{u as ye}from"./useAccessRequirements-7a94c295.js";import{S as Ie}from"./Skeleton-3aad52b9.js";var Ce=["defaultOptions","cacheOptions","loadOptions","options","isLoading","onInputChange","filterOption"];function Ae(t){var r=t.defaultOptions,e=r===void 0?!1:r,d=t.cacheOptions,l=d===void 0?!1:d,c=t.loadOptions;t.options;var i=t.isLoading,C=i===void 0?!1:i,h=t.onInputChange,n=t.filterOption,O=n===void 0?null:n,u=ce(t,Ce),S=u.inputValue,o=a.useRef(void 0),_=a.useRef(!1),F=a.useState(Array.isArray(e)?e:void 0),$=p(F,2),H=$[0],E=$[1],J=a.useState(typeof S<"u"?S:""),w=p(J,2),N=w[0],A=w[1],K=a.useState(e===!0),j=p(K,2),Q=j[0],m=j[1],U=a.useState(void 0),B=p(U,2),L=B[0],x=B[1],X=a.useState([]),D=p(X,2),Y=D[0],V=D[1],Z=a.useState(!1),k=p(Z,2),ee=k[0],y=k[1],te=a.useState({}),M=p(te,2),v=M[0],T=M[1],ae=a.useState(void 0),G=p(ae,2),ne=G[0],se=G[1],re=a.useState(void 0),W=p(re,2),oe=W[0],ie=W[1];l!==oe&&(T({}),ie(l)),e!==ne&&(E(Array.isArray(e)?e:void 0),se(e)),a.useEffect(function(){return _.current=!0,function(){_.current=!1}},[]);var b=a.useCallback(function(g,f){if(!c)return f();var s=c(g,f);s&&typeof s.then=="function"&&s.then(f,function(){return f()})},[c]);a.useEffect(function(){e===!0&&b(N,function(g){_.current&&(E(g||[]),m(!!o.current))})},[]);var ue=a.useCallback(function(g,f){var s=fe(g,f,h);if(!s){o.current=void 0,A(""),x(""),V([]),m(!1),y(!1);return}if(l&&v[s])A(s),x(s),V(v[s]),m(!1),y(!1);else{var de=o.current={};A(s),m(!0),y(!L),b(s,function(q){_&&de===o.current&&(o.current=void 0,m(!1),x(s),V(q||[]),y(!1),T(q?I(I({},v),{},ge({},s,q)):v))})}},[l,b,L,v,h]),pe=ee?[]:N&&L?Y:H||[];return I(I({},u),{},{options:pe,isLoading:Q||C,onInputChange:ue,filterOption:O})}var Le=a.forwardRef(function(t,r){var e=Ae(t),d=Se(e);return a.createElement(me,le({ref:r},d))});const xe=Le;function R(t,r){return t.toString()===r?r:`${r} (${t})`}const Ve={Control:t=>P(ve.Control,{...t,className:`form-control ${t.className??""}`})};function z(t){const{inputId:r,initialId:e,onChange:d,placeholder:l}=t,{accessToken:c}=he(),{data:i,isLoading:C}=ye(e,{enabled:!!e});async function h(n){var S;const O=parseInt(n);let u;return O&&(u=[await Oe(c,O)]),u||(u=(S=await _e(c,{nameContains:n}))==null?void 0:S.results),(u==null?void 0:u.map(o=>({id:o.id.toString(),value:o.id.toString(),label:R(o.id,o.name)})))??[]}return e&&C?P(Ie,{width:"100%"}):P(xe,{className:"bootstrap-4-backport",defaultInputValue:e?R(e,(i==null?void 0:i.name)??e.toString()):void 0,defaultOptions:e?[{id:e,value:e,label:R(e,(i==null?void 0:i.name)??e.toString())}]:!0,inputId:r,cacheOptions:!0,isClearable:!0,styles:{control:n=>({...n,display:"flex !important"}),input:n=>({...n,input:{gridArea:"1 / 2 / 4 / 4 !important"}})},components:Ve,loadOptions:h,onChange:n=>{d(n==null?void 0:n.id.toString())},placeholder:l})}try{z.displayName="AccessRequirementSearchBox",z.__docgenInfo={description:"",displayName:"AccessRequirementSearchBox",props:{inputId:{defaultValue:null,description:"",name:"inputId",required:!1,type:{name:"string"}},initialId:{defaultValue:null,description:"",name:"initialId",required:!1,type:{name:"string | number"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(accessRequirementId?: string | undefined) => void"}},placeholder:{defaultValue:null,description:"",name:"placeholder",required:!1,type:{name:"string"}}}}}catch{}export{z as A};
//# sourceMappingURL=AccessRequirementSearchBox-0c8c2621.js.map
