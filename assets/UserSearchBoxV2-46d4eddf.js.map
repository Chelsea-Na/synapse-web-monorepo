{"version":3,"file":"UserSearchBoxV2-46d4eddf.js","sources":["../../src/lib/utils/hooks/useDebouncedEffect.ts","../../src/lib/containers/UserSearchBoxV2.tsx"],"sourcesContent":["import { useEffect } from 'react'\n\n/**\n * Debounces execution of an effect based on a specified delay.\n * See https://stackoverflow.com/a/61127960\n * @param effect\n * @param deps\n * @param delay\n */\nexport const useDebouncedEffect = (\n  effect: React.EffectCallback,\n  deps: React.DependencyList,\n  delay: number,\n) => {\n  useEffect(() => {\n    const handler = setTimeout(() => effect(), delay)\n\n    return () => clearTimeout(handler)\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment, react-hooks/exhaustive-deps\n  }, [...(deps || []), delay])\n}\n","import { Skeleton } from '@mui/material'\nimport React, { useMemo, useState } from 'react'\nimport Select, {\n  components,\n  GroupBase,\n  SelectComponentsConfig,\n} from 'react-select'\nimport { useSearchUserGroupHeaders } from '../utils/hooks/SynapseAPI'\nimport { useDebouncedEffect } from '../utils/hooks/useDebouncedEffect'\nimport useGetInfoFromIds from '../utils/hooks/useGetInfoFromIds'\nimport { UserGroupHeader } from '../utils/synapseTypes'\nimport { TYPE_FILTER } from '../utils/synapseTypes/UserGroupHeader'\nimport UserOrTeamBadge from './UserOrTeamBadge'\n\nexport type UserSearchBoxProps = {\n  /* id for the input tag */\n  inputId?: string\n  /* The initial principal ID */\n  defaultValue?: string\n  onChange?: (\n    principalId: string | null,\n    header: UserGroupHeader | null,\n  ) => void\n  typeFilter?: TYPE_FILTER\n  filterPredicate?: (item: UserGroupHeader) => boolean\n  placeholder?: string\n  focusOnSelect?: boolean\n}\n\nconst customSelectComponents: Partial<\n  SelectComponentsConfig<\n    {\n      id: string\n      value: string\n      label: string\n      header: UserGroupHeader\n    },\n    false,\n    GroupBase<{\n      id: string\n      value: string\n      label: string\n      header: UserGroupHeader\n    }>\n  >\n> = {\n  Control: props => {\n    return (\n      <components.Control\n        {...props}\n        className={`form-control ${props.className ?? ''}`}\n      />\n    )\n  },\n  SingleValue: props => {\n    const { data } = props\n    return (\n      <components.SingleValue {...props} key={data.id}>\n        <UserOrTeamBadge\n          key={data.header.ownerId}\n          userGroupHeader={data.header}\n          disableHref={true}\n          showFullName={true}\n        />\n      </components.SingleValue>\n    )\n  },\n  Option: props => {\n    const { data } = props\n    return (\n      <components.Option {...props} key={data.id}>\n        <UserOrTeamBadge\n          userGroupHeader={data.header}\n          disableHref={true}\n          showFullName={true}\n        />\n      </components.Option>\n    )\n  },\n}\n\nconst UserSearchBoxV2: React.FC<UserSearchBoxProps> = props => {\n  const {\n    inputId,\n    defaultValue = null,\n    onChange,\n    filterPredicate,\n    typeFilter,\n    placeholder,\n    focusOnSelect = false,\n  } = props\n  const [inputValue, setInputValue] = useState('')\n  const [debouncedInput, setDebouncedInput] = useState('')\n  useDebouncedEffect(\n    () => {\n      setDebouncedInput(inputValue)\n    },\n    [inputValue],\n    500,\n  )\n\n  const [defaultUserGroupHeader = undefined] =\n    useGetInfoFromIds<UserGroupHeader>({\n      ids: defaultValue ? [defaultValue] : [],\n      type: 'USER_PROFILE',\n    })\n\n  const { data, isLoading } = useSearchUserGroupHeaders(\n    debouncedInput,\n    typeFilter,\n  )\n\n  const selectRef = React.useRef<any>(null)\n  React.useEffect(() => {\n    if (focusOnSelect) {\n      selectRef.current && selectRef.current.focus()\n    }\n  })\n\n  const noOptionsMessage = useMemo(\n    () =>\n      isLoading || inputValue !== debouncedInput ? () => 'Loadingâ€¦' : undefined,\n    [isLoading, debouncedInput, inputValue],\n  )\n\n  const options = (data ?? [])\n    .filter(filterPredicate ?? (() => true))\n    // Map the AR(s) to options for the select input component\n    .map(item => ({\n      id: item.ownerId.toString(),\n      value: item.ownerId.toString(),\n      label: item.userName,\n      header: item,\n    }))\n\n  if (defaultValue && defaultUserGroupHeader == null) {\n    return <Skeleton width=\"100%\" />\n  }\n\n  return (\n    <Select\n      className=\"bootstrap-4-backport UserSearchBoxV2\"\n      ref={selectRef}\n      inputValue={inputValue}\n      onInputChange={setInputValue}\n      filterOption={() => true}\n      isLoading={isLoading}\n      options={(!isLoading && options) || []}\n      noOptionsMessage={noOptionsMessage}\n      defaultValue={\n        defaultValue\n          ? {\n              id: defaultValue,\n              value: defaultValue,\n              label: defaultUserGroupHeader!.userName,\n              header: defaultUserGroupHeader!,\n            }\n          : undefined\n      }\n      inputId={inputId}\n      isClearable\n      styles={{\n        // Bootstrap's form-control class overrides the display value, manually set to flex (the default without Bootstrap)\n        control: styles => ({ ...styles, display: 'flex !important' }),\n        input: provided => ({\n          ...provided,\n          // SWC-6327 - Adjust the input style so a right-click focuses on the input field\n          input: {\n            gridArea: '1 / 2 / 4 / 4 !important',\n          },\n        }),\n      }}\n      components={customSelectComponents}\n      onChange={option => {\n        if (onChange) {\n          onChange(option?.id ?? null, option?.header ?? null)\n        }\n      }}\n      placeholder={placeholder}\n    />\n  )\n}\n\nexport default UserSearchBoxV2\n"],"names":["useDebouncedEffect","effect","deps","delay","useEffect","handler","customSelectComponents","props","jsx","components","data","createElement","UserOrTeamBadge","UserSearchBoxV2","inputId","defaultValue","onChange","filterPredicate","typeFilter","placeholder","focusOnSelect","inputValue","setInputValue","useState","debouncedInput","setDebouncedInput","defaultUserGroupHeader","useGetInfoFromIds","isLoading","useSearchUserGroupHeaders","selectRef","React","noOptionsMessage","useMemo","options","item","Skeleton","Select","styles","provided","option","UserSearchBoxV2$1"],"mappings":"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"}