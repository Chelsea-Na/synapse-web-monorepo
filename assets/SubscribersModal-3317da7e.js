import{a as S,j as u}from"./jsx-runtime-ad672792.js";import{ah as o,aj as b,cC as I,bt as _,cD as D,cE as E,cF as T}from"./SynapseContext-8bbc3558.js";import{u as m}from"./useMutation-2df3e17d.js";import{D as f}from"./EntityChildren-7cd71d6e.js";import{r as g}from"./index-f1f749bf.js";import{U as M}from"./UserCard-6ed4eafc.js";import{h as U}from"./SynapseConstants-9d1f6e44.js";import{M as c}from"./LoadingScreen-43345a4f.js";import{B}from"./Button-e0234af7.js";var h=(e=>(e.FORUM="FORUM",e.THREAD="THREAD",e.DATA_ACCESS_SUBMISSION="DATA_ACCESS_SUBMISSION",e.DATA_ACCESS_SUBMISSION_STATUS="DATA_ACCESS_SUBMISSION_STATUS",e))(h||{}),C=(e=>(e.SUBSCRIPTION_ID="SUBSCRIPTION_ID",e.SUBSCRIBER_ID="SUBSCRIBER_ID",e.OBJECT_ID="OBJECT_ID",e.OBJECT_TYPE="OBJECT_TYPE",e.CREATED_ON="CREATED_ON",e))(C||{});function O(e,s){const{accessToken:a,keyFactory:t}=o();return b(t.getSubscribersQueryKey(e.objectId,e.objectType),()=>I(a,e),s)}function R(e,s,a){const{accessToken:t,keyFactory:r}=o(),i=async()=>{const n={objectType:s,idList:[e],sortByType:C.OBJECT_ID,sortDirection:f.ASC};return(await T(t,n)).results[0]};return b(r.getSubscriptionQueryKey(e,s),i,a)}function w(e){const s=_(),{accessToken:a,keyFactory:t}=o();return m(r=>D(a,r),{...e,onSuccess:async(r,i,n)=>{await s.invalidateQueries(t.getAllSubscriptionsQueryKey()),await s.invalidateQueries(t.getSubscribersQueryKey(i.objectId,i.objectType)),e!=null&&e.onSuccess&&await e.onSuccess(r,i,n)}})}function N(e){const s=_(),{accessToken:a,keyFactory:t}=o();return m(r=>E(a,r),{...e,onSuccess:async(r,i,n)=>{await s.invalidateQueries(t.getAllSubscriptionsQueryKey()),await s.invalidateQueries(t.getAllSubscribersQueryKey()),e!=null&&e.onSuccess&&await e.onSuccess(r,i,n)}})}const k=(e,s)=>{const{data:a,isLoading:t}=R(e,s),{data:r}=O({objectId:e,objectType:s}),{mutate:i,isLoading:n}=w(),{mutate:l,isLoading:A}=N(),y=t||n||A,p=g.useCallback(()=>{a?l(a.subscriptionId):i({objectId:e,objectType:s})},[l,e,s,i,a]);return{isLoading:y,subscription:a,toggleSubscribed:p,subscribers:r}},d=({id:e,objectType:s,showModal:a,handleModal:t})=>{const{subscribers:r}=k(e,s);return S("div",{className:"SubscribersModal",children:[r&&r.subscribers.length>0&&u("a",{onClick:()=>t(!0),children:`Followers (${r.subscribers.length})`}),S(c,{className:"bootstrap-4-backport",show:a,onHide:()=>t(!1),animation:!1,children:[u(c.Header,{closeButton:!0,children:u(c.Title,{children:"Followers"})}),u(c.Body,{children:r&&r.subscribers.map(i=>u(M,{ownerId:i,size:U,showCardOnHover:!0},i))}),u(c.Footer,{children:u(B,{variant:"contained",onClick:()=>t(!1),children:"Ok"})})]})]})};try{d.displayName="SubscribersModal",d.__docgenInfo={description:"",displayName:"SubscribersModal",props:{id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},objectType:{defaultValue:null,description:"",name:"objectType",required:!0,type:{name:"enum",value:[{value:'"FORUM"'},{value:'"THREAD"'},{value:'"DATA_ACCESS_SUBMISSION"'},{value:'"DATA_ACCESS_SUBMISSION_STATUS"'}]}},showModal:{defaultValue:null,description:"",name:"showModal",required:!0,type:{name:"boolean"}},handleModal:{defaultValue:null,description:"",name:"handleModal",required:!0,type:{name:"(a: boolean) => void"}}}}}catch{}export{h as S,d as a,k as u};
//# sourceMappingURL=SubscribersModal-3317da7e.js.map
