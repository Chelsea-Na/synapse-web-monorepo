import{j as c,F as k,a as q}from"./jsx-runtime-095bf462.js";import{r as F}from"./index-8db94870.js";import{c as N,d as U,e as A}from"./useThread-45bafcf6.js";import{u as d,S as m,am as P,an as f}from"./SynapseClient-e7496728.js";import{u as h}from"./useMutation-1f092bc9.js";import{u as j}from"./useInfiniteQuery-1dac5014.js";import{M as B}from"./MarkdownEditor-7c9c8020.js";import{a as G,K as O}from"./ConfirmationDialog-65430d12.js";import{B as z}from"./Box-3a3e81db.js";import{b as H}from"./Form-8a9b2421.js";function oe(e,n,r,a,t,s){const{accessToken:i,keyFactory:y}=d();return j(y.getRepliesQueryKey(e,n,r,a,t),async o=>m.getReplies(i,e,r,o.pageParam,a,n,t),{...s,getNextPageParam:(o,p)=>{const l=p.flatMap(g=>g.results).length;if(o.totalNumberOfResults>l)return l}})}function le(e,n){const{accessToken:r,keyFactory:a}=d(),t=async()=>{const s=await m.getReplyMessageUrl(e.messageKey,r);return(await fetch(s.messageUrl,{method:"GET",headers:{Accept:"*/*","Access-Control-Request-Headers":"authorization","Content-Type":"text/plain; charset=utf-8"}})).text()};return P(a.getReplyQueryKey(e.threadId,e.id,e.messageKey),t,n)}function W(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.postReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function J(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.putReply(t,r),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(t.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}function ue(e){const n=f(),{accessToken:r,keyFactory:a}=d();return h(t=>m.deleteReply(r,t.replyId),{...e,onSuccess:async(t,s,i)=>{await n.invalidateQueries(a.getAllRepliesQueryKey(s.threadId)),e!=null&&e.onSuccess&&await e.onSuccess(t,s,i)}})}const w=e=>{const{initialText:n,initialTitle:r,id:a,onClose:t,isReply:s,isDialog:i,openDialog:y}=e,[o,p]=F.useState(r??""),[l,g]=F.useState(n??""),{mutate:I,isLoading:M}=N({onSuccess:()=>t()}),{mutate:L,isLoading:Q}=U({onSuccess:()=>t()}),{mutate:v,isLoading:E}=A({onSuccess:()=>t()}),{mutate:b,isLoading:D}=W({onSuccess:()=>t()}),{mutate:K,isLoading:_}=J({onSuccess:()=>t()}),V=Q||D||E||M||_,T=!s&&r,R=(u,x)=>{s?n?K({replyId:a,messageMarkdown:u}):b({threadId:a,messageMarkdown:u}):T?(I({title:x,threadId:a}),L({messageMarkdown:u,threadId:a})):v({forumId:a,title:x,messageMarkdown:u})},C=q("div",{className:"bootstrap-4-backport",children:[!s&&c(H,{type:"text",placeholder:"Title",value:o,onChange:u=>p(u.target.value)}),c(B,{text:l,setText:g})]}),S=V?"Saving":"Save";return c(k,{children:i?c(G,{maxWidth:"md",open:y,onCancel:t,title:s?"Edit Reply":T?"Edit Thread":"New Thread",content:C,onConfirm:()=>R(l,o),confirmButtonText:S}):q(k,{children:[C,c(z,{display:"flex",justifyContent:"flex-end",children:c(O,{onCancel:t,onConfirm:()=>R(l,o),confirmButtonText:S})})]})})};try{w.displayName="ForumThreadEditor",w.__docgenInfo={description:"",displayName:"ForumThreadEditor",props:{initialTitle:{defaultValue:null,description:"",name:"initialTitle",required:!1,type:{name:"string"}},initialText:{defaultValue:null,description:"",name:"initialText",required:!1,type:{name:"string"}},id:{defaultValue:null,description:"",name:"id",required:!0,type:{name:"string"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},isReply:{defaultValue:null,description:"",name:"isReply",required:!0,type:{name:"boolean"}},isDialog:{defaultValue:null,description:"",name:"isDialog",required:!0,type:{name:"boolean"}},openDialog:{defaultValue:null,description:"",name:"openDialog",required:!1,type:{name:"boolean"}}}}}catch{}export{w as F,ue as a,oe as b,le as u};
//# sourceMappingURL=ForumThreadEditor-4cd79103.js.map
