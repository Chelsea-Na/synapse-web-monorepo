import{j as f,a as w}from"./jsx-runtime-670450c2.js";import{r as l,R as k}from"./index-f1f749bf.js";import{P as E,o as O,a as S,b as T,s as v,g as b,Q as x,d as A,i as D,c as I,S as _,e as N,f as Q,h as U,j as M,k as F,l as L,p as q,m as j,n as B,q as G,r as W,t as H,u as K,v as V,w as $,x as z,y as J,z as X}from"./SynapseContext-286d21a2.js";import{S as Y}from"./ToastMessage-47a48bcd.js";import{d as Z}from"./dayjs.min-e0adaab4.js";import{P as ee,B as h,S as te}from"./getEndpoint-5374ab4d.js";import{M as oe}from"./react-router-e6ba0aec.js";function ae(e={}){const{registerAccountUrl:o=`${ee.PORTAL}#!RegisterAccount:0`,onError:t,onTwoFactorAuthRequired:a}=e;l.useEffect(()=>{const m=b(),c=new URL(window.location.href),{searchParams:d}=c;if(!d)return;const p=d.get("code"),r=d.get("provider"),C=d.get("state");if(p&&r){const P=`${m}?provider=${r}`,g=()=>{const s=localStorage.getItem("after-sso-login-url");localStorage.removeItem("after-sso-login-url"),s&&window.location.replace(s)};if(E.GOOGLE==r){const s=n=>{"accessToken"in n?v(n.accessToken).then(g):a&&a(n,g)},i=n=>{n.status===404&&window.location.replace(o),console.error("Error with Google account association: ",n),t&&t(n.reason)};C?O(C,r,p,P,h.REPO_ENDPOINT).then(s).catch(i):S(r,p,P,h.REPO_ENDPOINT).then(s).catch(i)}else if(E.ORCID==r){const s=i=>{console.error("Error binding ORCiD to account: ",i),t&&t(i.reason)};T(r,p,P,h.REPO_ENDPOINT).then(g).catch(s)}}},[])}var y={},re={get exports(){return y},set exports(e){y=e}};re.exports={ReactQueryDevtools:function(){return null},ReactQueryDevtoolsPanel:function(){return null}};async function se(){let e=await Q(),o;try{o=await U(e)}catch(a){throw a instanceof M&&a.status===401&&(console.error("Encountered error fetching profile: ",a,"Signing out..."),await F(),e=void 0),a}let t;return e&&L(e).then(a=>{t=Z(a.authenticatedOn).format("L LT")}),{accessToken:e,profile:o,authenticatedOn:t}}const u=new x(A);function ne(e){const o=te[e];window.SRC={OVERRIDE_ENDPOINT_CONFIG:o},u.resetQueries()}const ce={default:q,sageBionetworks:j,mtb:B,arkPortal:G,adKnowledgePortal:W,nfPortal:H,bsmnPortal:K,psychEncodePortal:V,stopAdPortal:$,digitalHealthPortal:z,crcResearcherPortal:J,cancerComplexityPortal:X};function R(e){const{storybookContext:o}=e;l.useEffect(()=>{ne(o.globals.stack)},[o.globals.stack]);const[t,a]=k.useState(void 0);ae(),l.useEffect(()=>{se().then(c=>{a(c.accessToken)})}),l.useEffect(()=>{async function c(){await u.cancelQueries(),u.removeQueries(),await u.invalidateQueries()}c()},[t]);const m=l.useMemo(()=>({accessToken:t,isInExperimentalMode:D(),utcTime:I(),withErrorBoundary:!0,downloadCartPageUrl:"/?path=/story/download-downloadcartpage--demo"}),[t]);return f(_,{queryClient:u,synapseContext:m,theme:{...N,palette:ce[o.globals.palette]},children:w(oe,{children:[o.globals.showReactQueryDevtools&&f(y.ReactQueryDevtools,{}),f(Y,{}),f("main",{children:e.children})]})},t)}try{R.displayName="StorybookComponentWrapper",R.__docgenInfo={description:"Wraps storybook story components to ensure that all components receive required context.",displayName:"StorybookComponentWrapper",props:{storybookContext:{defaultValue:null,description:"",name:"storybookContext",required:!0,type:{name:"any"}}}}}catch{}export{R as S,se as s};
//# sourceMappingURL=StorybookComponentWrapper-caf96bb4.js.map
