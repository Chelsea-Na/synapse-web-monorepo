{"version":3,"file":"LoginPage.stories-c44e9f20.js","sources":["../../src/lib/containers/auth/LoginPage.tsx","../../stories/LoginPage.stories.ts"],"sourcesContent":["import * as React from 'react'\nimport {\n  Box,\n  Stack,\n  styled,\n  Link,\n  Typography,\n  TypographyProps,\n  useTheme,\n} from '@mui/material'\nimport { LeftRightPanel } from '../../components/styled/LeftRightPanel'\nimport useShowDesktop from '../../utils/hooks/useShowDesktop'\nimport LoginFlowBackButton from './LoginFlowBackButton'\nimport useLogin from '../../utils/hooks/useLogin'\nimport LoginForm from './LoginForm'\nimport { StyledComponent } from '@emotion/styled'\n\nconst LOST_ACCOUNT_SERVICE_DESK_ISSUE_TITLE = encodeURIComponent(\n  'Lost access to my Synapse account',\n)\nconst LOST_ACCOUNT_SERVICE_DESK_DESCRIPTION = encodeURIComponent(\n  '<Please provide your username and/or email address associated with your account.>',\n)\nconst LOST_ACCOUNT_ACCESS_CONTACT_URL = `https://sagebionetworks.jira.com/servicedesk/customer/portal/9/group/16/create/85?summary=${LOST_ACCOUNT_SERVICE_DESK_ISSUE_TITLE}&description=${LOST_ACCOUNT_SERVICE_DESK_DESCRIPTION}`\n\nexport type LoginPageProps = {\n  ssoRedirectUrl?: string\n  sessionCallback: () => void // Callback is invoked after login\n}\n\nconst Tagline: StyledComponent<TypographyProps> = styled(Typography, {\n  label: 'Tagline',\n})(({ theme }) => ({\n  marginBottom: theme.spacing(2),\n  font: '300 24px/34px Lato, sans-serif',\n}))\n\nconst BACKUP_CODE_INFO_JSX = (\n  <>\n    Your backup code is a 16-digit code. We generated 10 of these codes for you\n    when you set up 2FA. If you donâ€™t have access to these codes, please{' '}\n    <Link href={LOST_ACCOUNT_ACCESS_CONTACT_URL}>contact us</Link>.\n  </>\n)\n\nexport default function LoginPage(props: LoginPageProps) {\n  const { ssoRedirectUrl, sessionCallback } = props\n  const showDesktop = useShowDesktop(910)\n  const theme = useTheme()\n\n  const {\n    step,\n    onStepChange,\n    submitUsernameAndPassword,\n    submitOneTimePassword,\n    errorMessage,\n    isLoading,\n  } = useLogin(sessionCallback)\n\n  const loginForm = (\n    <Stack\n      alignItems={'stretch'}\n      sx={{ height: '100%', width: '325px', mx: 'auto' }}\n    >\n      {!showDesktop && (\n        <Stack flexDirection={'row'}>\n          <LoginFlowBackButton step={step} onStepChange={onStepChange} />\n        </Stack>\n      )}\n\n      <Box\n        sx={{\n          mb: 4,\n          textAlign: 'center',\n          maxWidth: '90vw',\n        }}\n      >\n        <img\n          alt={'Synapse logo'}\n          src={\n            'https://s3.amazonaws.com/static.synapse.org/images/synapse-logo-blue.svg'\n          }\n        />\n        {!showDesktop && (\n          <Typography variant=\"body1\" align=\"center\" sx={{ my: 1 }}>\n            Organize. Get credit. Collaborate.\n          </Typography>\n        )}\n      </Box>\n      {!showDesktop && step === 'VERIFICATION_CODE' && (\n        <Typography variant={'body1'} align={'center'} sx={{ my: 1 }}>\n          Enter the 6-digit, time-based verification code provided by your\n          authenticator app.\n        </Typography>\n      )}\n      {!showDesktop && step === 'RECOVERY_CODE' && (\n        <Typography variant={'body1'} align={'center'} sx={{ my: 1 }}>\n          {BACKUP_CODE_INFO_JSX}\n        </Typography>\n      )}\n      <LoginForm\n        ssoRedirectUrl={ssoRedirectUrl}\n        step={step}\n        onStepChange={onStepChange}\n        submitUsernameAndPassword={submitUsernameAndPassword}\n        submitOneTimePassword={submitOneTimePassword}\n        errorMessage={errorMessage}\n        isLoading={isLoading}\n      />\n    </Stack>\n  )\n\n  if (showDesktop) {\n    return (\n      <LeftRightPanel\n        leftContent={\n          <>\n            <Box sx={{ py: 10, px: 8, height: '100%', position: 'relative' }}>\n              <LoginFlowBackButton\n                step={step}\n                onStepChange={onStepChange}\n                sx={{\n                  position: 'absolute',\n                  top: theme.spacing(2),\n                  left: theme.spacing(2),\n                }}\n              />\n              {loginForm}\n            </Box>\n          </>\n        }\n        rightContent={\n          <Box\n            sx={{\n              py: 10,\n              height: '100%',\n              background:\n                \"url('https://s3.amazonaws.com/static.synapse.org/images/login-panel-bg.svg') no-repeat right bottom 20px\",\n            }}\n          >\n            <Box\n              sx={{\n                py: 10,\n                px: 9,\n                color: '#1e4964',\n              }}\n            >\n              {step === 'VERIFICATION_CODE' && (\n                <>\n                  <Typography variant=\"headline1\" sx={{ mb: 4 }}>\n                    Enter your verification code\n                  </Typography>\n                  <Typography variant={'headline2'} sx={{ lineHeight: '30px' }}>\n                    Enter the 6-digit, time-based verification code provided by\n                    your authenticator app.\n                  </Typography>\n                </>\n              )}\n              {step === 'RECOVERY_CODE' && (\n                <>\n                  <Typography variant=\"headline1\" sx={{ mb: 4 }}>\n                    Enter your backup code\n                  </Typography>\n                  <Typography variant={'headline2'} sx={{ lineHeight: '30px' }}>\n                    {BACKUP_CODE_INFO_JSX}\n                  </Typography>\n                </>\n              )}\n              {step !== 'VERIFICATION_CODE' && step !== 'RECOVERY_CODE' && (\n                <>\n                  <Tagline variant=\"headline2\">\n                    <strong>Organize</strong> your digital research assets.\n                  </Tagline>\n                  <Tagline variant=\"headline2\">\n                    <strong>Get credit</strong> for your research.\n                  </Tagline>\n                  <Tagline variant=\"headline2\">\n                    <strong>Collaborate</strong> with your colleagues and the\n                    public.\n                  </Tagline>\n                </>\n              )}\n            </Box>\n          </Box>\n        }\n      />\n    )\n  } else {\n    return (\n      <Box\n        sx={{\n          px: 0,\n          py: 12,\n          height: '95vh',\n          background:\n            \"#fff url('https://s3.amazonaws.com/static.synapse.org/images/SynapseMobileLogInFull.svg') 50% 50%\",\n          backgroundSize: 'contain',\n        }}\n      >\n        {loginForm}\n      </Box>\n    )\n  }\n}\n","import { Meta, StoryObj } from '@storybook/react';\nimport LoginPage from '../src/lib/containers/auth/LoginPage';\nimport { sessionChangeHandler } from '../src/lib/containers/StorybookComponentWrapper';\nimport { displayToast } from '../src/lib/containers/ToastMessage';\nconst meta = ({\n  title: 'Authentication/LoginPage',\n  component: LoginPage\n} satisfies Meta);\nexport default meta;\ntype Story = StoryObj<typeof meta>;\nexport const Demo: Story = {\n  args: {\n    sessionCallback: () => {\n      sessionChangeHandler().then(({\n        profile\n      }) => {\n        displayToast(`You are currently logged in as ${profile.userName}`, 'info', {\n          autoCloseInMs: 5000\n        });\n      });\n    }\n  }\n};\nDemo.parameters = {\n  ...Demo.parameters,\n  docs: {\n    ...Demo.parameters?.docs,\n    source: {\n      originalSource: \"{\\n  args: {\\n    sessionCallback: () => {\\n      sessionChangeHandler().then(({\\n        profile\\n      }) => {\\n        displayToast(`You are currently logged in as ${profile.userName}`, 'info', {\\n          autoCloseInMs: 5000\\n        });\\n      });\\n    }\\n  }\\n}\",\n      ...Demo.parameters?.docs?.source\n    }\n  }\n};"],"names":["LOST_ACCOUNT_SERVICE_DESK_ISSUE_TITLE","LOST_ACCOUNT_SERVICE_DESK_DESCRIPTION","LOST_ACCOUNT_ACCESS_CONTACT_URL","Tagline","styled","Typography","theme","BACKUP_CODE_INFO_JSX","jsxs","Fragment","jsx","Link","LoginPage","props","ssoRedirectUrl","sessionCallback","showDesktop","useShowDesktop","useTheme","step","onStepChange","submitUsernameAndPassword","submitOneTimePassword","errorMessage","isLoading","useLogin","loginForm","Stack","LoginFlowBackButton","Box","LoginForm","LeftRightPanel","meta","Demo","sessionChangeHandler","profile","displayToast","_a","_c","_b"],"mappings":"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"}