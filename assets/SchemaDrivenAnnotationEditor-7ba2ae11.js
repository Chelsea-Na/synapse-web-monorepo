import{j as a,F as E,a as p}from"./jsx-runtime-095bf462.js";import{d as Fe,H as Ce,L as Ne,M as xe,A as Ie,a as Ee,b as je,c as Pe,B as De}from"./ArrayFieldDescriptionTemplate-cb55e539.js";import"./isPlainObject-1dec192d.js";import"./mapValues-dee13770.js";import{a8 as be,a9 as H,aa as le,ab as Be,ac as pe,ad as Oe,ae as Re,af as ke,ag as Le,ah as me,ai as We,aj as $e,ak as Ge,z as He,al as Me,t as Je,C as Ke}from"./SynapseTableCell-c95b613b.js";import"./uniq-fe955338.js";import{r as w,R as I}from"./index-8db94870.js";import"./index-953d39fd.js";import{u as de,L as ce,t as ue,bv as Se,b3 as ve}from"./SynapseClient-c9a5bd80.js";import{S as Ue}from"./createSvgIcon-ad67928b.js";import{g as ze,B as Xe}from"./getEndpoint-ac94413e.js";import"./OrientationBanner-a68ba799.js";import{a as Ye,l as Ze}from"./useEntity-0d0c852f.js";import{S as Qe}from"./LoadingScreen-7b803862.js";import{F as et}from"./FullWidthAlert-92257a48.js";import{g as tt,f as rt}from"./ThemesPlot-929b6a3f.js";import{G as j}from"./Grid-c92a996f.js";import{I as Te}from"./InputLabel-ee349efc.js";import{i as at}from"./isEqual-e30f3433.js";import{d as nt}from"./dayjs.min-59ef0ea6.js";import{C as it}from"./CalendarWithIconFormGroup-64b82101.js";import{u as ot}from"./use-deep-compare-effect.esm-7a830988.js";import{d as st}from"./ToastMessage-94764aff.js";import{T as _e}from"./Tooltip-b7fc1fa3.js";import{B as lt}from"./Button-8994ccb5.js";import{T as Ve,F as dt}from"./TextField-2c7ba887.js";import{I as ct}from"./IconButton-c6432c64.js";import{C as we}from"./_getTag-376e1527.js";import{T as M}from"./Typography-661a732d.js";import{a as ut}from"./MenuList-2e5fd778.js";import{A as B}from"./AlertTitle-b21ffb10.js";import{L as pt}from"./Link-f7a9268e.js";import{B as fe}from"./Box-9f4bb844.js";import{D as mt}from"./Divider-367bb8cc.js";function ft(e,t){const{accessToken:r,keyFactory:n}=de();return ce(n.getEntityBoundJsonSchemaQueryKey(e),()=>ue.getSchemaBinding(e,r),t)}function rr(e,t){const{accessToken:r,keyFactory:n}=de();return ce(n.getEntitySchemaValidationResultsQueryKey(e),()=>ue.getSchemaValidationResults(e,r),t)}function ht(e,t){const{keyFactory:r}=de();return ce(r.getValidationSchemaQueryKey(e),async()=>(await ue.getValidationSchema(e)).validationSchema,t)}const O=e=>a(Ue,{...e,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:a("path",{d:"M14 10H2V12H14V10ZM14 6H2V8H14V6ZM18 14V10H16V14H12V16H16V20H18V16H22V14H18ZM2 16H10V14H2V16Z"})});try{O.displayName="AddToList",O.__docgenInfo={description:"",displayName:"AddToList",props:{children:{defaultValue:null,description:"Node passed into the SVG element.",name:"children",required:!1,type:{name:"ReactNode"}},classes:{defaultValue:null,description:"Override or extend the styles applied to the component.",name:"classes",required:!1,type:{name:"(Partial<SvgIconClasses> & Partial<ClassNameMap<never>>)"}},color:{defaultValue:{value:"'inherit'"},description:`The color of the component.
It supports both default and custom theme colors, which can be added as shown in the
[palette customization guide](https://mui.com/material-ui/customization/palette/#adding-new-colors).
You can use the \`htmlColor\` prop to apply a color attribute to the SVG element.`,name:"color",required:!1,type:{name:"enum",value:[{value:'"info"'},{value:'"success"'},{value:'"warning"'},{value:'"inherit"'},{value:'"action"'},{value:'"disabled"'},{value:'"primary"'},{value:'"secondary"'},{value:'"error"'}]}},fontSize:{defaultValue:{value:"'medium'"},description:"The fontSize applied to the icon. Defaults to 24px, but can be configure to inherit font size.",name:"fontSize",required:!1,type:{name:"enum",value:[{value:'"small"'},{value:'"inherit"'},{value:'"medium"'},{value:'"large"'}]}},htmlColor:{defaultValue:null,description:"Applies a color attribute to the SVG element.",name:"htmlColor",required:!1,type:{name:"string"}},inheritViewBox:{defaultValue:{value:"false"},description:"If `true`, the root node will inherit the custom `component`'s viewBox and the `viewBox`\nprop will be ignored.\nUseful when you want to reference a custom `component` and have `SvgIcon` pass that\n`component`'s viewBox to the root node.",name:"inheritViewBox",required:!1,type:{name:"boolean"}},shapeRendering:{defaultValue:null,description:`The shape-rendering attribute. The behavior of the different options is described on the
[MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/SVG/Attribute/shape-rendering).
If you are having issues with blurry icons you should investigate this prop.`,name:"shapeRendering",required:!1,type:{name:"string"}},sx:{defaultValue:null,description:"The system prop that allows defining system overrides as well as additional CSS styles.",name:"sx",required:!1,type:{name:"SxProps<Theme>"}},titleAccess:{defaultValue:null,description:`Provides a human-readable title for the element that contains it.
https://www.w3.org/TR/SVG-access/#Equivalent`,name:"titleAccess",required:!1,type:{name:"string"}},viewBox:{defaultValue:{value:"'0 0 24 24'"},description:`Allows you to redefine what the coordinates without units mean inside an SVG element.
For example, if the SVG element is 500 (width) by 200 (height),
and you pass viewBox="0 0 50 20",
this means that the coordinates inside the SVG will go from the top left corner (0,0)
to bottom right (50,20) and each unit will be worth 10px.`,name:"viewBox",required:!1,type:{name:"string"}},ref:{defaultValue:null,description:"",name:"ref",required:!1,type:{name:"((instance: SVGSVGElement | null) => void) | RefObject<SVGSVGElement> | null"}}}}}catch{}function yt(e){const t={};return Object.keys(e).forEach(r=>{let n=e[r];Array.isArray(n)?(n=n.filter(o=>o!=null),ve(n)||(t[r]=n)):t[r]=n}),t}function gt(e={}){return Object.keys(e).reduce((t,r)=>(e[r]!==null&&(t[r]=e[r]),t),{})}function J(e){var t,r;return(t=e.property)!=null&&t.startsWith("[")?e.property.substring(2,e.property.length-2):(r=e.property)!=null&&r.startsWith(".")?e.property.substring(1):e.property||""}function bt(e){return t=>{const r=tt(t,n=>n.property);return Object.keys(r).map(n=>{const o=r[n];o.some(l=>l.message==="should match some schema in anyOf")&&o.every(l=>l.message==="should be string"||l.message==="should be equal to constant"?!0:l.message==="should match some schema in anyOf")&&o.length>0&&(o[0].message="should be equal to one of the allowed values",r[n]=[o[0]])}),t=rt(r),e&&(t=t.map(n=>{const o=J(n);return o&&Se[e].includes(o)&&(n.message=`"${o}" is a reserved internal key and cannot be used.`),n})),t}}function K(e){return Array.isArray(e)?e:typeof e=="string"?e.split(",").map(t=>t.trim()):[e]}const qe=/\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}Z/,St=["String","Integer","Float","Boolean","Datetime"];function U(e){return e.length===0?"String":e.every(t=>typeof t=="number"||t==="NaN")?e.every(t=>Number.isInteger(t))?"Integer":"Float":e.every(t=>typeof t=="boolean")?"Boolean":e.every(t=>typeof t=="string")&&e.every(t=>!!qe.exec(t))?"Datetime":"String"}function he(e,t){switch(t){case"Integer":return e.map(r=>Number.isNaN(Number(r))?0:Math.floor(Number(r)));case"Float":return e.map(r=>{const n=parseFloat(r);return Number.isNaN(n)?"NaN":Number.isInteger(n)?n.toFixed(1):n});case"Datetime":return e.map(r=>typeof r=="string"&&qe.exec(r)?r:new Date().toISOString());case"Boolean":return e.map(r=>!!r);case"String":default:return e.map(r=>String(r))}}function z(e){switch(e){case"Datetime":return{type:"string",format:"datetime"};case"Boolean":return{type:"boolean"};case"Float":return{type:"number"};case"Integer":return{type:"integer"};case"String":default:return{type:"string"}}}function X(e){const{formData:t,onChange:r,registry:n,schema:o,name:c,onDropPropertyClick:f,idSchema:l}=e,m=l.$id,{ArrayField:g}=n.fields,{SelectWidget:h}=n.widgets,[u,y]=w.useState(U(K(t))),[d,T]=w.useState(u);w.useEffect(()=>{function i(){if(Array.isArray(t)){const v=t.length===0||t.every(s=>s==null||s==""),q=he(t,d);(v||d!==u)&&at(t,q)&&y(d)}}i()},[d]),w.useEffect(()=>{function i(){if(Array.isArray(t))if(t.every(v=>v==null))f(c)(new CustomEvent("dropEmptyProperty"));else{const v=he(t,d);y(d),r(v)}}i()},[u]);const S=z(u);return Array.isArray(t)?p(Fe,{value:{dropProperty:i=>{f(c)(i)}},children:[p(j,{item:!0,xs:2,children:[a(Te,{htmlFor:`${m}-type`,children:"Type"}),a(h,{name:"Type",id:`${m}-type`,schema:{},options:{enumOptions:St.map(i=>({label:i,value:i}))},value:u,onChange:i=>{T(i)},disabled:e.disabled,readOnly:e.readonly,required:!0,isClearable:!1,onBlur:()=>{},onFocus:()=>{},registry:n,label:"Type"})]}),a(j,{item:!0,xs:7,children:a(g,{...e,schema:{...o,items:{...S}}})}),u!==d&&a(et,{variant:"warning",title:"Data may be lost when converting types",description:`Are you sure you want to convert ${c} from ${u} to ${d}? Current values may be lost on conversion.`,primaryButtonConfig:{text:"Convert",onClick:()=>{y(d)}},secondaryButtonConfig:{text:"Cancel",onClick:()=>{T(u)}},isGlobal:!1})]}):(r(K(t)),a(E,{}))}try{U.displayName="guessPropertyType",U.__docgenInfo={description:"",displayName:"guessPropertyType",props:{}}}catch{}try{z.displayName="getSchemaForPropertyType",z.__docgenInfo={description:"Maps a Synapse Annotation PropertyType to a JSON Schema that captures the type and format.",displayName:"getSchemaForPropertyType",props:{}}}catch{}try{X.displayName="AdditionalPropertiesSchemaField",X.__docgenInfo={description:`react-jsonschema-form SchemaField override for "additionalProperties" only. In Synapse these are "custom annotations".
Modifies the data to provide full compatibility with Synapse annotations features.

This component provides these enhancements to the SchemaField:
- Supports selecting a type, and changing the input widget appropriately
- Identifying the type on mount
- Treat all field values as arrays
- When the last array value is removed, remove the entire key from the form.`,displayName:"AdditionalPropertiesSchemaField",props:{onDropPropertyClick:{defaultValue:null,description:"",name:"onDropPropertyClick",required:!0,type:{name:"(key: string) => (event: any) => void"}}}}}catch{}const Y=e=>{const{SelectWidget:t}=e.registry.widgets;return a(t,{...e,options:{enumOptions:[{value:!0,label:"true"},{value:!1,label:"false"}]}})};try{Y.displayName="BooleanWidget",Y.__docgenInfo={description:"Select widget compatible with react-jsonschema-form booleans",displayName:"BooleanWidget",props:{}}}catch{}const Z=({disabled:e,value:t,onChange:r})=>a(it,{disabled:e,value:t?nt(t):"",setterCallback:n=>{n==null||typeof n=="string"?r(n):r(n.toISOString())}});try{Z.displayName="DateTimeWidget",Z.__docgenInfo={description:"DateTime picker widget compatible with react-jsonschema-form and Synapse Datetime annotations.",displayName:"DateTimeWidget",props:{}}}catch{}function Q(e){const{description:t,disabled:r,formData:n,idSchema:o,onAddClick:c,properties:f,readonly:l,registry:m,required:g,schema:h,title:u,uiSchema:y}=e,d=be(y),T=H("TitleFieldTemplate",m,d),S=H("DescriptionFieldTemplate",m,d),i=w.useRef(new Set);return ot(()=>{if("properties"in h&&h.properties){const v=Object.keys(h.properties),q=new Set(v.filter(s=>!h.properties[s][le]));if(i.current!=null){const s=Array.from(i.current).filter(_=>!q.has(_)&&!!n&&n[_]!=null&&Array.isArray(n[_])&&n[_].filter(A=>A!=null).length>0);s.length>0&&st(`The following annotations are no longer specified by the schema and have been converted to custom fields: ${s.join(", ")}.`,"warning",{title:"Fields No Longer Specified By Schema"})}i.current=q}},[h.properties]),p("fieldset",{id:o.$id,children:[(d.title||u)&&a(T,{id:`${o.$id}__title`,schema:h,title:d.title||u,required:g,uiSchema:y,registry:m}),(d.description||t)&&a(S,{id:`${o.$id}__description`,description:d.description||t,registry:m,schema:h}),f.map(v=>v.content),Be(h,y,n)&&a(_e,{title:"Add a new custom field",placement:"top",children:a(lt,{sx:{my:2},variant:"contained",className:"object-property-expand",onClick:c(h),disabled:r||l,"aria-label":"Add Custom Field",children:a(O,{})})})]})}try{Q.displayName="ObjectFieldTemplate",Q.__docgenInfo={description:`Derived from the base ObjectFieldTemplate with annotations-editor-specific changes
- Custom button for adding additional properties
- Tracks properties to show a toast message if a property is converted to an additionalProperty because it was
  dropped from the schema (e.g. in a conditional schema)

See https://github.com/rjsf-team/react-jsonschema-form/blob/main/packages/mui/src/ObjectFieldTemplate/ObjectFieldTemplate.tsx`,displayName:"ObjectFieldTemplate",props:{title:{defaultValue:null,description:"A string value containing the title for the object",name:"title",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"A string value containing the description for the object",name:"description",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"A boolean value stating if the object is disabled",name:"disabled",required:!1,type:{name:"boolean"}},properties:{defaultValue:null,description:"An array of objects representing the properties in the object",name:"properties",required:!0,type:{name:"ObjectFieldTemplatePropertyType[]"}},onAddClick:{defaultValue:null,description:"Returns a function that adds a new property to the object (to be used with additionalProperties)",name:"onAddClick",required:!0,type:{name:"(schema: S) => () => void"}},readonly:{defaultValue:null,description:"A boolean value stating if the object is read-only",name:"readonly",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"A boolean value stating if the object is required",name:"required",required:!1,type:{name:"boolean"}},hideError:{defaultValue:null,description:"A boolean value stating if the field is hiding its errors",name:"hideError",required:!1,type:{name:"boolean"}},schema:{defaultValue:null,description:"The schema object for this object",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this object field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},idSchema:{defaultValue:null,description:"An object containing the id for this object & ids for its properties",name:"idSchema",required:!0,type:{name:"IdSchema<T>"}},errorSchema:{defaultValue:null,description:"The optional validation errors in the form of an `ErrorSchema`",name:"errorSchema",required:!1,type:{name:"ErrorSchema<T>"}},formData:{defaultValue:null,description:"The form data for the object",name:"formData",required:!1,type:{name:"Record<string, any> | null"}},formContext:{defaultValue:null,description:"The `formContext` object that was passed to Form",name:"formContext",required:!1,type:{name:"GenericObjectType"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}}}}}catch{}const ee=e=>{const{BaseInputTemplate:t}=e.registry.templates;let r;return(e.schema.type==="number"||e.schema.type==="integer")&&(r="text"),a(t,{...e,options:{...e.options,inputType:r}})};try{ee.displayName="TextWidget",ee.__docgenInfo={description:`This TextWidget is almost identical to the rjsf TextWidget, except we handle numbers like strings to prevent issues if
the actual annotation data is not a string.`,displayName:"TextWidget",props:{}}}catch{}try{Widget.displayName="Widget",Widget.__docgenInfo={description:"The definition of a React-based Widget component",displayName:"Widget",props:{}}}catch{}function te(e){const{fields:{ObjectField:t}}=Re();return w.useEffect(()=>{const{schema:r,formData:n,onChange:o}=e,c={...n};r[pe]&&(Object.entries(r[pe]).forEach(([f,l])=>{const m=c[f];l[le]?Array.isArray(m)||(c[f]=K(m)):typeof l=="object"&&"type"in l&&l.type!=="array"&&Array.isArray(m)&&(c[f]=m.map(g=>`${g}`).join(", "))}),Oe(n,c)||o(c))}),a(t,{...e})}try{te.displayName="CustomObjectField",te.__docgenInfo={description:"Extends the",displayName:"CustomObjectField",props:{}}}catch{}function re(e){const{id:t,classNames:r,disabled:n,label:o,onKeyChange:c,readonly:f,required:l,schema:m,children:g,registry:h}=e,{translateString:u}=h,y=u(ke.KeyLabel,[""]);if(!(le in m))return a("div",{className:r,children:g});const T=({target:S})=>{S&&c(S.value)};return a("div",{className:r,children:p(j,{container:!0,sx:{my:2},columnSpacing:2,rowSpacing:0,children:[a(j,{item:!0,xs:3,children:a(Ve,{fullWidth:!0,required:l,label:y,defaultValue:o,disabled:n||f,id:`${t}-key`,name:`${t}-key`,onBlur:f?void 0:T,type:"text"})}),g]})})}try{re.displayName="WrapIfAdditionalTemplate",re.__docgenInfo={description:"The `WrapIfAdditional` component is used by the `FieldTemplate` to rename, or remove properties that are\npart of an `additionalProperties` part of a schema.",displayName:"WrapIfAdditionalTemplate",props:{children:{defaultValue:null,description:"The field or widget component instance for this field row",name:"children",required:!0,type:{name:"ReactNode"}},label:{defaultValue:null,description:"The computed label for this field, as a string",name:"label",required:!0,type:{name:"string"}},style:{defaultValue:null,description:"An object containing the style as defined in the `uiSchema`",name:"style",required:!1,type:{name:"StyleHTMLAttributes<any>"}},id:{defaultValue:null,description:"The id of the field in the hierarchy. You can use it to render a label targeting the wrapped widget",name:"id",required:!0,type:{name:"string"}},disabled:{defaultValue:null,description:"A boolean value stating if the field is disabled",name:"disabled",required:!0,type:{name:"boolean"}},required:{defaultValue:null,description:"A boolean value stating if the field is required",name:"required",required:!1,type:{name:"boolean"}},schema:{defaultValue:null,description:"The schema object for this field",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},classNames:{defaultValue:null,description:"A string containing the base CSS classes, merged with any custom ones defined in your uiSchema",name:"classNames",required:!1,type:{name:"string"}},readonly:{defaultValue:null,description:"A boolean value stating if the field is read-only",name:"readonly",required:!0,type:{name:"boolean"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}},onDropPropertyClick:{defaultValue:null,description:"The property drop/removal event handler; Called when a field is removed in an additionalProperty context",name:"onDropPropertyClick",required:!0,type:{name:"(value: string) => () => void"}},onKeyChange:{defaultValue:null,description:"The key change event handler; Called when the key associated with a field is changed for an additionalProperty",name:"onKeyChange",required:!0,type:{name:"(value: string) => () => void"}}}}}catch{}function ae(e){const{id:t,label:r,children:n,errors:o,help:c,description:f,hidden:l,required:m,displayLabel:g,registry:h,uiSchema:u,schema:y}=e,d=be(u),T=H("WrapIfAdditionalTemplate",h,d),[S,i]=w.useState(!1);return l?a("div",{className:"hidden",children:n}):p(T,{...e,children:[(g||y.type==="boolean")&&p("div",{className:"LabelContainer",children:[p(Te,{htmlFor:t,children:[r,m&&a("span",{className:"required",children:"*"})]}),a(_e,{title:"More Info",children:a(ct,{onClick:v=>{v.preventDefault(),i(!S)},"aria-expanded":S,size:"small",children:a(Ce,{color:"primary",sx:{width:"16px",height:"16px"}})})})]}),n,a(j,{item:!0,xs:12,children:o}),a(we,{className:"field-description",in:S,children:f}),c]})}try{ae.displayName="FieldTemplate",ae.__docgenInfo={description:"",displayName:"FieldTemplate",props:{id:{defaultValue:null,description:"The id of the field in the hierarchy. You can use it to render a label targeting the wrapped widget",name:"id",required:!0,type:{name:"string"}},classNames:{defaultValue:null,description:"A string containing the base CSS classes, merged with any custom ones defined in your uiSchema",name:"classNames",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"An object containing the style as defined in the `uiSchema`",name:"style",required:!1,type:{name:"StyleHTMLAttributes<any>"}},label:{defaultValue:null,description:"The computed label for this field, as a string",name:"label",required:!0,type:{name:"string"}},description:{defaultValue:null,description:"A component instance rendering the field description, if one is defined (this will use any custom\n`DescriptionField` defined)",name:"description",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawDescription:{defaultValue:null,description:"A string containing any `ui:description` uiSchema directive defined",name:"rawDescription",required:!1,type:{name:"string"}},children:{defaultValue:null,description:"The field or widget component instance for this field row",name:"children",required:!0,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},errors:{defaultValue:null,description:"A component instance listing any encountered errors for this field",name:"errors",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawErrors:{defaultValue:null,description:"An array of strings listing all generated error messages from encountered errors for this field",name:"rawErrors",required:!1,type:{name:"string[]"}},help:{defaultValue:null,description:"A component instance rendering any `ui:help` uiSchema directive defined",name:"help",required:!1,type:{name:"ReactElement<any, string | JSXElementConstructor<any>>"}},rawHelp:{defaultValue:null,description:"A string containing any `ui:help` uiSchema directive defined. **NOTE:** `rawHelp` will be `undefined` if passed\n`ui:help` is a React component instead of a string",name:"rawHelp",required:!1,type:{name:"string"}},hidden:{defaultValue:null,description:"A boolean value stating if the field should be hidden",name:"hidden",required:!1,type:{name:"boolean"}},required:{defaultValue:null,description:"A boolean value stating if the field is required",name:"required",required:!1,type:{name:"boolean"}},readonly:{defaultValue:null,description:"A boolean value stating if the field is read-only",name:"readonly",required:!0,type:{name:"boolean"}},hideError:{defaultValue:null,description:"A boolean value stating if the field is hiding its errors",name:"hideError",required:!1,type:{name:"boolean"}},disabled:{defaultValue:null,description:"A boolean value stating if the field is disabled",name:"disabled",required:!0,type:{name:"boolean"}},displayLabel:{defaultValue:null,description:`A boolean value stating if the label should be rendered or not. This is useful for nested fields in arrays where
you don't want to clutter the UI`,name:"displayLabel",required:!1,type:{name:"boolean"}},schema:{defaultValue:null,description:"The schema object for this field",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},formContext:{defaultValue:null,description:"The `formContext` object that was passed to `Form`",name:"formContext",required:!1,type:{name:"GenericObjectType"}},formData:{defaultValue:null,description:"The formData for this field",name:"formData",required:!1,type:{name:"T"}},onChange:{defaultValue:null,description:"The value change event handler; Can be called with a new value to change the value for this field",name:"onChange",required:!0,type:{name:"(newFormData: any, es?: ErrorSchema<any> | undefined, id?: string | undefined) => any"}},onKeyChange:{defaultValue:null,description:"The key change event handler; Called when the key associated with a field is changed for an additionalProperty",name:"onKeyChange",required:!0,type:{name:"(value: string) => () => void"}},onDropPropertyClick:{defaultValue:null,description:"The property drop/removal event handler; Called when a field is removed in an additionalProperty context",name:"onDropPropertyClick",required:!0,type:{name:"(value: string) => () => void"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}}}}}catch{}function Ae(e){if(Array.isArray(e)||typeof e=="boolean")return"unknown";const{type:t,enum:r}=e;return t==="array"&&typeof e.items=="object"?`List of ${Ae(e.items)}`:r?"enumeration":Array.isArray(t)?t.reduce((n,o)=>`${n}, ${o}`,""):t||"unknown"}function ne(e){const{description:t,schema:r}=e,n=Ae(r);return a(we,{className:"field-description",in:!0,children:a("table",{className:"FieldDescriptionTable",children:p("tbody",{children:[t&&p("tr",{children:[a("th",{children:"Description"}),a("td",{children:t})]}),p("tr",{children:[a("th",{children:"Type"}),a("td",{children:n})]})]})})})}try{ne.displayName="FieldDescriptionTable",ne.__docgenInfo={description:"",displayName:"FieldDescriptionTable",props:{schema:{defaultValue:null,description:"",name:"schema",required:!0,type:{name:"JSONSchema7"}},description:{defaultValue:null,description:"",name:"description",required:!0,type:{name:"ReactNode"}}}}}catch{}function ie(e){const{description:t,schema:r={}}=e;return r.type==="object"?a(M,{variant:"body1",sx:{my:2},children:t}):a(ne,{schema:r,description:t})}try{ie.displayName="DescriptionFieldTemplate",ie.__docgenInfo={description:"",displayName:"DescriptionFieldTemplate",props:{id:{defaultValue:null,description:"The id of the field description in the hierarchy",name:"id",required:!0,type:{name:"string"}},schema:{defaultValue:null,description:"The schema object for the field being described",name:"schema",required:!0,type:{name:"RJSFSchema"}},uiSchema:{defaultValue:null,description:"The uiSchema object for this description field",name:"uiSchema",required:!1,type:{name:"UiSchema<any, RJSFSchema, any>"}},description:{defaultValue:null,description:"The description of the field being rendered",name:"description",required:!0,type:{name:"string | ReactElement<any, string | JSXElementConstructor<any>>"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<any, RJSFSchema, any>"}}}}}catch{}const vt=["date","datetime-local","file","time"];function oe(e){const{id:t,name:r,placeholder:n,required:o,readonly:c,disabled:f,type:l,label:m,value:g,onChange:h,onChangeOverride:u,onBlur:y,onFocus:d,autofocus:T,options:S,schema:i,uiSchema:v,rawErrors:q=[],formContext:s,registry:_,InputLabelProps:A,...x}=e,R=!0,k=Le(i,l,S),{step:F,min:L,max:W,...$}=k,N={inputProps:{step:F,min:L,max:W,...i.examples?{list:me(t)}:void 0},...$},G=({target:{value:V}})=>h(V===""?S.emptyValue:V),P=({target:{value:V}})=>y(t,V),D=({target:{value:V}})=>d(t,V),b=vt.includes(l)?{...A,shrink:!0}:A;let C;return(i.default||i.const)&&(C=JSON.stringify(i.default||i.const)+" (derived)"),p(E,{children:[a(Ve,{id:t,name:t,placeholder:C||n,label:We(m||void 0,R,!1),autoFocus:T,required:!1,disabled:f||c,...N,value:g||g===0?g:"",error:q.length>0,onChange:u||G,onBlur:P,onFocus:D,InputLabelProps:b,...x,inputProps:{"aria-label":t},"aria-describedby":$e(t,!!i.examples)}),Array.isArray(i.examples)&&a("datalist",{id:me(t),children:i.examples.concat(i.default&&!i.examples.includes(i.default)?[i.default]:[]).map(V=>a("option",{value:V},V))})]})}try{oe.displayName="BaseInputTemplate",oe.__docgenInfo={description:"The `BaseInputTemplate` is the template to use to render the basic `<input>` component for the `core` theme.\nIt is used as the template for rendering many of the <input> based widgets that differ by `type` and callbacks only.\nIt can be customized/overridden for other themes or individual implementations as needed.",displayName:"BaseInputTemplate",props:{}}}catch{}function se(e){const{errors:t=[],idSchema:r}=e;if(t.length===0)return null;const n=Ge(r);return a(ut,{dense:!0,disablePadding:!0,children:t.map((o,c)=>a(Ne,{disableGutters:!0,children:a(dt,{id:n,sx:{color:"error.main"},children:o})},c))})}try{se.displayName="FieldErrorTemplate",se.__docgenInfo={description:"The `FieldErrorTemplate` component renders the errors local to the particular field",displayName:"FieldErrorTemplate",props:{errorSchema:{defaultValue:null,description:"The errorSchema constructed by `Form`",name:"errorSchema",required:!1,type:{name:"ErrorSchema<T>"}},errors:{defaultValue:null,description:"An array of the errors",name:"errors",required:!1,type:{name:"(string | ReactElement<any, string | JSXElementConstructor<any>>)[]"}},idSchema:{defaultValue:null,description:"The tree of unique ids for every child field",name:"idSchema",required:!0,type:{name:"IdSchema<T>"}},schema:{defaultValue:null,description:"The schema that was passed to field",name:"schema",required:!0,type:{name:"JSONSchema7"}},uiSchema:{defaultValue:null,description:"The uiSchema that was passed to field",name:"uiSchema",required:!1,type:{name:"UiSchema<T, S, F>"}},registry:{defaultValue:null,description:"The `registry` object",name:"registry",required:!0,type:{name:"Registry<T, S, F>"}}}}}catch{}function Tt(e){return e?Se[e].reduce((t,r)=>(t[`^${r}$`]={not:{}},t),{}):{}}function ye(e,t){let r=gt(e);return t&&(r=yt(r)),r}function ge(e){const{entityId:t,schemaId:r,validationSchema:n,liveValidate:o=!1,onSuccess:c=()=>{},onCancel:f,formRef:l,onChange:m}=e,g=w.useRef(null),h=l??g,[u,y]=I.useState(void 0),[d,T]=I.useState(void 0),[S,i]=I.useState(!1),[v,q]=I.useState(!1),{entityMetadata:s,annotations:_}=Ye(t,!1,{staleTime:1/0,enabled:!!t,useErrorBoundary:!0}),[A,x]=I.useState(_),R=w.useMemo(()=>Tt(s==null?void 0:s.concreteType),[s==null?void 0:s.concreteType]),k=w.useCallback(bt(s==null?void 0:s.concreteType),[s==null?void 0:s.concreteType]);w.useEffect(()=>{_&&x(_)},[_]);const{data:F,isLoading:L}=ft(t,{enabled:!!t,refetchOnWindowFocus:!1,useErrorBoundary:!0}),{data:W,isLoading:$}=ht(r??(F==null?void 0:F.jsonSchemaVersionInfo.$id)??"",{enabled:!!r||!!F,useErrorBoundary:!0}),N=n||W,G=L||$,P=Ze({onSuccess:()=>{c()},onError:b=>{T(b),i(!0)}});function D(){P.mutate({...ye(A,!0),...s})}return a("div",{className:"JsonSchemaFormContainer",children:G?a("div",{className:"LoadingPlaceholder",children:a(Qe,{size:30})}):p(E,{children:[s&&F&&p(B,{severity:"info",sx:{mb:2},children:[a("b",{children:s.name})," requires scientific annotations specified by ",a("b",{children:F.jsonSchemaVersionInfo.$id}),". ",a("b",{children:a(pt,{href:`${ze(Xe.REPO_ENDPOINT)}/repo/v1/schema/type/registered/${F.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:"View required schema (JSON)"})})]}),s&&ve(A)&&F===null&&a(B,{severity:"info",children:p(fe,{display:"flex",alignItems:"center",gap:.5,children:[p(M,{variant:"smallText1",children:[a("b",{children:s.name})," has no annotations. Click the"," "]}),a(O,{}),a(M,{variant:"smallText1",children:"button to annotate."})]})}),A!=null&&p(xe,{validator:He,className:"JsonSchemaForm",liveValidate:o,noHtml5Validate:!0,experimental_defaultFormStateBehavior:{emptyObjectFields:"skipDefaults"},fields:{ObjectField:te},templates:{ArrayFieldDescriptionTemplate:Ie,ArrayFieldItemTemplate:Ee,ArrayFieldTemplate:je,ArrayFieldTitleTemplate:Pe,BaseInputTemplate:oe,FieldErrorTemplate:se,FieldTemplate:ae,ObjectFieldTemplate:Q,WrapIfAdditionalTemplate:re,ButtonTemplates:De,DescriptionFieldTemplate:ie,ErrorListTemplate:()=>null},ref:h,disabled:P.isLoading,schema:{...N??{},patternProperties:{...(N==null?void 0:N.patternProperties)??{},...R},additionalProperties:(N==null?void 0:N.additionalProperties)??!0},uiSchema:{"ui:options":{copyable:!0,duplicateKeySuffixSeparator:"_"},additionalProperties:{"ui:field":X}},transformErrors:k,formData:A,onChange:({formData:b})=>{m&&m(b),x(b),y(void 0)},onBlur:()=>{x(ye(A,!1))},onSubmit:({formData:b,errors:C},V)=>{V.preventDefault(),C&&C.length>0&&y(C),i(!1),x(b),D()},onError:b=>{y(b),u&&t&&q(!0)},widgets:{TextWidget:ee,DateTimeWidget:Z,SelectWidget:Me,CheckboxWidget:Y},children:[u&&p(B,{severity:"error",sx:{my:2},children:[a("b",{children:"Validation errors found:"}),a("ul",{children:u.map((b,C)=>p("li",{children:[a("b",{children:`${J(b)}: `})," ",`${b.message}`]},C))})]}),d&&S&&p(B,{severity:"error",sx:{my:2},children:["Annotations could not be updated: ",d.reason]}),!l&&p(E,{children:[a(mt,{sx:{my:2}}),a(fe,{display:"flex",justifyContent:"space-between",sx:{gridRowStart:5},children:a(Je,{hasCancelButton:f!==void 0,onCancel:()=>{f&&f()},onConfirm:()=>{h.current.formElement.current.requestSubmit()},confirmButtonText:t?"Save":"Validate"})})]})]}),v&&a(Ke,{open:!0,onConfirm:()=>{D(),q(!1)},onCancel:()=>{q(!1)},title:"Update Annotations",content:p(E,{children:[a("div",{children:"The following errors exist with the annotations you entered:"}),a("div",{children:a("ul",{children:(u??[]).map((b,C)=>p("li",{children:[a("b",{children:`${J(b)}: `})," ",`${b.message}`]},C))})}),a("div",{children:"Are you sure you want to save the invalid annotations?"})]}),confirmButtonText:"Save"})]})})}try{ge.displayName="SchemaDrivenAnnotationEditor",ge.__docgenInfo={description:`Renders a form for editing an entity's annotations. The component also supports supplying just a schema ID,
but work to support annotation flows without an entity (i.e. before creating entities) is not yet complete.`,displayName:"SchemaDrivenAnnotationEditor",props:{entityId:{defaultValue:null,description:"The entity whose annotations should be edited with the form",name:"entityId",required:!1,type:{name:"string"}},schemaId:{defaultValue:null,description:"If no entity ID is supplied, the schema to use for the form",name:"schemaId",required:!1,type:{name:"string"}},validationSchema:{defaultValue:null,description:"May be used to directly provide a JSON Schema to use for the form",name:"validationSchema",required:!1,type:{name:"JSONSchema7"}},formRef:{defaultValue:null,description:"Optionally supply a ref to the form to handle submission externally with `formRef.current.submit()`. If provided, the editor will not render its own submit UI.",name:"formRef",required:!1,type:{name:"RefObject<Form<any, RJSFSchema, any>>"}},liveValidate:{defaultValue:null,description:"Provide live input validation. This can cause major performance degradation.",name:"liveValidate",required:!1,type:{name:"boolean"}},onSuccess:{defaultValue:null,description:"Invoked after a successful form submission",name:"onSuccess",required:!1,type:{name:"(() => void)"}},onCancel:{defaultValue:null,description:"If defined and formRef is not supplied, shows a 'Cancel' button and runs this effect on click",name:"onCancel",required:!1,type:{name:"(() => void)"}},onChange:{defaultValue:null,description:"Passes new form data upon each change to the form",name:"onChange",required:!1,type:{name:"((annotations: Record<string, unknown>) => void)"}}}}}catch{}export{O as A,ge as S,rr as a,ft as u};
//# sourceMappingURL=SchemaDrivenAnnotationEditor-7ba2ae11.js.map
