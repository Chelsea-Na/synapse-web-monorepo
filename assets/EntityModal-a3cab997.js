import{j as e,a as t,F as $}from"./jsx-runtime-ad672792.js";import{r as T}from"./index-f1f749bf.js";import{ai as U,aJ as G,b$ as M,aw as H,cm as z,cn as J,ax as W,ay as Q}from"./SynapseContext-d313cbec.js";import{g as V,B as I}from"./getEndpoint-ac94413e.js";import{u as C,f as X}from"./AccessRequirementList-d1733c6a.js";import{d as Y}from"./ToastMessage-524a41fb.js";import{u as Z,S as ee}from"./SchemaDrivenAnnotationEditor-f715b429.js";import{e as ae}from"./useEntity-c8966376.js";import{S as te}from"./SkeletonTable-f95355ab.js";import{d as S}from"./dayjs.min-e0adaab4.js";import{f as R}from"./DateFormatter-842bed60.js";import{g as ne,a as oe}from"./FileHandleUtils-5bc927e9.js";import{U as v}from"./UserCard-7f7526bb.js";import{B as h}from"./Button-182a752c.js";import{D as se,a as ie,b as le}from"./DialogContent-b05606ad.js";import{D as re}from"./DialogTitle-1caff05b.js";import{S as de}from"./Stack-2d799158.js";import{S as ce}from"./Skeleton-fcc77827.js";import{B as me}from"./Box-4cee9ecb.js";import{a as ue}from"./Clear-499958d6.js";const f=({entityId:n})=>{const{isInExperimentalMode:s}=U(),{entityMetadata:a,annotations:i,isLoading:m}=ae(n),{data:d}=Z(n,{enabled:s});return m?e(te,{numRows:3,numCols:2}):t($,{children:[a&&i&&G(i)?t("div",{className:"placeholder",children:["This"," ",M(H(a.concreteType))," ","has no annotations."]}):null,e("table",{className:"AnnotationsTable",children:t("tbody",{children:[i&&Object.keys(i).map(l=>t("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key",children:l}),e("td",{className:"AnnotationsTable__Row__Value",children:Array.isArray(i[l])?i[l].join(", "):i[l].toString()})]},l)),d&&s?t("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key Schema",children:"Validation Schema"}),e("td",{className:"AnnotationsTable__Row__Value",children:e("a",{href:`${V(I.REPO_ENDPOINT)}repo/v1/schema/type/registered/${d.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:d.jsonSchemaVersionInfo.schemaName})})]}):null]})})]})};try{f.displayName="AnnotationsTable",f.__docgenInfo={description:"",displayName:"AnnotationsTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}const A=({entityId:n,versionNumber:s})=>{var l,_,r,p,c,u;const{data:a}=C(n,s),i=a&&z(a.entity),m=a?ne(a):void 0;let d;return m&&(d=oe(m)),a?e("table",{className:"MetadataTable",children:t("tbody",{children:[t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Name"}),e("td",{className:"MetadataTable__Row__Value",children:(l=a.entity)==null?void 0:l.name})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Type"}),e("td",{className:"MetadataTable__Row__Value",children:M(a.entityType)})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Synapse ID"}),e("td",{className:"MetadataTable__Row__Value",children:(_=a.entity)==null?void 0:_.id})]}),i&&t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Version"}),e("td",{className:"MetadataTable__Row__Value",children:J(a.entity)})]}),d&&t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Storage"}),e("td",{className:"MetadataTable__Row__Value",children:d})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:" Last Modified By"}),t("td",{className:"MetadataTable__Row__Value",children:[e(v,{size:"SMALL USER CARD",ownerId:(r=a.entity)==null?void 0:r.modifiedBy})," ","at ",R(S((p=a.entity)==null?void 0:p.modifiedOn))]})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Created By"}),t("td",{className:"MetadataTable__Row__Value",children:[e(v,{size:"SMALL USER CARD",ownerId:(c=a.entity)==null?void 0:c.createdBy})," ","at ",R(S((u=a.entity)==null?void 0:u.createdOn))]})]})]})}):null};try{A.displayName="MetadataTable",A.__docgenInfo={description:"",displayName:"MetadataTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}var w=(n=>(n.METADATA="METADATA",n.ANNOTATIONS="ANNOTATIONS",n))(w||{});function g(n){const{entityId:s,versionNumber:a,show:i,onClose:m,initialTab:d="METADATA",showTabs:l=!0}=n,_=T.useRef(null),[r,p]=T.useState(d),[c,u]=T.useState(!1),[b,O]=T.useState(!1),{data:o}=C(s,a),B=o&&o.permissions.canEdit,N=o&&W(o.entityType),E=N&&o.entity.isLatestVersion,D=r==="METADATA"&&o&&!window.location.href.includes(s),k=t(h,{variant:"contained",onClick:()=>window.open(`${V(I.PORTAL_ENDPOINT)}#!Synapse:${s}`,"_blank","noopener"),children:["Open"," ",o?M(o==null?void 0:o.entityType):""]}),x=r==="ANNOTATIONS"&&c,L=e(h,{variant:"contained",onClick:()=>{_.current.formElement.dispatchEvent(new CustomEvent("submit",{cancelable:!0,bubbles:!0}))},children:"Save Annotations"}),q=r==="ANNOTATIONS"&&c,j=e(h,{variant:"outlined",onClick:()=>{b&&u(!1),O(!b)},children:b?"Are you sure? Unsaved changes will be lost":"Cancel"}),K=B&&r==="ANNOTATIONS"&&!c,P=e(ue,{title:N&&!E?"Annotations can only be edited on the latest version":void 0,children:e(h,{variant:"contained",disabled:N&&!E,onClick:()=>{u(!0)},children:"Edit"})});return t(se,{className:"EntityMetadata",open:i,onClose:m,maxWidth:c?"md":"sm",fullWidth:!0,children:[e(re,{children:t(de,{direction:"row",alignItems:"center",gap:"5px",children:[o?o.entity.name:e(ce,{width:"40%"}),e(me,{sx:{flexGrow:1}}),e(X,{onClick:m})]})}),t(ie,{children:[l&&!c?e("div",{className:"Tabs",children:Object.keys(w).map(y=>e("div",{className:"Tab",role:"tab",onClick:F=>{F.stopPropagation(),p(w[y])},"aria-selected":y===r,children:y},y))}):null,e("div",{style:r==="ANNOTATIONS"?{}:{display:"none"},children:c?e(Q,{children:e(ee,{entityId:s,formRef:_,onSuccess:()=>{Y("Annotations successfully updated.","success"),u(!1)},onCancel:()=>u(!1)})}):e(f,{entityId:s,versionNumber:a})}),e("div",{style:r==="METADATA"?{}:{display:"none"},children:e(A,{entityId:s,versionNumber:a})})]}),t(le,{children:[q&&j,x&&L,K&&P,D&&k]})]})}try{g.displayName="EntityModal",g.__docgenInfo={description:"",displayName:"EntityModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},initialTab:{defaultValue:null,description:"",name:"initialTab",required:!1,type:{name:"enum",value:[{value:'"METADATA"'},{value:'"ANNOTATIONS"'}]}},showTabs:{defaultValue:null,description:"",name:"showTabs",required:!1,type:{name:"boolean"}}}}}catch{}export{g as E,w as a};
//# sourceMappingURL=EntityModal-a3cab997.js.map
