{"version":3,"file":"SchemaDrivenAnnotationEditor-2eecb0cc.js","sources":["../../src/synapse-queries/entity/useEntityBoundSchema.ts","../../src/synapse-queries/entity/useSchema.ts","../../src/assets/icons/AddToList.tsx","../../src/components/SchemaDrivenAnnotationEditor/AnnotationEditorUtils.ts","../../src/components/SchemaDrivenAnnotationEditor/field/AdditionalPropertiesSchemaField.tsx","../../src/components/SchemaDrivenAnnotationEditor/widget/BooleanWidget.tsx","../../src/components/SchemaDrivenAnnotationEditor/widget/DateTimeWidget.tsx","../../src/components/SchemaDrivenAnnotationEditor/template/ObjectFieldTemplate.tsx","../../src/components/SchemaDrivenAnnotationEditor/widget/TextWidget.tsx","../../src/components/SchemaDrivenAnnotationEditor/field/CustomObjectField.tsx","../../src/components/SchemaDrivenAnnotationEditor/template/WrapIfAdditionalTemplate.tsx","../../src/components/SchemaDrivenAnnotationEditor/template/FieldTemplate.tsx","../../src/components/SchemaDrivenAnnotationEditor/template/FieldDescriptionTable.tsx","../../src/components/SchemaDrivenAnnotationEditor/template/DescriptionFieldTemplate.tsx","../../src/components/SchemaDrivenAnnotationEditor/template/BaseInputTemplate.tsx","../../src/components/SchemaDrivenAnnotationEditor/template/FieldErrorTemplate.tsx","../../src/components/SchemaDrivenAnnotationEditor/SchemaDrivenAnnotationEditor.tsx"],"sourcesContent":["import { UseQueryOptions, useQuery } from 'react-query'\nimport SynapseClient from '../../synapse-client'\nimport { SynapseClientError } from '../../utils/SynapseClientError'\nimport { useSynapseContext } from '../../utils/context/SynapseContext'\nimport { JsonSchemaObjectBinding } from '@sage-bionetworks/synapse-types'\nimport { ValidationResults } from '@sage-bionetworks/synapse-types'\n\nexport function useGetSchemaBinding(\n  entityId: string,\n  options?: UseQueryOptions<JsonSchemaObjectBinding | null, SynapseClientError>,\n) {\n  const { accessToken, keyFactory } = useSynapseContext()\n  return useQuery<JsonSchemaObjectBinding | null, SynapseClientError>(\n    keyFactory.getEntityBoundJsonSchemaQueryKey(entityId),\n    () => SynapseClient.getSchemaBinding(entityId, accessToken),\n    options,\n  )\n}\n\nexport function useGetValidationResults(\n  entityId: string,\n  options?: UseQueryOptions<ValidationResults, SynapseClientError>,\n) {\n  const { accessToken, keyFactory } = useSynapseContext()\n\n  return useQuery<ValidationResults, SynapseClientError>(\n    keyFactory.getEntitySchemaValidationResultsQueryKey(entityId),\n    () => SynapseClient.getSchemaValidationResults(entityId, accessToken),\n    options,\n  )\n}\n","/*\n * Hooks for accessing services related to JSON Schemas in the Synapse REST API\n */\n\nimport { JSONSchema7 } from 'json-schema'\nimport { useQuery, UseQueryOptions } from 'react-query'\nimport SynapseClient from '../../synapse-client'\nimport { SynapseClientError } from '../../utils/SynapseClientError'\nimport { useSynapseContext } from '../../utils/context/SynapseContext'\n\nexport function useGetSchema(\n  schema$id: string,\n  options?: UseQueryOptions<JSONSchema7, SynapseClientError>,\n) {\n  const { keyFactory } = useSynapseContext()\n  return useQuery<JSONSchema7, SynapseClientError>(\n    keyFactory.getValidationSchemaQueryKey(schema$id),\n    async () => {\n      const response = await SynapseClient.getValidationSchema(schema$id)\n      return response.validationSchema\n    },\n    options,\n  )\n}\n","import React from 'react'\nimport SvgIcon, { SvgIconProps } from '@mui/material/SvgIcon'\n\nconst AddToList = (props: SvgIconProps) => {\n  return (\n    <SvgIcon\n      {...props}\n      width=\"24\"\n      height=\"24\"\n      viewBox=\"0 0 24 24\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path d=\"M14 10H2V12H14V10ZM14 6H2V8H14V6ZM18 14V10H16V14H12V16H16V20H18V16H22V14H18ZM2 16H10V14H2V16Z\" />\n    </SvgIcon>\n  )\n}\n\nexport default AddToList\n","import { RJSFValidationError } from '@rjsf/utils'\nimport { flatMap, groupBy, isEmpty } from 'lodash-es'\nimport { ENTITY_CONCRETE_TYPE } from '@sage-bionetworks/synapse-types'\nimport { entityJsonKeys } from '../../utils/functions/EntityTypeUtils'\n\n/**\n * Strips null values from arrays in the provided form data. If the array is empty after\n * removing null values, the key is removed from the form data.\n *\n * This allows users to submit forms with empty array fields (SWC-5762)\n */\nexport function dropNullishArrayValues(\n  formData: Record<string, unknown>,\n): Record<string, unknown> {\n  const newFormData: Record<string, unknown> = {}\n  Object.keys(formData).forEach(key => {\n    let value = formData[key]\n    if (Array.isArray(value)) {\n      value = value.filter((item: any) => item != null)\n      if (!isEmpty(value)) {\n        newFormData[key] = value\n      }\n    } else {\n      newFormData[key] = value\n    }\n  })\n  return newFormData\n}\n\nexport function dropNullValues(\n  formData: Record<string, unknown> = {},\n): Record<string, unknown> {\n  return Object.keys(formData).reduce(\n    (acc: Record<string, unknown>, key: string) => {\n      if (formData[key] !== null) {\n        acc[key] = formData[key]\n      }\n      return acc\n    },\n    {},\n  )\n}\n\n/**\n * Inspects the property of the AjvError and modifies it to be comparable to simple key strings, like entity property keys.\n * @param error\n * @returns\n */\nexport function getFriendlyPropertyName(error: RJSFValidationError): string {\n  if (error.property?.startsWith('[')) {\n    // Additional properties are surrounded by brackets and quotations, so let's remove them\n    return error.property.substring(2, error.property.length - 2)\n  } else if (error.property?.startsWith('.')) {\n    return error.property.substring(1)\n  } else {\n    return error.property || ''\n  }\n}\n\nexport function getTransformErrors(concreteType?: ENTITY_CONCRETE_TYPE) {\n  return (errors: RJSFValidationError[]): RJSFValidationError[] => {\n    // Transform the errors in the following ways:\n    // - Simplify the set of errors when failing to select an enumeration defined with an anyOf (SWC-5724)\n    // - Show a custom error message when using a property that collides with an internal entity property (SWC-5678)\n\n    // Fixing anyOf errors\n    // Group the errors by the property that the error applies to\n    const grouped = groupBy(errors, error => error.property)\n    Object.keys(grouped).map(property => {\n      const errorGroup = grouped[property]\n\n      // First, see if it is an anyOf error\n      const hasAnyOfError = errorGroup.some(\n        e => e.message === 'should match some schema in anyOf',\n      )\n\n      // We determine if it's an anyOf *enum* error if all error messages in the property match one of these three messages:\n      const isEnumError =\n        hasAnyOfError &&\n        errorGroup.every(error => {\n          if (error.message === 'should be string') {\n            return true\n          } else if (error.message === 'should be equal to constant') {\n            return true\n          } else if (error.message === 'should match some schema in anyOf') {\n            return true\n          } else {\n            return false\n          }\n        })\n\n      // If it's an anyOf enum error, we just modify the first message and drop the rest\n      if (isEnumError && errorGroup.length > 0) {\n        errorGroup[0].message = 'should be equal to one of the allowed values'\n        grouped[property] = [errorGroup[0]]\n      }\n    })\n\n    // Ungroup the errors after potentially modifying them\n    errors = flatMap(grouped)\n\n    // Custom error message if the custom annotation key collides with an internal entity property\n    if (concreteType) {\n      errors = errors.map(error => {\n        const propertyName = getFriendlyPropertyName(error)\n        if (\n          propertyName &&\n          entityJsonKeys[concreteType].includes(propertyName)\n        ) {\n          error.message = `\"${propertyName}\" is a reserved internal key and cannot be used.`\n        }\n        return error\n      })\n    }\n\n    // Return the transformed errors.\n    return errors\n  }\n}\n\n/**\n * Custom annotations in Synapse are always arrays. This function converts initial data to be an array type.\n * If the initial data is an array, return the data itself.\n * If the initial data is a string, returns an array of substrings separated by commas.\n * Otherwise, wrap the data in an array.\n */\nexport function convertToArray<T>(value: T): Array<unknown> {\n  if (Array.isArray(value)) {\n    return value\n  } else if (typeof value === 'string') {\n    return value.split(',').map(s => s.trim()) // split a string of comma-separated values, then trim whitespace\n  } else {\n    return [value]\n  }\n}\n","import {\n  FieldProps,\n  FormContextType,\n  RJSFSchema,\n  StrictRJSFSchema,\n} from '@rjsf/utils'\nimport { isEqual } from 'lodash-es'\nimport React, { useEffect, useState } from 'react'\nimport FullWidthAlert from '../../FullWidthAlert/FullWidthAlert'\nimport { convertToArray } from '../AnnotationEditorUtils'\nimport { Grid, InputLabel } from '@mui/material'\nimport { AdditionalPropertyContextProvider } from '../template/AdditionalPropertyContext'\n\n// Matches ####-##-##T##:##:##.###Z, e.g. 1970-01-01T12:00:000Z\nconst ISO_TIMESTAMP_REGEX = /\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{3}Z/\n\n// Types that correspond to the different input fields that the annotation editor supports\nconst propertyTypeArray = [\n  'String',\n  'Integer',\n  'Float',\n  'Boolean',\n  'Datetime',\n] as const\n\nexport type PropertyType = (typeof propertyTypeArray)[number]\n\nexport function guessPropertyType(list: Array<unknown>): PropertyType {\n  if (list.length === 0) {\n    // The field was just added, so default to string\n    return 'String'\n  } else if (\n    list.every(\n      item => typeof item === 'number' || item === 'NaN', // \"NaN\" is technically a float value\n    )\n  ) {\n    if (list.every(item => Number.isInteger(item))) {\n      return 'Integer'\n    } else {\n      return 'Float'\n    }\n  } else if (list.every(item => typeof item === 'boolean')) {\n    return 'Boolean'\n  } else if (\n    list.every(item => typeof item === 'string') &&\n    (list as string[]).every((item: string) => !!ISO_TIMESTAMP_REGEX.exec(item))\n  ) {\n    return 'Datetime'\n  }\n  // otherwise, default type is 'string'\n  return 'String'\n}\n\nexport function transformDataFromPropertyType(\n  list: Array<any>,\n  propertyType: PropertyType,\n) {\n  switch (propertyType) {\n    case 'Integer':\n      return list.map(item =>\n        Number.isNaN(Number(item)) ? 0 : Math.floor(Number(item)),\n      )\n\n    case 'Float':\n      return list.map(item => {\n        const asFloat = parseFloat(item as string)\n        if (Number.isNaN(asFloat)) {\n          return 'NaN'\n        } else if (Number.isInteger(asFloat)) {\n          return asFloat.toFixed(1)\n        } else {\n          return asFloat\n        }\n      })\n    case 'Datetime':\n      return list.map(item => {\n        if (typeof item === 'string' && ISO_TIMESTAMP_REGEX.exec(item)) {\n          return item\n        } else {\n          return new Date().toISOString()\n        }\n      })\n    case 'Boolean':\n      return list.map(item => !!item)\n    case 'String':\n    default:\n      return list.map(item => String(item))\n  }\n}\n\n/**\n * Maps a Synapse Annotation PropertyType to a JSON Schema that captures the type and format.\n * @param propertyType\n */\nexport function getSchemaForPropertyType(propertyType: PropertyType) {\n  switch (propertyType) {\n    case 'Datetime':\n      return { type: 'string', format: 'datetime' }\n    case 'Boolean':\n      return { type: 'boolean' }\n    case 'Float':\n      return { type: 'number' }\n    case 'Integer':\n      return { type: 'integer' }\n    case 'String':\n    default:\n      return { type: 'string' }\n  }\n}\n\n/**\n * react-jsonschema-form SchemaField override for \"additionalProperties\" only. In Synapse these are \"custom annotations\".\n * Modifies the data to provide full compatibility with Synapse annotations features.\n *\n * This component provides these enhancements to the SchemaField:\n * - Supports selecting a type, and changing the input widget appropriately\n * - Identifying the type on mount\n * - Treat all field values as arrays\n * - When the last array value is removed, remove the entire key from the form.\n * @param props\n * @returns\n */\nexport function AdditionalPropertiesSchemaField<\n  T extends Array<unknown> = Array<unknown>,\n  S extends StrictRJSFSchema = RJSFSchema,\n  F extends FormContextType = any,\n>(\n  props: FieldProps<T, S, F> & {\n    onDropPropertyClick: (key: string) => (event: any) => void\n  },\n) {\n  const {\n    formData,\n    onChange,\n    registry,\n    schema,\n    name,\n    onDropPropertyClick,\n    idSchema,\n  } = props\n  const id = idSchema.$id\n  const { ArrayField } = registry.fields\n  const { SelectWidget } = registry.widgets\n\n  // The type determines which widget we show.\n  const [propertyType, setPropertyType] = useState(\n    guessPropertyType(convertToArray(formData)),\n  )\n\n  // If the property type is updated, store it in a new variable where we'll show a warning if data may be lost on coersion\n  const [nextPropertyType, setNextPropertyType] = useState(propertyType)\n\n  /**\n   * This effect is invoked whenever the user attempts to change the datatype of a custom annotation.\n   */\n  useEffect(() => {\n    function onNextPropertyTypeUpdate() {\n      if (Array.isArray(formData)) {\n        const dataIsEmpty =\n          formData.length === 0 ||\n          formData.every(item => item == null || item == '')\n        const coercedList = transformDataFromPropertyType(\n          formData,\n          nextPropertyType,\n        )\n        // if the data is empty or identical after conversion, then just update the property type\n        if (dataIsEmpty || nextPropertyType !== propertyType) {\n          if (isEqual(formData, coercedList)) {\n            setPropertyType(nextPropertyType)\n          }\n        }\n      }\n    }\n\n    onNextPropertyTypeUpdate()\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [nextPropertyType])\n\n  /**\n   * This effect is invoked whenever the propertyType changes.\n   */\n  useEffect(() => {\n    function coerceDataAndUpdateWidget() {\n      if (Array.isArray(formData)) {\n        if (formData.every(item => item == null)) {\n          onDropPropertyClick(name)(new CustomEvent('dropEmptyProperty'))\n        } else {\n          const coercedList = transformDataFromPropertyType(\n            formData,\n            nextPropertyType,\n          ) as unknown as T\n\n          // Data conversion is non-destructive or has been confirmed by the user\n          setPropertyType(nextPropertyType)\n          // Coerce the data to match the new type\n          onChange(coercedList)\n        }\n      }\n    }\n\n    coerceDataAndUpdateWidget()\n    // Don't add other properties to dependency array because we don't want to automatically coerce input\n    // i.e. Only coerce data when the type changes, which should only be on mount or when the user explicitly chooses a new type.\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [propertyType])\n\n  const itemsSchema = getSchemaForPropertyType(propertyType)\n\n  // If the additional property has not yet been coerced to an array, trigger an update to coerce and render nothing.\n  // We must do this because RJSF does not currently batch these kinds of updates\n  // See https://github.com/rjsf-team/react-jsonschema-form/issues/3367\n  if (!Array.isArray(formData)) {\n    onChange(convertToArray(formData) as unknown as T)\n    return <></>\n  }\n\n  return (\n    <AdditionalPropertyContextProvider\n      value={{\n        dropProperty: e => {\n          onDropPropertyClick(name)(e)\n        },\n      }}\n    >\n      <Grid item xs={2}>\n        <InputLabel htmlFor={`${id}-type`}>Type</InputLabel>\n        <SelectWidget\n          name={'Type'}\n          id={`${id}-type`}\n          schema={{} as S}\n          options={{\n            enumOptions: propertyTypeArray.map(type => ({\n              label: type,\n              value: type,\n            })),\n          }}\n          value={propertyType}\n          onChange={value => {\n            setNextPropertyType(value as PropertyType)\n          }}\n          disabled={props.disabled}\n          readOnly={props.readonly}\n          required={true}\n          isClearable={false}\n          onBlur={() => {}}\n          onFocus={() => {}}\n          registry={registry}\n          label={'Type'}\n        />\n      </Grid>\n      <Grid item xs={7}>\n        <ArrayField\n          {...props}\n          schema={{\n            ...schema,\n            items: {\n              ...itemsSchema,\n            },\n          }}\n        />\n      </Grid>\n      {propertyType !== nextPropertyType && (\n        <FullWidthAlert\n          variant=\"warning\"\n          title=\"Data may be lost when converting types\"\n          description={`Are you sure you want to convert ${name} from ${propertyType} to ${nextPropertyType}? Current values may be lost on conversion.`}\n          primaryButtonConfig={{\n            text: 'Convert',\n            onClick: () => {\n              setPropertyType(nextPropertyType)\n            },\n          }}\n          secondaryButtonConfig={{\n            text: 'Cancel',\n            onClick: () => {\n              setNextPropertyType(propertyType)\n            },\n          }}\n          isGlobal={false}\n        />\n      )}\n    </AdditionalPropertyContextProvider>\n  )\n}\n","import { Widget, WidgetProps } from '@rjsf/utils'\nimport React from 'react'\n\n/**\n * Select widget compatible with react-jsonschema-form booleans\n */\nexport const BooleanWidget: Widget = (props: WidgetProps) => {\n  const { SelectWidget } = props.registry.widgets\n\n  const options = {\n    enumOptions: [\n      { value: true, label: 'true' },\n      { value: false, label: 'false' },\n    ],\n  }\n  return <SelectWidget {...props} options={options} />\n}\n","import { Widget, WidgetProps } from '@rjsf/utils'\nimport dayjs, { Dayjs } from 'dayjs'\nimport React from 'react'\nimport { CalendarWithIconFormGroup } from '../../Evaluation/CalendarWithIconFormGroup'\n\n/**\n * DateTime picker widget compatible with react-jsonschema-form and Synapse Datetime annotations.\n */\nexport const DateTimeWidget: Widget = ({\n  disabled,\n  value,\n  onChange,\n}: WidgetProps) => {\n  return (\n    <CalendarWithIconFormGroup\n      disabled={disabled}\n      value={value ? dayjs(value) : ''}\n      setterCallback={(newValue: string | Dayjs | null) => {\n        if (newValue == null || typeof newValue === 'string') {\n          onChange(newValue)\n        } else {\n          onChange(newValue.toISOString())\n        }\n      }}\n    ></CalendarWithIconFormGroup>\n  )\n}\n","import {\n  ADDITIONAL_PROPERTY_FLAG,\n  canExpand,\n  FormContextType,\n  getTemplate,\n  getUiOptions,\n  ObjectFieldTemplatePropertyType,\n  ObjectFieldTemplateProps,\n  RJSFSchema,\n  StrictRJSFSchema,\n} from '@rjsf/utils'\nimport React, { useRef } from 'react'\nimport { Button, Tooltip } from '@mui/material'\nimport { useDeepCompareEffectNoCheck } from 'use-deep-compare-effect'\nimport { displayToast } from '../../ToastMessage'\nimport AddToList from '../../../assets/icons/AddToList'\nimport { JSONSchema7Definition } from 'json-schema'\n\n/**\n * Derived from the base ObjectFieldTemplate with annotations-editor-specific changes\n * - Custom button for adding additional properties\n * - Tracks properties to show a toast message if a property is converted to an additionalProperty because it was\n *   dropped from the schema (e.g. in a conditional schema)\n *\n * See https://github.com/rjsf-team/react-jsonschema-form/blob/main/packages/mui/src/ObjectFieldTemplate/ObjectFieldTemplate.tsx\n * @param props\n * @returns\n */\nexport function ObjectFieldTemplate<\n  T extends Record<string, any> | null | undefined = Record<string, any>,\n  S extends StrictRJSFSchema = RJSFSchema,\n  F extends FormContextType = any,\n>(props: ObjectFieldTemplateProps<T, S, F>) {\n  const {\n    description,\n    disabled,\n    formData,\n    idSchema,\n    onAddClick,\n    properties,\n    readonly,\n    registry,\n    required,\n    schema,\n    title,\n    uiSchema,\n  } = props\n\n  const options = getUiOptions<T, S, F>(uiSchema)\n  const TitleFieldTemplate = getTemplate<'TitleFieldTemplate', T, S, F>(\n    'TitleFieldTemplate',\n    registry,\n    options,\n  )\n  const DescriptionFieldTemplate = getTemplate<\n    'DescriptionFieldTemplate',\n    T,\n    S,\n    F\n  >('DescriptionFieldTemplate', registry, options)\n\n  /*\n     Tracks the property keys that were last known to exist in the object.\n     */\n  const previousSchemaDefinedProperties = useRef<Set<string>>(new Set())\n\n  /**\n   * We track how the schema changes as the user enters data, causing conditional subschemas to be evaluated.\n   *\n   * If a property exists in the previous version of the schema and has user data, and then is dropped from the schema due to a data update, then\n   * we need to prompt the user whether they want to undo the change, or continue and keep/remove those fields\n   *\n   * In this component, we can identify when one or more fields with user data are dropped (the field gains the additional property flag in the schema prop).\n   * We then use a function provided by the context to report which fields were lost.\n   */\n  useDeepCompareEffectNoCheck(() => {\n    if ('properties' in schema && schema.properties) {\n      const propertyKeys = Object.keys(schema.properties)\n      // Schema-defined properties are those properties in the schema without the additional property flag.\n      const schemaDefinedProperties = new Set<string>(\n        propertyKeys.filter(key => {\n          const propertyObject = schema.properties![\n            key\n          ] as JSONSchema7Definition &\n            Record<typeof ADDITIONAL_PROPERTY_FLAG, any>\n          return !propertyObject[ADDITIONAL_PROPERTY_FLAG]\n        }),\n      )\n\n      if (previousSchemaDefinedProperties.current != null) {\n        // Compare the schema defined properties with the previous version to see if any were lost.\n        const lostProperties = Array.from(\n          previousSchemaDefinedProperties.current,\n        ).filter(schemaDefinedProperty => {\n          return (\n            // Property is no longer in schema\n            !schemaDefinedProperties.has(schemaDefinedProperty) &&\n            // Form data exists\n            !!formData &&\n            // Property still exists in form data and is not null\n            // if the data is null, then we don't need to worry about it; user data wasn't lost\n            formData[schemaDefinedProperty] != null &&\n            // Property matches `additionalProperties` requirements: is an array and contains non-null values\n            Array.isArray(formData[schemaDefinedProperty]) &&\n            (formData[schemaDefinedProperty] as Array<never>).filter(\n              item => item != null,\n            ).length > 0\n          )\n        })\n        if (lostProperties.length > 0) {\n          // Report the converted fields in a toast message\n          displayToast(\n            `The following annotations are no longer specified by the schema and have been converted to custom fields: ${lostProperties.join(\n              ', ',\n            )}.`,\n            'warning',\n            {\n              title: 'Fields No Longer Specified By Schema',\n            },\n          )\n        }\n      }\n      // Update the last known properties to match the current properties\n      previousSchemaDefinedProperties.current = schemaDefinedProperties\n    }\n  }, [schema.properties])\n\n  return (\n    <fieldset id={idSchema.$id}>\n      {(options.title || title) && (\n        <TitleFieldTemplate\n          id={`${idSchema.$id}__title`}\n          schema={schema}\n          title={options.title || title}\n          required={required}\n          uiSchema={uiSchema}\n          registry={registry}\n        />\n      )}\n      {(options.description || description) && (\n        <DescriptionFieldTemplate\n          id={`${idSchema.$id}__description`}\n          description={options.description || description!}\n          registry={registry}\n          schema={schema}\n        />\n      )}\n      {properties.map((prop: ObjectFieldTemplatePropertyType) => prop.content)}\n\n      {canExpand(schema, uiSchema, formData) && (\n        <Tooltip title=\"Add a new custom field\" placement=\"top\">\n          <Button\n            sx={{ my: 2 }}\n            variant=\"contained\"\n            className=\"object-property-expand\"\n            onClick={onAddClick(schema)}\n            disabled={disabled || readonly}\n            aria-label={'Add Custom Field'}\n          >\n            <AddToList />\n          </Button>\n        </Tooltip>\n      )}\n    </fieldset>\n  )\n}\n","import { Widget, WidgetProps } from '@rjsf/utils'\nimport React from 'react'\n\n/**\n * This TextWidget is almost identical to the rjsf TextWidget, except we handle numbers like strings to prevent issues if\n * the actual annotation data is not a string.\n */\nexport const TextWidget: Widget = (props: WidgetProps) => {\n  const { BaseInputTemplate } = props.registry.templates\n\n  // options.inputType will override the input type determined via schema\n  let inputType: string | undefined = undefined\n  if (props.schema.type === 'number' || props.schema.type === 'integer') {\n    inputType = 'text'\n  }\n\n  return (\n    <BaseInputTemplate\n      {...props}\n      options={{ ...props.options, inputType: inputType }}\n    />\n  )\n}\n\nexport default TextWidget\n","import React, { useEffect } from 'react'\nimport { getDefaultRegistry } from '@rjsf/core'\nimport { convertToArray } from '../AnnotationEditorUtils'\nimport {\n  ADDITIONAL_PROPERTY_FLAG,\n  deepEquals,\n  FieldProps,\n  FormContextType,\n  PROPERTIES_KEY,\n  RJSFSchema,\n  StrictRJSFSchema,\n} from '@rjsf/utils'\nimport { JSONSchema7Definition } from 'json-schema'\n\n/**\n * Extends the @rjsf/core `ObjectField` and just adds a custom hook for Synapse annotation business logic\n */\nexport function CustomObjectField<\n  T extends Record<string, any> | null | undefined = Record<string, any>,\n  S extends StrictRJSFSchema = RJSFSchema,\n  F extends FormContextType = any,\n>(props: FieldProps<T, S, F>) {\n  const {\n    fields: { ObjectField },\n  } = getDefaultRegistry<T, S, F>()\n  /**\n   * For an object, this will\n   * - convert additionalProperties formData to arrays\n   * - convert schema-defined formData from an array to a non-array if the schema type is not an array\n   * @param props\n   */\n  useEffect(() => {\n    const { schema, formData, onChange } = props\n    const newFormData: Record<string, any> = { ...formData }\n    if (schema[PROPERTIES_KEY]) {\n      Object.entries(schema[PROPERTIES_KEY]).forEach(\n        ([key, propertySchema]) => {\n          const data = newFormData[key]\n          if (\n            (\n              propertySchema as JSONSchema7Definition &\n                Record<typeof ADDITIONAL_PROPERTY_FLAG, any>\n            )[ADDITIONAL_PROPERTY_FLAG]\n          ) {\n            /**\n             * All additional properties should be converted to arrays.\n             *\n             * We need to convert it right away because the order of items is not stable, and seems to depend on if the item is an array or not\n             */\n            if (!Array.isArray(data)) {\n              newFormData[key] = convertToArray(data)\n            }\n          } else {\n            /**\n             * If the schema does not call for an array, but the formData is an array, then this will coerce it to a string.\n             *\n             * This can occur when a formData value is an additionalProperty, which we always treat as an array, then the key\n             * is added to the schema (e.g. conditionally).\n             */\n            if (\n              typeof propertySchema === 'object' &&\n              'type' in propertySchema &&\n              propertySchema.type !== 'array' &&\n              Array.isArray(data)\n            ) {\n              newFormData[key] = data.map(v => `${v}`).join(', ')\n            }\n          }\n        },\n      )\n      if (!deepEquals(formData, newFormData)) {\n        onChange(newFormData as T)\n      }\n    }\n  })\n\n  return <ObjectField {...props} />\n}\n\nexport default CustomObjectField\n","import {\n  ADDITIONAL_PROPERTY_FLAG,\n  FormContextType,\n  RJSFSchema,\n  StrictRJSFSchema,\n  TranslatableString,\n  WrapIfAdditionalTemplateProps,\n} from '@rjsf/utils'\nimport React, { FocusEventHandler } from 'react'\nimport { Grid, TextField } from '@mui/material'\n\n/** The `WrapIfAdditional` component is used by the `FieldTemplate` to rename, or remove properties that are\n * part of an `additionalProperties` part of a schema.\n *\n * @param props - The `WrapIfAdditionalProps` for this component\n */\nexport default function WrapIfAdditionalTemplate<\n  T = any,\n  S extends StrictRJSFSchema = RJSFSchema,\n  F extends FormContextType = any,\n>(props: WrapIfAdditionalTemplateProps<T, S, F>) {\n  const {\n    id,\n    classNames,\n    disabled,\n    label,\n    onKeyChange,\n    readonly,\n    required,\n    schema,\n    children,\n    registry,\n  } = props\n  const { translateString } = registry\n  const keyLabel = translateString(TranslatableString.KeyLabel, [''])\n  const additional = ADDITIONAL_PROPERTY_FLAG in schema\n\n  if (!additional) {\n    return <div className={classNames}>{children}</div>\n  }\n\n  const handleBlur: FocusEventHandler<\n    HTMLInputElement | HTMLTextAreaElement\n  > = ({ target }) => {\n    if (target) onKeyChange(target.value)\n  }\n\n  return (\n    <div className={classNames}>\n      <Grid container sx={{ my: 2 }} columnSpacing={2} rowSpacing={0}>\n        <Grid item xs={3}>\n          <TextField\n            fullWidth={true}\n            required={required}\n            label={keyLabel}\n            defaultValue={label}\n            disabled={disabled || readonly}\n            id={`${id}-key`}\n            name={`${id}-key`}\n            onBlur={!readonly ? handleBlur : undefined}\n            type=\"text\"\n          />\n        </Grid>\n        {children}\n        {/* All additional properties are treated as arrays, so we don't show a remove button here. */}\n        {/* To drop the property, drop the last array item. */}\n      </Grid>\n    </div>\n  )\n}\n","import React, { useState } from 'react'\nimport {\n  FieldTemplateProps,\n  FormContextType,\n  getTemplate,\n  getUiOptions,\n  RJSFSchema,\n  StrictRJSFSchema,\n} from '@rjsf/utils'\nimport { HelpOutline } from '@mui/icons-material'\nimport { Collapse, Grid, IconButton, InputLabel, Tooltip } from '@mui/material'\n\n// TODO: Wrap and pull out class names to remove bootstrap classes\n//  https://rjsf-team.github.io/react-jsonschema-form/docs/advanced-customization/custom-templates/#baseinputtemplate\n\nexport function FieldTemplate<\n  T = any,\n  S extends StrictRJSFSchema = RJSFSchema,\n  F extends FormContextType = any,\n>(props: FieldTemplateProps<T, S, F>) {\n  const {\n    id,\n    label,\n    children,\n    errors,\n    help,\n    description,\n    hidden,\n    required,\n    displayLabel,\n    registry,\n    uiSchema,\n    schema,\n  } = props\n  const uiOptions = getUiOptions<T, S, F>(uiSchema)\n  const WrapIfAdditionalTemplate = getTemplate<\n    'WrapIfAdditionalTemplate',\n    T,\n    S,\n    F\n  >('WrapIfAdditionalTemplate', registry, uiOptions)\n  const [showDetails, setShowDetails] = useState(false)\n\n  if (hidden) {\n    return <div className=\"hidden\">{children}</div>\n  }\n  return (\n    <WrapIfAdditionalTemplate {...props}>\n      {/* RJSF hides labels for boolean checkboxes, but since we replaced checkboxes with a custom component, we want to show them */}\n      {(displayLabel || schema.type === 'boolean') && (\n        <div className=\"LabelContainer\">\n          <InputLabel htmlFor={id}>\n            {label}\n            {required && <span className=\"required\">*</span>}\n          </InputLabel>\n          <Tooltip title={'More Info'}>\n            <IconButton\n              onClick={e => {\n                e.preventDefault()\n                setShowDetails(!showDetails)\n              }}\n              aria-expanded={showDetails}\n              size={'small'}\n            >\n              <HelpOutline\n                color={'primary'}\n                sx={{ width: '16px', height: '16px' }}\n              />\n            </IconButton>\n          </Tooltip>\n        </div>\n      )}\n      {children}\n      <Grid item xs={12}>\n        {errors}\n      </Grid>\n      <Collapse className=\"field-description\" in={showDetails}>\n        {description}\n      </Collapse>\n      {help}\n    </WrapIfAdditionalTemplate>\n  )\n}\n","import { Collapse } from '@mui/material'\nimport React from 'react'\nimport { JSONSchema7, JSONSchema7Definition } from 'json-schema'\n\nexport type FieldDescriptionTableProps = {\n  schema: JSONSchema7\n  description: React.ReactNode\n}\n\nfunction getTypeAsString(\n  schema: JSONSchema7 | JSONSchema7Definition | JSONSchema7Definition[],\n): string {\n  if (Array.isArray(schema) || typeof schema === 'boolean') {\n    return 'unknown'\n  }\n  const { type, enum: _enum } = schema\n\n  if (type === 'array' && typeof schema.items === 'object') {\n    return `List of ${getTypeAsString(schema.items)}`\n  }\n\n  if (_enum) {\n    return 'enumeration'\n  }\n\n  if (Array.isArray(type)) {\n    return type.reduce(\n      (typesCommaSeparated, nextType) => `${typesCommaSeparated}, ${nextType}`,\n      '',\n    )\n  }\n  return type || 'unknown'\n}\n\nexport default function FieldDescriptionTable(\n  props: FieldDescriptionTableProps,\n) {\n  const { description, schema } = props\n\n  const typeString = getTypeAsString(schema)\n\n  return (\n    <Collapse className=\"field-description\" in={true}>\n      <table className=\"FieldDescriptionTable\">\n        <tbody>\n          {description && (\n            <tr>\n              <th>Description</th>\n              <td>{description}</td>\n            </tr>\n          )}\n          <tr>\n            <th>Type</th>\n            <td>{typeString}</td>\n          </tr>\n        </tbody>\n      </table>\n    </Collapse>\n  )\n}\n","import { DescriptionFieldProps } from '@rjsf/utils'\nimport React from 'react'\nimport { Typography } from '@mui/material'\nimport FieldDescriptionTable from './FieldDescriptionTable'\n\nexport default function DescriptionFieldTemplate(props: DescriptionFieldProps) {\n  const { description, schema = {} } = props\n\n  if (schema.type === 'object') {\n    return (\n      <Typography variant={'body1'} sx={{ my: 2 }}>\n        {description}\n      </Typography>\n    )\n  }\n\n  return <FieldDescriptionTable schema={schema} description={description} />\n}\n","import React from 'react'\nimport { ChangeEvent, FocusEvent } from 'react'\nimport TextField, { TextFieldProps } from '@mui/material/TextField'\nimport {\n  ariaDescribedByIds,\n  BaseInputTemplateProps,\n  examplesId,\n  getInputProps,\n  labelValue,\n  FormContextType,\n  RJSFSchema,\n  StrictRJSFSchema,\n} from '@rjsf/utils'\n\nconst TYPES_THAT_SHRINK_LABEL = ['date', 'datetime-local', 'file', 'time']\n\n/** The `BaseInputTemplate` is the template to use to render the basic `<input>` component for the `core` theme.\n * It is used as the template for rendering many of the <input> based widgets that differ by `type` and callbacks only.\n * It can be customized/overridden for other themes or individual implementations as needed.\n *\n * @param props - The `WidgetProps` for this template\n */\nexport default function BaseInputTemplate<\n  T = any,\n  S extends StrictRJSFSchema = RJSFSchema,\n  F extends FormContextType = any,\n>(props: BaseInputTemplateProps<T, S, F>) {\n  const {\n    id,\n    name, // remove this from textFieldProps\n    placeholder,\n    required,\n    readonly,\n    disabled,\n    type,\n    label,\n    // hideLabel,\n    value,\n    onChange,\n    onChangeOverride,\n    onBlur,\n    onFocus,\n    autofocus,\n    options,\n    schema,\n    uiSchema,\n    rawErrors = [],\n    formContext,\n    registry,\n    InputLabelProps,\n    ...textFieldProps\n  } = props\n  const hideLabel = true\n  const inputProps = getInputProps<T, S, F>(schema, type, options)\n  // Now we need to pull out the step, min, max into an inner `inputProps` for material-ui\n  const { step, min, max, ...rest } = inputProps\n  const otherProps = {\n    inputProps: {\n      step,\n      min,\n      max,\n      ...(schema.examples ? { list: examplesId<T>(id) } : undefined),\n    },\n    ...rest,\n  }\n  const _onChange = ({ target: { value } }: ChangeEvent<HTMLInputElement>) =>\n    onChange(value === '' ? options.emptyValue : value)\n  const _onBlur = ({ target: { value } }: FocusEvent<HTMLInputElement>) =>\n    onBlur(id, value)\n  const _onFocus = ({ target: { value } }: FocusEvent<HTMLInputElement>) =>\n    onFocus(id, value)\n  const DisplayInputLabelProps = TYPES_THAT_SHRINK_LABEL.includes(type)\n    ? {\n        ...InputLabelProps,\n        shrink: true,\n      }\n    : InputLabelProps\n\n  let derivedValuePlaceholder: string | undefined = undefined\n  if (schema.default || schema.const) {\n    derivedValuePlaceholder =\n      JSON.stringify(schema.default || schema.const) + ' (derived)'\n  }\n\n  return (\n    <>\n      <TextField\n        id={id}\n        name={id}\n        placeholder={derivedValuePlaceholder || placeholder}\n        label={labelValue(label || undefined, hideLabel, false)}\n        autoFocus={autofocus}\n        required={false}\n        disabled={disabled || readonly}\n        {...otherProps}\n        value={value || value === 0 ? value : ''}\n        error={rawErrors.length > 0}\n        onChange={onChangeOverride || _onChange}\n        onBlur={_onBlur}\n        onFocus={_onFocus}\n        InputLabelProps={DisplayInputLabelProps}\n        {...(textFieldProps as TextFieldProps)}\n        inputProps={{\n          'aria-label': id,\n        }}\n        aria-describedby={ariaDescribedByIds<T>(id, !!schema.examples)}\n      />\n      {Array.isArray(schema.examples) && (\n        <datalist id={examplesId<T>(id)}>\n          {(schema.examples as string[])\n            .concat(\n              schema.default && !schema.examples.includes(schema.default)\n                ? ([schema.default] as string[])\n                : [],\n            )\n            .map((example: any) => {\n              return <option key={example} value={example} />\n            })}\n        </datalist>\n      )}\n    </>\n  )\n}\n","import React from 'react'\nimport ListItem from '@mui/material/ListItem'\nimport FormHelperText from '@mui/material/FormHelperText'\nimport List from '@mui/material/List'\nimport {\n  errorId,\n  FieldErrorProps,\n  FormContextType,\n  RJSFSchema,\n  StrictRJSFSchema,\n} from '@rjsf/utils'\n\n/** The `FieldErrorTemplate` component renders the errors local to the particular field\n *\n * @param props - The `FieldErrorProps` for the errors being rendered\n */\nexport default function FieldErrorTemplate<\n  T = any,\n  S extends StrictRJSFSchema = RJSFSchema,\n  F extends FormContextType = any,\n>(props: FieldErrorProps<T, S, F>) {\n  const { errors = [], idSchema } = props\n  if (errors.length === 0) {\n    return null\n  }\n  const id = errorId<T>(idSchema)\n\n  return (\n    <List dense={true} disablePadding={true}>\n      {errors.map((error, i: number) => {\n        return (\n          <ListItem key={i} disableGutters={true}>\n            <FormHelperText id={id} sx={{ color: 'error.main' }}>\n              {error}\n            </FormHelperText>\n          </ListItem>\n        )\n      })}\n    </List>\n  )\n}\n","import Form from '@rjsf/mui'\nimport { JSONSchema7, JSONSchema7Definition } from 'json-schema'\nimport isEmpty from 'lodash-es/isEmpty'\nimport React, { useCallback, useEffect, useMemo, useRef } from 'react'\nimport { Alert, Box, Divider, Link, Typography } from '@mui/material'\nimport AddToList from '../../assets/icons/AddToList'\nimport {\n  BackendDestinationEnum,\n  getEndpoint,\n} from '../../utils/functions/getEndpoint'\nimport {\n  useGetJson,\n  useGetSchema,\n  useGetSchemaBinding,\n  useUpdateViaJson,\n} from '../../synapse-queries'\nimport { SynapseClientError } from '../../utils'\nimport {\n  ENTITY_CONCRETE_TYPE,\n  EntityJson,\n} from '@sage-bionetworks/synapse-types'\nimport { SynapseSpinner } from '../LoadingScreen/LoadingScreen'\nimport { AdditionalPropertiesSchemaField } from './field/AdditionalPropertiesSchemaField'\nimport {\n  dropNullishArrayValues,\n  dropNullValues,\n  getFriendlyPropertyName,\n  getTransformErrors,\n} from './AnnotationEditorUtils'\nimport { BooleanWidget } from './widget/BooleanWidget'\nimport { DateTimeWidget } from './widget/DateTimeWidget'\nimport { ObjectFieldTemplate } from './template/ObjectFieldTemplate'\nimport { SelectWidget } from './widget/SelectWidget'\nimport TextWidget from './widget/TextWidget'\nimport { entityJsonKeys } from '../../utils/functions/EntityTypeUtils'\nimport {\n  ConfirmationButtons,\n  ConfirmationDialog,\n} from '../ConfirmationDialog/ConfirmationDialog'\nimport { RJSFValidationError } from '@rjsf/utils'\nimport validator from '@rjsf/validator-ajv8'\nimport CustomObjectField from './field/CustomObjectField'\nimport ArrayFieldItemTemplate from './template/ArrayFieldItemTemplate'\nimport ArrayFieldTemplate from './template/ArrayFieldTemplate'\nimport WrapIfAdditionalTemplate from './template/WrapIfAdditionalTemplate'\nimport { FieldTemplate } from './template/FieldTemplate'\nimport ArrayFieldTitleTemplate from './template/ArrayFieldTitleTemplate'\nimport ButtonTemplate from './template/ButtonTemplate'\nimport DescriptionFieldTemplate from './template/DescriptionFieldTemplate'\nimport ArrayFieldDescriptionTemplate from './template/ArrayFieldDescriptionTemplate'\nimport BaseInputTemplate from './template/BaseInputTemplate'\nimport RJSF from '@rjsf/core'\nimport FieldErrorTemplate from './template/FieldErrorTemplate'\n\nexport type SchemaDrivenAnnotationEditorProps = {\n  /** The entity whose annotations should be edited with the form */\n  entityId?: string\n  /** If no entity ID is supplied, the schema to use for the form */\n  schemaId?: string\n  /** May be used to directly provide a JSON Schema to use for the form */\n  validationSchema?: JSONSchema7\n  /** Optionally supply a ref to the form to handle submission externally with `formRef.current.submit()`. If provided, the editor will not render its own submit UI. */\n  formRef?: React.RefObject<RJSF>\n  /** Provide live input validation. This can cause major performance degradation. */\n  liveValidate?: boolean\n  /** Invoked after a successful form submission */\n  onSuccess?: () => void\n  /** If defined and formRef is not supplied, shows a 'Cancel' button and runs this effect on click */\n  onCancel?: () => void\n  /** Passes new form data upon each change to the form */\n  onChange?: (annotations: Record<string, unknown>) => void\n}\n\n/**\n * patternProperties lets us define how to treat additionalProperties in a JSON schema by property name.\n * In all cases, let's ban properties that collide with entity properties by making their schema \"not: {}\"\n */\nfunction getPatternPropertiesBannedKeys(\n  concreteType?: ENTITY_CONCRETE_TYPE,\n): Record<string, JSONSchema7Definition> {\n  if (!concreteType) {\n    return {}\n  }\n  // for each property (e.g. id, name, etag, etc.)\n  //  Add to the JSON Schema `\"^id$\": { \"not\": {} }` to ban the property from being added as an additional property.\n  return entityJsonKeys[concreteType].reduce(\n    (current: Record<string, JSONSchema7Definition>, item) => {\n      current[`^${item}$`] = { not: {} }\n      return current\n    },\n    {},\n  )\n}\n\n/**\n * Cleans the formData to remove values that are invalid for Synapse Annotations\n * @param formData\n * @param dropNullishValuesInArrays\n */\nfunction cleanFormData(\n  formData: Record<string, unknown> | undefined,\n  dropNullishValuesInArrays: boolean,\n) {\n  let cleanedFormData = dropNullValues(formData)\n  if (dropNullishValuesInArrays) {\n    cleanedFormData = dropNullishArrayValues(cleanedFormData)\n  }\n  return cleanedFormData\n}\n\n/**\n * Renders a form for editing an entity's annotations. The component also supports supplying just a schema ID,\n * but work to support annotation flows without an entity (i.e. before creating entities) is not yet complete.\n */\nexport function SchemaDrivenAnnotationEditor(\n  props: SchemaDrivenAnnotationEditorProps,\n) {\n  const {\n    entityId,\n    schemaId,\n    validationSchema: validationSchemaFromProps,\n    liveValidate = false,\n    onSuccess = () => {\n      /* no-op */\n    },\n    onCancel,\n    formRef: formRefFromParent,\n    onChange,\n  } = props\n  const localRef = useRef<RJSF>(null)\n  const ref = formRefFromParent ?? localRef\n\n  // Client-side validation errors\n  const [validationError, setValidationError] = React.useState<\n    RJSFValidationError[] | undefined\n  >(undefined)\n\n  // Errors from the backend response\n  const [submissionError, setSubmissionError] = React.useState<\n    SynapseClientError | undefined\n  >(undefined)\n  const [showSubmissionError, setShowSubmissionError] = React.useState(false)\n\n  const [showConfirmation, setShowConfirmation] = React.useState(false)\n\n  const { entityMetadata: entityJson, annotations } = useGetJson(\n    entityId!,\n    // Derived annotations will be precomputed and displayed as placeholders in the form\n    false,\n    {\n      // Metadata is being edited, so don't refetch\n      staleTime: Infinity,\n      enabled: !!entityId,\n      useErrorBoundary: true,\n    },\n  )\n\n  // Annotation fields fetched and modified via the form\n  const [formData, setFormData] = React.useState<\n    Record<string, unknown> | undefined\n  >(annotations)\n\n  /**\n   * patternProperties lets us define how to treat additionalProperties in a JSON schema by property name.\n   * In all cases, let's ban properties that collide with entity properties by making their schema \"not: {}\"\n   */\n  const patternPropertiesBannedKeys = useMemo(\n    () => getPatternPropertiesBannedKeys(entityJson?.concreteType),\n    [entityJson?.concreteType],\n  )\n\n  const transformErrors = useCallback(\n    getTransformErrors(entityJson?.concreteType),\n    [entityJson?.concreteType],\n  )\n\n  useEffect(() => {\n    if (annotations) {\n      // Put the annotations into a state variable so it can be modified by the form.\n      setFormData(annotations)\n    }\n  }, [annotations])\n\n  const { data: schema, isLoading: isLoadingBinding } = useGetSchemaBinding(\n    entityId!,\n    {\n      enabled: !!entityId,\n      refetchOnWindowFocus: false,\n      useErrorBoundary: true,\n    },\n  )\n\n  const { data: fetchedValidationSchema, isLoading: isLoadingSchema } =\n    useGetSchema(schemaId ?? schema?.jsonSchemaVersionInfo.$id ?? '', {\n      enabled: !!schemaId || !!schema,\n      useErrorBoundary: true,\n    })\n\n  const validationSchema = validationSchemaFromProps || fetchedValidationSchema\n\n  const isLoading = isLoadingBinding || isLoadingSchema\n\n  const mutation = useUpdateViaJson({\n    onSuccess: () => {\n      onSuccess()\n    },\n    onError: error => {\n      setSubmissionError(error)\n      setShowSubmissionError(true)\n    },\n  })\n\n  function submitChangedEntity() {\n    mutation.mutate({\n      ...cleanFormData(formData, true),\n      ...entityJson,\n    } as EntityJson)\n  }\n\n  return (\n    <div className=\"JsonSchemaFormContainer\">\n      {isLoading ? (\n        <div className=\"LoadingPlaceholder\">\n          <SynapseSpinner size={30} />\n        </div>\n      ) : (\n        <>\n          {entityJson && schema && (\n            <Alert severity=\"info\" sx={{ mb: 2 }}>\n              <b>{entityJson.name}</b> requires scientific annotations specified\n              by <b>{schema.jsonSchemaVersionInfo.$id}</b>\n              {'. '}\n              <b>\n                <Link\n                  href={`${getEndpoint(\n                    BackendDestinationEnum.REPO_ENDPOINT,\n                  )}/repo/v1/schema/type/registered/${\n                    schema.jsonSchemaVersionInfo.$id\n                  }`}\n                  target=\"_blank\"\n                  rel=\"noopener noreferrer\"\n                >\n                  View required schema (JSON)\n                </Link>\n              </b>\n            </Alert>\n          )}\n          {entityJson && isEmpty(formData) && schema === null && (\n            <Alert severity=\"info\">\n              <Box display={'flex'} alignItems={'center'} gap={0.5}>\n                <Typography variant={'smallText1'}>\n                  <b>{entityJson.name}</b> has no annotations. Click the{' '}\n                </Typography>\n                <AddToList />\n                <Typography variant={'smallText1'}>\n                  button to annotate.\n                </Typography>\n              </Box>\n            </Alert>\n          )}\n          {formData != undefined && (\n            <Form\n              validator={validator}\n              className=\"JsonSchemaForm\"\n              liveValidate={liveValidate}\n              noHtml5Validate={true}\n              experimental_defaultFormStateBehavior={{\n                emptyObjectFields: 'skipDefaults',\n              }}\n              fields={{\n                ObjectField: CustomObjectField,\n              }}\n              templates={{\n                ArrayFieldDescriptionTemplate: ArrayFieldDescriptionTemplate,\n                ArrayFieldItemTemplate: ArrayFieldItemTemplate,\n                ArrayFieldTemplate: ArrayFieldTemplate,\n                ArrayFieldTitleTemplate: ArrayFieldTitleTemplate,\n                BaseInputTemplate: BaseInputTemplate,\n                FieldErrorTemplate: FieldErrorTemplate,\n                FieldTemplate: FieldTemplate,\n                ObjectFieldTemplate: ObjectFieldTemplate,\n                WrapIfAdditionalTemplate: WrapIfAdditionalTemplate,\n                ButtonTemplates: ButtonTemplate,\n                DescriptionFieldTemplate: DescriptionFieldTemplate,\n                /* Errors are displayed by an Alert component below, so we don't show the builtin ErrorList */\n                ErrorListTemplate: () => null,\n              }}\n              ref={ref}\n              disabled={mutation.isLoading}\n              schema={\n                {\n                  ...(validationSchema ?? {}),\n                  patternProperties: {\n                    ...(validationSchema?.patternProperties ?? {}),\n                    ...patternPropertiesBannedKeys,\n                  },\n                  additionalProperties:\n                    validationSchema?.additionalProperties ?? true,\n                } as JSONSchema7\n              }\n              uiSchema={{\n                'ui:options': {\n                  copyable: true,\n                  duplicateKeySuffixSeparator: '_',\n                },\n                additionalProperties: {\n                  'ui:field': AdditionalPropertiesSchemaField,\n                },\n              }}\n              transformErrors={transformErrors}\n              formData={formData}\n              onChange={({ formData }) => {\n                if (onChange) {\n                  onChange(formData)\n                }\n                setFormData(formData)\n                setValidationError(undefined)\n              }}\n              onBlur={() => {\n                setFormData(\n                  // Clean the formData onBlur to remove null values that we will need to strip before submission\n                  // This will ensure that the user gets accurate validation information since the data will match what the backend will receive\n                  cleanFormData(\n                    formData,\n                    // Don't remove null values in arrays--the fields will disappear, which the user probably does not want\n                    false,\n                  ),\n                )\n              }}\n              onSubmit={({ formData, errors }, event) => {\n                event.preventDefault()\n                if (errors && errors.length > 0) {\n                  setValidationError(errors)\n                }\n                setShowSubmissionError(false)\n                setFormData(formData)\n                submitChangedEntity()\n              }}\n              onError={(errors: RJSFValidationError[]) => {\n                // invoked when submit is clicked and there are client-side validation errors\n                setValidationError(errors)\n                if (validationError && entityId) {\n                  setShowConfirmation(true)\n                }\n              }}\n              widgets={{\n                TextWidget: TextWidget,\n                DateTimeWidget: DateTimeWidget,\n                SelectWidget: SelectWidget,\n                CheckboxWidget: BooleanWidget,\n              }}\n            >\n              {validationError && (\n                <Alert severity=\"error\" sx={{ my: 2 }}>\n                  <b>Validation errors found:</b>\n                  <ul>\n                    {validationError.map(\n                      (e: RJSFValidationError, index: number) => {\n                        return (\n                          <li key={index}>\n                            <b>{`${getFriendlyPropertyName(e)}: `}</b>{' '}\n                            {`${e.message}`}\n                          </li>\n                        )\n                      },\n                    )}\n                  </ul>\n                </Alert>\n              )}\n\n              {submissionError && showSubmissionError && (\n                <Alert severity=\"error\" sx={{ my: 2 }}>\n                  Annotations could not be updated: {submissionError.reason}\n                </Alert>\n              )}\n              {!formRefFromParent && (\n                <>\n                  <Divider sx={{ my: 2 }} />\n                  <Box\n                    display=\"flex\"\n                    justifyContent=\"space-between\"\n                    sx={{ gridRowStart: 5 }}\n                  >\n                    <ConfirmationButtons\n                      hasCancelButton={onCancel !== undefined}\n                      onCancel={() => {\n                        onCancel && onCancel()\n                      }}\n                      onConfirm={() => {\n                        ref.current!.formElement.current.requestSubmit()\n                      }}\n                      confirmButtonText={entityId ? 'Save' : 'Validate'}\n                    />\n                  </Box>\n                </>\n              )}\n            </Form>\n          )}\n          {showConfirmation && (\n            <ConfirmationDialog\n              open={true}\n              onConfirm={() => {\n                submitChangedEntity()\n                setShowConfirmation(false)\n              }}\n              onCancel={() => {\n                setShowConfirmation(false)\n              }}\n              title=\"Update Annotations\"\n              content={\n                <>\n                  <div>\n                    The following errors exist with the annotations you entered:\n                  </div>\n                  <div>\n                    <ul>\n                      {(validationError ?? []).map(\n                        (e: RJSFValidationError, index: number) => (\n                          <li key={index}>\n                            <b>{`${getFriendlyPropertyName(e)}: `}</b>{' '}\n                            {`${e.message}`}\n                          </li>\n                        ),\n                      )}\n                    </ul>\n                  </div>\n                  <div>\n                    Are you sure you want to save the invalid annotations?\n                  </div>\n                </>\n              }\n              confirmButtonText=\"Save\"\n            />\n          )}\n        </>\n      )}\n    </div>\n  )\n}\n"],"names":["useGetSchemaBinding","entityId","options","accessToken","keyFactory","useSynapseContext","useQuery","SynapseClient","useGetValidationResults","useGetSchema","schema$id","AddToList","props","jsx","SvgIcon","dropNullishArrayValues","formData","newFormData","key","value","item","isEmpty","dropNullValues","acc","getFriendlyPropertyName","error","_a","_b","getTransformErrors","concreteType","errors","grouped","groupBy","property","errorGroup","e","flatMap","propertyName","entityJsonKeys","convertToArray","s","ISO_TIMESTAMP_REGEX","propertyTypeArray","guessPropertyType","list","transformDataFromPropertyType","propertyType","asFloat","getSchemaForPropertyType","AdditionalPropertiesSchemaField","onChange","registry","schema","name","onDropPropertyClick","idSchema","id","ArrayField","SelectWidget","setPropertyType","useState","nextPropertyType","setNextPropertyType","useEffect","onNextPropertyTypeUpdate","dataIsEmpty","coercedList","isEqual","coerceDataAndUpdateWidget","itemsSchema","jsxs","AdditionalPropertyContextProvider","Grid","InputLabel","type","FullWidthAlert","Fragment","BooleanWidget","DateTimeWidget","disabled","CalendarWithIconFormGroup","dayjs","newValue","ObjectFieldTemplate","description","onAddClick","properties","readonly","required","title","uiSchema","getUiOptions","TitleFieldTemplate","getTemplate","DescriptionFieldTemplate","previousSchemaDefinedProperties","useRef","useDeepCompareEffectNoCheck","propertyKeys","schemaDefinedProperties","ADDITIONAL_PROPERTY_FLAG","lostProperties","schemaDefinedProperty","displayToast","prop","canExpand","Tooltip","Button","TextWidget","BaseInputTemplate","inputType","CustomObjectField","ObjectField","getDefaultRegistry","PROPERTIES_KEY","propertySchema","data","v","deepEquals","WrapIfAdditionalTemplate","classNames","label","onKeyChange","children","translateString","keyLabel","TranslatableString","handleBlur","target","TextField","FieldTemplate","help","hidden","displayLabel","uiOptions","showDetails","setShowDetails","IconButton","HelpOutline","Collapse","getTypeAsString","_enum","typesCommaSeparated","nextType","FieldDescriptionTable","typeString","Typography","TYPES_THAT_SHRINK_LABEL","placeholder","onChangeOverride","onBlur","onFocus","autofocus","rawErrors","formContext","InputLabelProps","textFieldProps","hideLabel","inputProps","getInputProps","step","min","max","rest","otherProps","examplesId","_onChange","value2","_onBlur","_onFocus","DisplayInputLabelProps","derivedValuePlaceholder","labelValue","ariaDescribedByIds","example","FieldErrorTemplate","errorId","List","i","ListItem","FormHelperText","getPatternPropertiesBannedKeys","current","cleanFormData","dropNullishValuesInArrays","cleanedFormData","SchemaDrivenAnnotationEditor","schemaId","validationSchemaFromProps","liveValidate","onSuccess","onCancel","formRefFromParent","localRef","ref","validationError","setValidationError","React","submissionError","setSubmissionError","showSubmissionError","setShowSubmissionError","showConfirmation","setShowConfirmation","entityJson","annotations","useGetJson","setFormData","patternPropertiesBannedKeys","useMemo","transformErrors","useCallback","isLoadingBinding","fetchedValidationSchema","isLoadingSchema","validationSchema","isLoading","mutation","useUpdateViaJson","submitChangedEntity","SynapseSpinner","Alert","Link","getEndpoint","BackendDestinationEnum","Box","Form","validator","ArrayFieldDescriptionTemplate","ArrayFieldItemTemplate","ArrayFieldTemplate","ArrayFieldTitleTemplate","ButtonTemplate","formData2","event","index","Divider","ConfirmationButtons","ConfirmationDialog"],"mappings":"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"}