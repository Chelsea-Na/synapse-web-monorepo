import{j as e,a as t,F as f}from"./jsx-runtime-095bf462.js";import{r as T}from"./index-8db94870.js";import{e as M,c as $,q as G,r as H,b as z}from"./EntityTypeUtils-054042f4.js";import{g,B as I}from"./getEndpoint-ac94413e.js";import{u as C,L as J}from"./ConfirmationDialog-8b4f2f75.js";import{u as W,b0 as Q,aN as X}from"./SynapseClient-407fbc5b.js";import{d as Y}from"./ToastMessage-c23277fc.js";import{u as Z,S as ee}from"./SchemaDrivenAnnotationEditor-f9660088.js";import{d as ae}from"./useEntity-4b17574c.js";import{S as te}from"./SkeletonTable-9f1646e7.js";import{d as R}from"./dayjs.min-8d4ef725.js";import{f as S}from"./DateFormatter-2112a7e5.js";import{g as ne,a as oe}from"./FileHandleUtils-f34f2f0b.js";import{U as v}from"./UserCard-0776aa39.js";import{B as h}from"./Button-ff2bc4b7.js";import{S as se}from"./Skeleton-b660800e.js";import{T as ie}from"./Tooltip-add08016.js";const A=({entityId:r})=>{const{isInExperimentalMode:o}=W(),{entityMetadata:a,annotations:s,isLoading:u}=ae(r),{data:d}=Z(r,{enabled:o});return u?e(te,{numRows:3,numCols:2}):t(f,{children:[a&&s&&Q(s)?t("div",{className:"placeholder",children:["This"," ",M($(a.concreteType))," ","has no annotations."]}):null,e("table",{className:"AnnotationsTable",children:t("tbody",{children:[s&&Object.keys(s).map(i=>t("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key",children:i}),e("td",{className:"AnnotationsTable__Row__Value",children:Array.isArray(s[i])?s[i].join(", "):s[i].toString()})]},i)),d&&o?t("tr",{className:"AnnotationsTable__Row",children:[e("td",{className:"AnnotationsTable__Row__Key Schema",children:"Validation Schema"}),e("td",{className:"AnnotationsTable__Row__Value",children:e("a",{href:`${g(I.REPO_ENDPOINT)}repo/v1/schema/type/registered/${d.jsonSchemaVersionInfo.$id}`,target:"_blank",rel:"noopener noreferrer",children:d.jsonSchemaVersionInfo.schemaName})})]}):null]})})]})};try{A.displayName="AnnotationsTable",A.__docgenInfo={description:"",displayName:"AnnotationsTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}const w=({entityId:r,versionNumber:o})=>{var i,_,l,p,c,m;const{data:a}=C(r,o),s=a&&G(a.entity),u=a?ne(a):void 0;let d;return u&&(d=oe(u)),a?e("table",{className:"MetadataTable",children:t("tbody",{children:[t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Name"}),e("td",{className:"MetadataTable__Row__Value",children:(i=a.entity)==null?void 0:i.name})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Type"}),e("td",{className:"MetadataTable__Row__Value",children:M(a.entityType)})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Synapse ID"}),e("td",{className:"MetadataTable__Row__Value",children:(_=a.entity)==null?void 0:_.id})]}),s&&t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Version"}),e("td",{className:"MetadataTable__Row__Value",children:H(a.entity)})]}),d&&t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Storage"}),e("td",{className:"MetadataTable__Row__Value",children:d})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:" Last Modified By"}),t("td",{className:"MetadataTable__Row__Value",children:[e(v,{size:"SMALL USER CARD",ownerId:(l=a.entity)==null?void 0:l.modifiedBy})," ","at ",S(R((p=a.entity)==null?void 0:p.modifiedOn))]})]}),t("tr",{className:"MetadataTable__Row",children:[e("td",{className:"MetadataTable__Row__Key",children:"Created By"}),t("td",{className:"MetadataTable__Row__Value",children:[e(v,{size:"SMALL USER CARD",ownerId:(c=a.entity)==null?void 0:c.createdBy})," ","at ",S(R((m=a.entity)==null?void 0:m.createdOn))]})]})]})}):null};try{w.displayName="MetadataTable",w.__docgenInfo={description:"",displayName:"MetadataTable",props:{entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}}}}}catch{}const le=["METADATA","ANNOTATIONS"];function V(r){const{entityId:o,versionNumber:a,show:s,onClose:u,initialTab:d="METADATA",showTabs:i=!0}=r,_=T.useRef(null),[l,p]=T.useState(d),[c,m]=T.useState(!1),[b,O]=T.useState(!1),{data:n}=C(o,a),B=n&&n.permissions.canEdit,N=n&&z(n.entityType),E=N&&n.entity.isLatestVersion,D=l==="METADATA"&&n&&!window.location.href.includes(o),q=t(h,{variant:"contained",onClick:()=>window.open(`${g(I.PORTAL_ENDPOINT)}#!Synapse:${o}`,"_blank","noopener"),children:["Open"," ",n?M(n==null?void 0:n.entityType):""]}),L=l==="ANNOTATIONS"&&c,k=e(h,{variant:"contained",onClick:()=>{_.current.formElement.current.requestSubmit()},children:"Save Annotations"}),K=l==="ANNOTATIONS"&&c,j=e(h,{variant:"outlined",onClick:()=>{b&&m(!1),O(!b)},children:b?"Are you sure? Unsaved changes will be lost":"Cancel"}),x=B&&l==="ANNOTATIONS"&&!c,P=e(ie,{title:N&&!E?"Annotations can only be edited on the latest version":void 0,children:e(h,{variant:"contained",disabled:N&&!E,onClick:()=>{m(!0)},children:"Edit"})}),F=t(f,{children:[i&&!c?e("div",{className:"Tabs",children:le.map(y=>e("div",{className:"Tab",role:"tab",onClick:U=>{U.stopPropagation(),p(y)},"aria-selected":y===l,children:y},y))}):null,e("div",{style:l==="ANNOTATIONS"?{}:{display:"none"},children:c?e(X,{children:e(ee,{entityId:o,formRef:_,onSuccess:()=>{Y("Annotations successfully updated.","success"),m(!1)},onCancel:()=>m(!1)})}):e(A,{entityId:o,versionNumber:a})}),e("div",{style:l==="METADATA"?{}:{display:"none"},children:e(w,{entityId:o,versionNumber:a})})]});return e(J,{className:"EntityMetadata",open:s,onCancel:u,maxWidth:c?"md":"sm",title:n?n.entity.name:e(se,{width:"40%"}),content:F,actions:t(f,{children:[K&&j,L&&k,x&&P,D&&q]})})}try{V.displayName="EntityModal",V.__docgenInfo={description:"",displayName:"EntityModal",props:{show:{defaultValue:null,description:"",name:"show",required:!0,type:{name:"boolean"}},entityId:{defaultValue:null,description:"",name:"entityId",required:!0,type:{name:"string"}},versionNumber:{defaultValue:null,description:"",name:"versionNumber",required:!1,type:{name:"number"}},onClose:{defaultValue:null,description:"",name:"onClose",required:!0,type:{name:"() => void"}},initialTab:{defaultValue:null,description:"",name:"initialTab",required:!1,type:{name:"enum",value:[{value:'"METADATA"'},{value:'"ANNOTATIONS"'}]}},showTabs:{defaultValue:null,description:"",name:"showTabs",required:!1,type:{name:"boolean"}}}}}catch{}export{V as E,le as a};
//# sourceMappingURL=EntityModal-17cd8efd.js.map
